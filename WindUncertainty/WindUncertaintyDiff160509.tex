%% LyX 2.1.2 created this file.  For more info, see http://www.lyx.org/.
%DIF LATEXDIFF DIFFERENCE FILE
%DIF DEL ReviewVersion/WindUncertainty.tex   Wed Mar 16 10:00:39 2016
%DIF ADD WindUncertainty.tex                 Mon May  9 16:09:32 2016
\documentclass[12pt,twoside,english]{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage{mathptmx}
\usepackage{helvet}
\renewcommand{\ttdefault}{lmtt}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage[font={normal,sl}]{caption}% this sets captions in slanted font
\usepackage[letterpaper]{geometry}
\geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1.2in,rmargin=1in}
\usepackage{fancyhdr}
\pagestyle{fancy}
\setcounter{tocdepth}{2}
\setlength{\parskip}{\medskipamount}
\setlength{\parindent}{0pt}
\setlength{\headheight}{14.5pt}
\usepackage{color}
\definecolor{page_backgroundcolor}{rgb}{1, 1, 1}
\pagecolor{page_backgroundcolor}
\usepackage{babel}
\usepackage{array}
\usepackage{prettyref}
\usepackage{float}
\usepackage{booktabs}
\usepackage{calc}
\usepackage{url}
\usepackage{ifthen}
\usepackage{amsmath}
\usepackage{splitidx}
\makeindex
\usepackage{graphicx}
\graphicspath{ {figure/} }
\usepackage{esint}
\usepackage[authoryear]{natbib}
\PassOptionsToPackage{normalem}{ulem}
\usepackage{ulem}
\newindex[Index]{idx}
\newindex[Variable Names and Acronyms]{var}
\newindex[List of Symbols]{lis}
\usepackage[unicode=true,
 bookmarks=true,bookmarksnumbered=false,bookmarksopen=false,
 breaklinks=true,pdfborder={0 0 0},backref=false,colorlinks=true,
 linkcolor=blue, linktocpage=true]
 {hyperref}
\hypersetup{pdftitle={Technical Note: Uncertainty in Wind Measurements},
 pdfauthor={RAF}, citecolor={blue},
 pdfsubject={characterization of the uncertainty in wind measurements, GV},
 pdfkeywords={wind,uncertainty, NCAR Research Aviation Facility, research aircraft, NCAR/EOL/RAF}}
%\usepackage{breakurl}
%\usepackage{html}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\newenvironment{lyxcode}
{\par\begin{list}{}{
\setlength{\rightmargin}{\leftmargin}
\setlength{\listparindent}{0pt}% needed for AMS classes
\raggedright
\setlength{\itemsep}{0pt}
\setlength{\parsep}{0pt}
\normalfont\ttfamily}%
 \item[]}
{\end{list}}
 \newlength{\lyxhang}
 \IfFileExists{hanging.sty}{
   \usepackage{hanging}
   \newenvironment{hangparagraphs}
     {%
       \ifthenelse{\lengthtest{\parindent > 0pt}}%
         {\setlength{\lyxhang}{\parindent}}%
         {\setlength{\lyxhang}{2em}}%
       \par\begin{hangparas}{\lyxhang}{1}%
     }
     {\end{hangparas}}
 }{%else
   \newenvironment{hangparagraphs}
     {%
       \ifthenelse{\lengthtest{\parindent > 0pt}}%
         {\setlength{\lyxhang}{\parindent}}%
         {\setlength{\lyxhang}{2em}}%
       \begin{hangparas}%
     }
     {\end{hangparas}}
   \newcommand{\hangpara}{\hangindent \lyxhang \hangafter 1 \noindent}
   \newenvironment{hangparas}{\setlength{\parindent}{\z@}
   \everypar={\hangpara}}{\par}
 }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.


\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}\definecolor{messagecolor}{rgb}{0, 0, 0}\definecolor{warningcolor}{rgb}{1, 0, 1}\definecolor{errorcolor}{rgb}{1, 0, 0}\setlength{\headheight}{14.5pt}\usepackage{babel}
% macro for italic page numbers in the index
\newcommand{\IndexDef}[1]{\textit{#1}}
\newcommand{\IndexPrimary}[1]{\textbf{#1}}
% force a page break at the start of sections
\let\stdsection\section
\renewcommand{\section}{\newpage\stdsection}


% workaround for a makeindex bug,
% see sec. "Index Entry Order"
% only uncomment this when you are using makeindex
\let\OrgIndex\index 
\renewcommand*{\index}[1]{\OrgIndex{#1}}
\usepackage{splitidx}

\AtBeginDocument{
  \def\labelitemii{\(\circ\)}
  \def\labelitemiii{\(\triangleright\)}
}


\IfFileExists{upquote.sty}{\usepackage{upquote}}{}

\newenvironment{lyxlist}[1]
{\begin{list}{}
{\settowidth{\labelwidth}{#1}
\setlength{\leftmargin}{\labelwidth}
\addtolength{\leftmargin}{\labelsep}
\renewcommand{\makelabel}[1]{##1\hfil}}}
{\end{list}}
\newcommand{\datetoday}{\number\day\space
     \ifcase\month\or January\or February\or March\or April\or May\or
     June\or July\or August\or September\or October\or November\or
     December\fi
     \space\number\year}
\newcommand{\EOLmemo}{\null \vskip-1.5truein
{\raggedright \textsf{\textsc{\large \textcolor{blue}{Earth Observing Laboratory}}}}\par
{\raggedright \textsf{\textsl{\textcolor{blue}{Memorandum:}}}} \par \vskip6pt
{\color{blue}{\hrule}}\par
\vskip0.3truein \leftline{\hskip \longindent \datetoday} \vskip0.2truein
\thispagestyle{empty}}
\newcommand{\attachm}[1]{\begin{lyxlist}{Attachments:00}
\item [Attachments:] {#1}
\end{lyxlist}}
\newcommand{\cc}[1]{\begin{lyxlist}{Attachments:00}
\item [cc:] {#1}
\end{lyxlist}}
\newcommand{\attach}[1]{\begin{lyxlist}{Attachments:00}
\item [Attachment:] {#1}
\end{lyxlist}}

\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\makeatother
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
%DIF PREAMBLE EXTENSION ADDED BY LATEXDIFF
%DIF UNDERLINE PREAMBLE %DIF PREAMBLE
\RequirePackage[normalem]{ulem} %DIF PREAMBLE
\RequirePackage{color}\definecolor{RED}{rgb}{1,0,0}\definecolor{BLUE}{rgb}{0,0,1} %DIF PREAMBLE
\providecommand{\DIFadd}[1]{{\protect\color{blue}\uwave{#1}}} %DIF PREAMBLE
\providecommand{\DIFdel}[1]{{\protect\color{red}\sout{#1}}}                      %DIF PREAMBLE
%DIF SAFE PREAMBLE %DIF PREAMBLE
\providecommand{\DIFaddbegin}{} %DIF PREAMBLE
\providecommand{\DIFaddend}{} %DIF PREAMBLE
\providecommand{\DIFdelbegin}{} %DIF PREAMBLE
\providecommand{\DIFdelend}{} %DIF PREAMBLE
%DIF FLOATSAFE PREAMBLE %DIF PREAMBLE
\providecommand{\DIFaddFL}[1]{\DIFadd{#1}} %DIF PREAMBLE
\providecommand{\DIFdelFL}[1]{\DIFdel{#1}} %DIF PREAMBLE
\providecommand{\DIFaddbeginFL}{} %DIF PREAMBLE
\providecommand{\DIFaddendFL}{} %DIF PREAMBLE
\providecommand{\DIFdelbeginFL}{} %DIF PREAMBLE
\providecommand{\DIFdelendFL}{} %DIF PREAMBLE
%DIF END PREAMBLE EXTENSION ADDED BY LATEXDIFF

\begin{document}

\pagenumbering{gobble}
\title{Characterization of Uncertainty \\
 in \\Measurements of Wind\\
 from the \\NSF/NCAR Gulfstream V Research Aircraft}


\author{W. A. Cooper, R. B. Friesen, M. Hayman, J. B. Jensen, D. H. Lenschow, \\P. A. Romashkin, A. J. Schanot, S. M. Spuler, J. L. Stith, C. Wolff}


\date{\textcolor{red}{} \DIFaddbegin \DIFadd{5/}\DIFaddend 9/\DIFdelbegin \DIFdel{23/2015}\DIFdelend \DIFaddbegin \DIFadd{2016}\DIFaddend }
\thispagestyle{empty}
\maketitle
\vfill{}
\eject%
\cleardoublepage
\pagenumbering{roman}



\begin{abstract}

This technical note presents an analysis of uncertainty for measurements
of wind from the Gulfstream V research aircraft operated by the National
Center for Atmospheric Research for the National Science Foundation,
with emphasis on measurements made in the DEEPWAVE field project in
2014. It begins with a description of the instruments used to make
the needed measurements and the algorithms used for calculation of
wind. Three systems are described, the primary system in depth, a
new system based on a gust pod in lesser detail, and a laser air motion
sensor in preliminary fashion because the latter is still under development.
In addition to specifying the characteristics of the component measurements
and propagating their uncertainty to the final measurement of wind,
the document presents detailed information on how the measurements
are calibrated in terms of airflow, are processed to incorporate corrections,
and are checked with flight maneuvers. The results are presented in
terms of standard uncertainties where possible, so if for example
coverage intended to match 95\% confidence intervals is desired the
values quoted should be doubled. The net uncertainty in the standard
measurement of vertical wind is 0.12~m\,s$^{-1}$, and a correction
procedure for removing the Schuler oscillation in pitch is developed
that with special processing can reduce this value. For the standard
measurement of horizontal wind, the estimated standard uncertainty
is about 0.4~m\,s$^{-1}$ for each component of the vector wind.
These estimates are supported by itemized lists of the sources of
error and how the associated uncertainty has been measured. The report
also offers some suggestions regarding methods to improve the measurements,
focused on the horizontal wind where the weakest measurement is that
of heading. Appendices to the report discuss the conventions used
for characterization of uncertainty and the high-rate (25~Hz) measurements
used to characterize turbulence. Finally, the last appendix discusses
how the analysis programs and data are preserved in ways that address
reproducibility of the analyses, so that others can duplicate these
results.
\end{abstract}
\clearpage
\subsection*{\centering{Foreword}}
\addcontentsline{toc}{subsection}{Foreword}
%%\source('foreword_wind_doc.tex')
{\centering
Jeff Stith
\par}

{\centering
Manager, Research Aviation Facility, EOL/NCAR
\par}


\bigskip

It is hard to imagine science without its dedicated laboratories where
the specialized experiments and measurements required for scientific
progress are located. In the earth sciences, particularly in the
atmospheric sciences, airborne laboratories are often the best and
sometimes the only way to obtain the necessary measurements, many of
which are carried out in situ. For most meteorological research and
related disciplines (such as atmospheric chemistry), the motion of the
air with respect to the earth at the location of the research aircraft
is a fundamental part of the research. In a general sense we think
of this as a wind measurement, but it also includes the field of
atmospheric turbulence, a discipline in its own right. Scientific
interest in this topic ranges from planetary scales to mm scales,
representing a major experimental need. 

Resolving even the larger turbulent eddies in the atmosphere requires
high resolution three-dimensional wind measurements, which is a major
challenge to obtain accurately from a high-speed aircraft. There
are several challenges when making such a measurement. The motion of
the aircraft through the atmosphere must be accurately measured, which
has traditionally been done through measurement of pitot and static
pressures, temperature, humidity, angle of attack and angle of
sideslip, each with their own measurement limitations. The motion
of the aircraft with respect to the earth must also be accurately
determined. The adoption of compact Inertial Navigation Systems
(INS) on research aircraft, over fifty years ago, represents a
milestone in airborne wind measurement by allowing the motion of the
aircraft relative to the earth to be accurately measured at a high
sampling rate. NCAR{\textquoteright}s Research Aviation Facility,
through the work by Don Lenschow and collaborators, was an early user
and developer of wind measurements using this technology in the 1970s.
These techniques are still the primary methods used for high
resolution wind and turbulence measurements from research aircraft.
In fact, the aircraft maneuvers that Lenschow developed to setup
the wind system are still today often referred to as
{\textquotedblleft}Lenschow maneuvers{\textquotedblright}. 

While there are calibration standards for pressure, temperature,
humidity, and for evaluating the performance of an INS, there is no
comparable standard for evaluating the performance of the wind
measuring system as a whole. Furthermore, the response of the
aircraft itself to gusts and the associated perturbations of the
airflow around the aircraft are poorly known and a significant
constraint on the wind measurement capabilities. Techniques such as
flight by an instrumented tower can be used for comparison with
airborne wind measurements, but the uncertainty in these comparisons is
generally of the same order or greater than the accuracy one might
expect from the wind system itself and they cannot duplicate the
conditions in the atmosphere where the measurements are made. Thus,
such techniques do not resolve the basic uncertainties of a given wind
measurement system. 

Over the past decade we have been developing and using a Laser Air
Motion System (LAMS), which utilizes lidar technology to resolve the
airspeed of the aircraft ahead of the airflow perturbations caused by
the presence of the aircraft. Since it provides an independent
measurement of airspeed, it allows for better characterization the wind
system. 

This document represents a careful examination of each component of the
uncertainty in the wind measurement system on the NSF/NCAR GV aircraft,
utilizing the new data provided by LAMS to improve the characterization
of the GV wind system. It also provides a description of updated
Lenschow maneuver techniques and shows how these and other techniques
can be used to setup the wind system for optimal measurement
performance. It will be an important reference to future users of
the data from the GV and to scientists at the Research Aviation
Facility. It also serves as a guide to modern wind-system
measurement technology and, as such, will be of general interest to
users of these types of systems and to students who are learning about
this important technology. It represents a continuation of the
pioneering work on airborne wind measurements done by Lenschow and
colleagues, done now with modern technology and a continuing focus on
the performance of the instrumentation used for this application. 

\tableofcontents{}
\clearpage
\phantomsection
\addcontentsline{toc}{section}{List of Figures}
\listoffigures
\clearpage
\phantomsection
\addcontentsline{toc}{section}{List of Tables}
\listoftables
\cleardoublepage
\newpage
\pagenumbering{arabic}

%% LyX 2.1.2 created this file.  For more info, see http://www.lyx.org/.



\section{Introduction}

\subsection{Overview}

Wind\index{wind} is the motion of the atmosphere relative to the Earth. Most research aircraft have the capability to measure wind, and these measurements have many uses in research projects using aircraft. They help define the flow and so provide context for other measurements,\index{wind!measurements!uses} and they are often used to study fluxes of atmospheric constituents, turbulence, wave motions, cloud updrafts and downdrafts, convergence and divergence, and many other topics. They can provide important information transferred to models for data assimilation or for validation tests of model results. 


The National Science Foundation (NSF)\sindex[var]{NSF=National Science Foundation} owns a Gulfstream V\index{Gulfstream V}\index{GV} research aircraft\index{aircraft!research} that is operated by the Research Aviation Facility\sindex[var]{RAF=Research Aviation Facility} (RAF), Earth Observing Laboratory\sindex[var]{EOL=Earth Observing Laboratory} (EOL), National Center for Atmospheric Research\sindex[var]{NCAR=National Center for Atmospheric Research} (NCAR). In this report, this aircraft is referred to either as the NSF/NCAR GV\index{NSF/NCAR GV} or simply the \sindex[var]{GV=NSF/NCAR Gulfstream V}GV. Its range and endurance make it possible to measure wind over large distances and so to characterize mesoscale and even larger features in the atmosphere. However, its high speed\index{GV!typical flight speed} (typically Mach 0.8, or about 240\,m\,s$^{-1}$ for flight near 40,000\,ft or approximately 12.2\,km) poses special problems for wind measurement. The flow distortion\index{airflow distortion}\index{flow distortion|see{airflow distortion}} around the aircraft perturbs pressure measurements that are central to the measurement of wind, and the measurement of air \index{temperature}temperature, needed in the calculation of wind, requires corrections of typically more than 20$^{\circ}$C to account for dynamic heating\index{heating!dynamic} of the sensors. Accurate measurement of wind\index{wind!measurement!challenges} thus is particularly challenging on this and other high-speed aircraft. 

This report documents how measurements of wind are made from the GV and estimates the uncertainty\index{uncertainty!estimate} associated with those measurements. These estimates apply to the system as it existed in 2014, in particular as it operated in the DEEPWAVE\index{DEEPWAVE}\sindex[var]{DEEPWAVE=Deep Propagating Gravity Wave Experiment over New Zealand} research project flown from New Zealand in June-July 2014. Key features of the instrumentation\index{wind!measurement!instrumentation} influencing the uncertainty in the measurements as characterized here are the presence of ``OmniSTAR''\index{OmniSTAR} GPS\sindex[var]{GPS=global positioning system}\index{GPS} \index{Global Positioning System}(Global Positioning System) measurements, providing measurements of the velocity of the aircraft relative to the earth, a calibration of airspeed provided by the Laser Air-Motion Sensor\index{laser air-motion sensor} (\citet{CooperEtAl2014}), and a newly developed all-weather wind sensor or ``gust pod''\index{gust pod} employing a Rosemount 858 probe\index{Rosemount 858 probe} mounted under the wing of the GV. These complemented the standard wind-sensing system\index{wind!measurement!standard system} comprised of a Honeywell Laseref IV inertial reference unit\index{inertial reference unit}\index{IRU|see{inertial reference unit}}, GPS measurements from Novatel and Garmin units, and a gust-sensing system based on pressure ports in the nose radome, on the fuselage, and at a pitot tube. The results obtained here do not necessarily apply to measurements from earlier projects when not all these components were available in their present form, but they should apply to measurements subsequent to 2014. 

The intent in this report is to follow the conventions\index{uncertainty!report!conventions} established by the International Committee on Weights and Measures\index{organizations!standards} and by the National Institute of Standards and Technology\index{organizations!standards}.\index{International Committee on Weights and Measures}\index{National Institute of Standards and Technology} Appendix A summarizes key aspects of those recommendations and how they are addressed in this report. This report also contains additional information resulting from various studies of the measurements that have tested the validity of the measurements or have been used for calibration. 

The organization\index{organization!this report} is as follows: Section \ref{sec:Components} describes the components of the wind-measuring system\index{wind!measurement!instrumentation} in more detail, with specifications for the sensors involved and examples of the measurements. Section~\ref{sec:CalProcedures} then describes calibration procedures and summarizes how measurement quality is monitored. Some empirical relationships used to deduce wind are also introduced in that section. The central discussion of uncertainty in wind measurements is contained in Sect.~\ref{sec:Uncertainty-components}, where there is a tabulation of individual error sources along with many references to other parts of the document where studies have led to estimates of limits on those error sources. It is our hope that this section will provide a summary of the results that can either stand alone or provide a guide to the further information in this report. The conclusions reached in this report are summarized at the end of that section, in Section~\ref{sub:Conclusions}.

Subsequent sections provide additional information and checks used to assess uncertainty. Section \ref{sec:Calibrations} describes in more detail how the key gust measurements have been calibrated, tested, and intercompared. Section \ref{sec:vertical-wind} discusses the choice of measurement to represent the vertical motion of the aircraft and some aspects of the uncertainty in that measurement, the relative timing of acquisition of the measurements entering vertical wind, and a procedure for detecting the Schuler oscillation in the pitch measurement and applying a correction that reduces the uncertainty in that measurement that, uncorrected, accounts for the dominant uncertainty in vertical wind. Section \ref{sec:HWind} then uses drifting or Lagrangian circle maneuvers to establish limits on some critical components entering measurement of the horizontal wind, the airspeed and offsets in heading and sideslip angle, which account for some of the bias limits used in Sect.~\ref{sec:Uncertainty-components}, and it describes how the measurements of ground-speed components from the inertial units and GPS units have been combined to reduce uncertainty in the components of the horizontal wind. Appendix B presents some of the characteristics of turbulence measurements, including variance spectra and potential to measure fluxes, and notes some limitations of such measurements. Appendix C discusses reproducibility of this document, with links to the programs and data used to generate this report. A list of symbols, a list of acronyms and variable names from NCAR/EOL/RAF aircraft data files that are used in this report with definitions and page references, and an index appear at the end of this report.

% The program that performed the calculations reported here
% can be found on NCAR/EOL computer
% space in the directory /h/eol/cooperw/RStudio/DEEPWAVE/WindUncertainty 
% and in the GitHub repository \href{https://github.com/WilliamCooper/WindUncertainty.git}{https://github.com/WilliamCooper/WindUncertainty.git}.
% The former is accessible via computers like tikal.eol.ucar.edu.
% The main program is WindUncertainty.Rnw; other files in those repositories
% with suffixes .Rnw are sections in this report and are updated to the
% main program. Normal usage is to run this main program within ''RStudio''
% to execute the contained R code and also, via ''knitr,'' to generate
% this text document from LaTeX statements embedded in those files.
% An R package 'Ranadu' is used extensively in the R code; it resides on GitHub as \href{https://github.com/WilliamCooper/Ranadu.git}{https://github.com/WilliamCooper/Ranadu.git}.
% The data used reside in NCAR/EOL project archives and, in subsetted
% form, are archived in the directory /h/eol/cooperw/RStudio/DEEPWAVE/WindUncertainty
% as R data files, with names ending in ''Rdata.'' Those files are
% too large to be appropriate for GitHub but can be provided from the
% NCAR/EOL computers. It is thus possible to reproduce this document
% from archived data and to repeat the included analyses with new data
% as needed. This document thus attempts to be ''reproducible research''
% as that term is used by the author of knitr. References for knitr
% and the analysis packages in R are included in the \nameref{sec:acknowledgements} and References at the end of this document.

\subsection{Procedures for calculating the wind\label{sub:General-comments}}

\subsubsection{Measuring systems and coordinate systems}

Three wind-sensing systems are available for use on the GV:  
\begin{enumerate}
\item The ``standard'' wind sensing system\index{wind!measurement!standard system} that uses pressure ports on the radome combined with airspeed measured using a pitot tube and ground-speed vector components\index{speed of aircraft!ground speed} measured by an inertial reference unit and a global positioning system (GPS) receiver.  
\item A gust-pod system\index{wind!measurement!gust pod} consisting of a Rosemount 858 airflow sensor\index{Rosemount 858 airflow sensor} mounted under the wing combined with an inertial reference unit\index{inertial reference unit} co-located with the airflow sensor and updated to GPS measurements via a Kalman filter.\index{filter!Kalman}  
\item A laser air-motion sensor\index{wind!measurement!laser air-motion sensor}\index{laser air-motion sensor} (LAMS)\sindex[var]{LAMS=laser air-motion sensor}\index{LAMS|see {laser air-motion sensor}} described by \citet{SpulerEtAl2011}
combined with its own IRU/GPS system. See also \citet{CooperEtAl2014}.  
\end{enumerate}
Measurements from the LAMS derive from direct measurements of the Doppler shift\index{Doppler shift}
and so do not depend on pressure, temperature, or humidity. However, the other
two measurements depend on a measurement of temperature and humidity,\index{humidity!effect on airspeed} the
latter used to correct for the influence of moisture on the specific heats and gas constant of moist air.\index{properties of moist air} Those two also share dependence on the measurement of ambient pressure\index{pressure!ambient}\index{pressure!static|see {pressure, ambient}} as delivered by static sources on the fuselage. Although the measurements differ among systems, for each the measurement of wind involves the vector sum of two components, the motion of the air relative to the aircraft and the motion of the aircraft relative to the Earth. The former is the ``relative wind\index{wind!relative}'' and is measured as a three-component vector having magnitude equal to the ``true airspeed''\index{airspeed!true} (referred to simply as the airspeed in this report) and angles relative to the aircraft reference frame characterized by the angle of attack\index{attack!angle of} and the sideslip angle.\index{sideslip} The angle of attack is considered\index{attack!angle of!sign convention}\index{sideslip!sign convention} positive if the relative wind is from below the aircraft, and the sideslip angle is considered positive if the relative wind is from the starboard side of the aircraft.\footnote{There is potential confusion arising from the signs of yaw and sideslip. The terms have different meaning and opposite sign conventions. Yaw refers to the orientation of the aircraft about an axis perpendicular to the longitudinal and lateral axes (i.e., upward when level), and it increases as the nose moves to starboard. Sideslip refers to the direction of the relative wind, and it is positive if the relative wind is from the starboard side.} Diagrams showing the attitude angles and relative-wind angles are included in \citet{NCAR_OpenSky_TECH-NOTE-000-000-000-064} and \href{https://www.eol.ucar.edu/raf/Bulletins/bulletin23.html}{RAF Bulletin 23}. The relative wind defined in the coordinate system\index{coordinate system!aircraft} of the aircraft (conventionally with $\hat{x^{\prime}}$ forward, $\hat{y^{\prime}}$ in the starboard direction, and $\hat{z^{\prime}}$ \DIFdelbegin %DIFDELCMD < \sindex[sym]{xhatp@$\hat{x^{\prime}},\,\hat{y^{\prime}},\,\hat{z^{\prime}}$=coordinate axes of the aircraft}%%%
\DIFdelend \DIFaddbegin \sindex[lis]{xhatp@$\hat{x^{\prime}},\,\hat{y^{\prime}},\,\hat{z^{\prime}}$=coordinate axes of the aircraft}\DIFaddend obtained from the cross product $\hat{x^{\prime}}\times\hat{y^{\prime}}$ and so approximately downward but oriented to align with the aircraft reference frame) must be transformed to an Earth-based reference system\index{coordinate system!Earth} (conventionally with $\hat{x}$ toward east, $\hat{y}$ toward north, and $\hat{z}$ upward) \DIFdelbegin %DIFDELCMD < \sindex[sym]{xhat@$\hat{x},\,\hat{y},\,\hat{z}$=coordinate axes of the Earth-based reference frame}%%%
\DIFdelend \DIFaddbegin \sindex[lis]{xhat@$\hat{x},\,\hat{y},\,\hat{z}$=coordinate axes of the Earth-based reference frame}\DIFaddend so that the components can be combined to yield the Earth-relative wind. This transformation is a function of the attitude angles of the aircraft\sindex[lis]{psi@$\psi$=heading}\sindex[lis]{theta@$\theta$=pitch angle}\sindex[lis]{phi@$\phi$=roll angle} (heading $\psi$, pitch $\theta$, and roll $\phi$), \index{heading}\index{roll angle}\index{pitch angle}\index{angle!attitude}measured by an inertial reference unit in all three cases discussed here. Once in an Earth-based reference system,\index{coordinate system!Earth} the relative wind\index{wind!relative} vector is added to the vector representing the aircraft motion relative to the Earth to obtain the wind. The sources of the various measurements entering this processing sequence vary among the three systems and will be discussed separately for each system. 


\subsubsection{The Relative Wind\label{sub:The-Relative-Wind}}

In the standard aircraft coordinate system\index{coordinate system!aircraft} the three corresponding components of the relative wind\index{wind!relative} $\mathbf{v}$ (cf.~\citet{NCAR_OpenSky_TECH-NOTE-000-000-000-064} and \href{https://www.eol.ucar.edu/raf/Bulletins/bulletin23.html}{RAF Bulletin 23})\index{RAF Bulletin 23} are:\\
\begin{equation}
\mathbf{v=}\begin{pmatrix}u_{r}\\ v_{r}\\ w_{r} 
\end{pmatrix}=\begin{pmatrix}V^{*}\\ V^{*}\thinspace\tan\beta\\ V^{*}\thinspace\tan\alpha 
\end{pmatrix}\label{eq:relative wind}
\end{equation}
where, if $V$ \sindex[lis]{V@$V$=airspeed}is the airspeed, \sindex[lis]{Vstar@$V^{*}$=longitudinal component of airspeed}$V^{*}=$ $V/\sqrt{1+\tan^{2}\alpha+\tan^{2}\beta}$ \sindex[lis]{alpha@$\alpha$=angle of attack}\sindex[lis]{beta@$\beta$=sideslip angle}is the component of airspeed\index{airspeed!longitudinal} along the aircraft longitudinal ($\hat{x^{\prime}}$) axis, $\alpha$ is the angle of attack\index{attack!angle of} and $\beta$ the sideslip\index{sideslip} angle.\footnote{The magnitude of $\mathbf{v}$ is thus $V$ as required.} The sign convention\index{wind!relative!sign convention} is such that the relative wind is positive when \emph{from} the direction of the axis for each component. The relative wind is therefore determined from measurements of airspeed, angle of attack, and sideslip angle. 


\subsubsection{Transformation to an Earth reference frame\label{sub:EarthRef}}

\index{transformation!to Earth reference frame}\index{coordinate system!Earth}The orientations of the aircraft, the gust pod,\index{gust pod} and the LAMS\index{laser air-motion sensor} are each measured by IRUs\sindex[var]{IRU=inertial reference unit}\index{inertial reference unit} located respectively in the fuselage, in the bust pod, and in the LAMS under-wing pod. Each independently measures heading, pitch, and roll, so the calculations of wind from the three systems can be fully independent except that, because it is considered to have the smallest uncertainty, the airspeed\index{airspeed} measured from the standard radome-based system\index{system!radome-based|see {system, standard}} is used also for the gust pod\index{gust pod}. In each case, the IRU measurements and GPS\index{GPS|see {Global Positioning System}}\index{Global Positioning System} ground-speed components\index{speed of aircraft!ground speed} are used to transform the measurements to the reference frame of the Earth. 

The required transformation\index{transformation!coordinate}\index{wind!coordinate transformation} is described by three \index{rotation matrices}\index{transformation!rotation}\index{matrices!rotation}rotation matrices, defined in \index{RAF Bulletin 23}\href{https://www.eol.ucar.edu/raf/Bulletins/bulletin23.html}{RAF Bulletin 23} Eqs. 2.5 and 2.6:\footnote{An additional correction is applied to account for the effect of the rotation rate of the aircraft on the measurements. This correction is needed when the reference unit for motion relative to the Earth, the IRU, is separated from the measurement of relative wind. For the gust pod and single-beam LAMS, this is negligible because the IRU is co-located with the gust-measuring system. See the cited references for details.} 

\[
\mathbf{T_{1}}=\left(\begin{array}{ccc}
1 & 0 & 0\\ 0 & \cos\phi & -\sin\phi\\ 0 & \sin\phi & \cos\phi 
\end{array}\right) 
\]


\begin{equation}
\mathbf{T_{2}}=\left(\begin{array}{ccc}
\cos\theta & 0 & \sin\theta\\ 0 & 1 & 0\\ -\sin\theta & 0 & \cos\theta 
\end{array}\right)\label{eq:rotation-matrices}
\end{equation}


\[
\mathbf{T_{3}}=\left(\begin{array}{ccc}
\cos\psi & -\sin\psi & 0\\ 
\sin\psi & \cos\psi & 0\\ 0 & 0 & 1 
\end{array}\right) 
\]


where \{$\phi,\,\theta,\,\psi$\} are \{roll, pitch, heading\}.\index{roll}\index{pitch}\index{heading} 

The transformation\index{transformation!order} needs to be in the following order to conform to conventional definitions of the attitude angles:\index{angle!attitude}  
\begin{enumerate}
\item Rotate by $\mathbf{T_{1}}$ using the roll angle $\phi$ (\sindex[var]{ROLL=roll angle measured by the Honeywell IRU}ROLL or CROLL\_GP\sindex[var]{CROLL_GP@CROLL\_GP=roll angle from the C-MIGITS IRU}) to level the wings by a rotation about the $\hat{x^{\prime}}$ axis.  
\item Rotate by $\mathbf{T_{2}}$ about the $\hat{y^{\prime}}$ axis using the pitch angle $\theta$ (PITCH\sindex[var]{PITCH=pitch angle measured by the Honeywell IRU {[}deg.{]}} or CPITCH\_GP\sindex[var]{CPITCH_GP@CPITCH\_GP=pitch angle from the C-MIGITS III IRU {[}deg.{]}}) to level the aircraft.  
\item Rotate by $\mathbf{T_{3}}$ using the heading angle $\psi$ (THDG\sindex[var]{THDG=heading measured by the Honeywell IRU {[}deg.{]}} or CTHDG\_GP\sindex[var]{CTHDG_GP@CTHDG\_GP=heading from the C-MIGITS IRU }) to obtain components in a true-north reference frame. At this point, the relative-wind\index{wind!relative} vector $\mathbf{v}_r$ in an Earth-reference coordinate system\index{coordinate system!Earth} is $\mathbf{v}_{r}=\mathbf{T_{3}}(\mathbf{T_{2}}(\mathbf{T_{1}}\mathbf{v}))$ where $\mathbf{v}$ is given by (\ref{eq:relative wind}).  
\end{enumerate}
The measured ground-speeds\index{ground speed|see {speed of aircraft, ground speed}}\index{speed of aircraft!ground speed} (with components VNS,\sindex[var]{VNS=north component of ground speed, Honeywell IRU {[}m/s{]}} VEW,\sindex[var]{VEW=east component of ground speed, Honeywell IRU {[}m/s{]}} VSPD\sindex[var]{VSPD=vertical velocity of the aircraft, Honeywell IRU {[}m/s{]}}) then can be added to the relative wind to get the true Earth-relative wind. In the ``R'' code associated with this document, the required transformations are coded to provide the described processing option, but the RAF ``nimbus'' \index{nimbus}\index{gust.c}routine ``gust.c'' provides the transformation as implemented in standard processing. 

Each of the three wind-measuring systems provides its own measurement of the ground-speed components \{VNSs, VEWs, VSPDs\},\sindex[var]{VNSs=north component of the aircraft ground
speed from the 's' measuring system, 's'=\{C, \_GP, \_LAMS\} for respectively the standard, gust-pod, and LAMS systems} where 's' denotes the system \{standard, gust-pod, or LAMS\}.\sindex[var]{VNSC>@VNSC}{\sindex[var]{VEWC>@VEWC}\sindex[var]{VSPD>@VSPD} The final equations, defining the Earth-relative wind $\mathbf{v}_{E}$ in terms of the three wind variables \{WDs, WSs, WIs\} \sindex[var]{WDC=wind direction after combining IRU and GPS information via a complementary filter}\sindex[var]{WSC=wind speed after combining IRU and GPS information via a complementary filter}\sindex[var]{WDs=wind direction from the 's' measuring system, 's'=\{C, \_GP, \_LAMS\}}\sindex[var]{WSs=wind speed from the 's' measuring system, 's'=\{C, \_GP, \_LAMS\}}\sindex[var]{WIs=vertical wind from the 's' measuring system, 's'=\{C, \_GP, \_LAMS\}} where $s$ denotes the measuring system and subscripts $_{x}$ or $_{y}$ indicate the respective east or north component of the wind, are:\index{wind!direction}\index{wind!speed}\index{wind!north component}\index{wind!east component}\index{wind!vertical}\sindex[var]{VNSx=north component of the ground speed, 's' system, or \{VNSC, CVNS\_GP, \\CVNS\_LAMS\}}\sindex[var]{VEWx=east component of the ground speed, 's' system, or \{VEWC, CVEW\_GP\}}\sindex[var]{CVEW_LAMS>@CVEW\_LAMS}\sindex[var]{VSPDx=upward component of the aircraft speed, 's' system, or  \{GGVSPD, CVSDP\_GP, CVSPD\_LAMS\}}\sindex[var]{CVSPD_LAMS>@CVSPD\_LAMS}\sindex[var]{VNSC=north component of ground speed, \\blended VNS and GGVNS }\sindex[var]{VEWC=east component of ground speed, \\blended VEW and GGVEW}\sindex[var]{GGVNS=north component of ground speed, GPS {[}m/s{]}}\sindex[var]{GGVEW=east component of ground speed, GPS {[}m/s{]}}\sindex[var]{GGVSPD=vertical component of the aircraft motion, GPS {[}m/s{]}}\sindex[var]{CVEW_GP@CVEW\_GP=east component of ground speed, gust-pod C-MIGITS III {[}m/s{]}}\sindex[var]{CVNS_GP@CVNS\_GP=north component of ground speed, gust-pod C-MIGITS III {[}m/s{]}}\sindex[var]{CVSPD_GP@CVSPD\_GP=vertical component of aircraft motion, gust-pod C-MIGITS III {[}m/s{]}}\sindex[var]{CVEW_LAMS@CVEW\_LAMS=east component of ground speed, LAMS SDN500 {[}m/s{]}}\sindex[var]{CVNS_LAMS@CVNS\_LAMS=north component of ground speed, LAMS SDN500 {[}m/s{]}}\sindex[var]{CVSPD_LAMS@CVSPD\_LAMS=vertical component of aircraft motion, LAMS SDN500 {[}m/s{]}}\sindex[lis]{mathbf{v_{E}} =vector wind relative to the Earth reference frame@$\mathbf{v_{E}}$=vector wind relative to the Earth reference frame}\sindex[lis]{mathbf{v_{r}} =vector relative wind@$\mathbf{v_{r}}$=vector relative wind}\index{wind!equation for components}

\begin{equation}
\mathbf{v}_{E}=\mathbf{v}_{r}+\left(\begin{array}{c}
-\mathrm{VNSs}\\ -\mathrm{VEWs}\\ 
\mathrm{VSPDs}
\end{array}\right)\label{eq:vg}
\end{equation}
\begin{equation}
\mathrm{WDx=\arctan2(v_{E,y},}v_{E,x})\label{eq:wd}
\end{equation}
\begin{equation}
\mathrm{WSx=\sqrt{(v_{E,x}^{2}+v_{E,y}^{2})}}\label{eq:ws}
\end{equation}
\begin{equation}
\mathrm{WIx=v_{E,z}}\label{eq:wi}
\end{equation}




\section{Components of the wind-sensing systems\label{sec:Components}}

\subsection{The radome-based system\label{sub:The-radome-based-system}}


\subsubsection{Overview}

The primary measurement of wind on the GV \index{wind!measurement!standard system} is that based on measurement of airspeed via a pitot tube\index{pitot tube}, airflow angles\index{angle!airflow} via pressure differences measured on the nose \index{radome}radome, attitude angles\index{angle!attitude} measured by an \index{inertial reference unit}inertial reference unit, and \index{speed of aircraft!ground speed}ground-speed components measured by the same inertial reference unit and also by a Global Positioning System\index{Global Positioning System} receiver. A cursory description of this system was provided by \citet{CooperEtAl2014}. A more extensive description will be provided here. Table~\ref{tab:Radome-system-measurements} provides a summary of the measurements used to determine the wind and the characteristics of the sensors\index{sensors!table}\index{sensors!characteristics} used, and the \index{EOL web pages, instruments}\href{http://www.eol.ucar.edu/aircraft-instrumentation}{EOL instrument web pages} (cf.~\textquotedbl{}State Parameters\textquotedbl{}, \textquotedbl{}Wind\textquotedbl{}) provide additional information on these measurements.  

% \begin{table}
% \begin{tabular}{>{\centering}p{2.3cm}>{\centering}p{2.5cm}>{\centering}p{2.5cm}>{\centering}p{2.2cm}>{\centering}p{2.5cm}}
% \toprule 
% \textbf{Measurement \small{(VARIABLE)}} & \textbf{Instrument} & \textbf{Range, Characteristics} & \textbf{Standard Uncertainty} & \textbf{Comments}\tabularnewline
% \midrule
% \midrule 
% pitch, roll\\
% (PITCH, ROLL) & Laseref IV Model \small{HG2001 GD03} & ring gyros, strap-down system & 0.05$^{\circ}$ & mixed bias and random error\tabularnewline
% \midrule 
% heading\\
% (THDG) & `` &  & 0.2$^{\circ}$ & \tabularnewline
% \midrule 
% ambient pressure (PSF) & absolute transducer Paroscientific 1000-15A-28 & 0--15 PSI $\simeq$0--1035\,hPa & 0.10\,hPa &
% (from specs, assumed to give std uncertainty)\tabularnewline
% \midrule 
% dynamic pressure (QCF, QCR) & differential transducer PPT0005DXX2VB-S021 & 0--5 PSI $\simeq$0--345 hPa & 0.34 hPa\\
% 0.68 hPa max. & ``\tabularnewline
% \midrule 
% pressure differences, radome (ADIFR, BDIFR) & differential transducer PPT0001DXX2VB-S021 & range $\pm1$ PSI$\simeq$$\pm$68.95 hPa & 0.07 hPa\\
% 0.14 hPa max. & the first is ``typ.'', average over the range\tabularnewline
% \midrule 
% horizontal GV velocity components (VNS, VEW) & Honeywell Laseref IV HG2001 GD03 & strap-down accelerometers & 2.1\,m\,s$^{-1}$  & 0.1\,m\,s$^{-1}$ with slow updating to GPS\tabularnewline
% \midrule 
% '' '' '' (GGVNS, GGVEW) & Novatel OEM-3 differential GPS  & (L1/L2) correction via OmniSTAR XP & 0.03\,m\,s$^{-1}$ & <0.1\,m\,s$^{-1}$ when OmniSTAR is not available \tabularnewline
% \midrule 
% vertical GV speed (VSPD) &  Laseref IV (see above) & & 0.76 m\,s$^{-1}$ & with baro-loop updating\tabularnewline
% \midrule 
%  '' '' '' (GGVSPD) & Novatel GPS (see above)&  & 0.03\,m\,s$^{-1}$ with OmniSTAR & 0.1\,m\,s$^{-1}$ without OmniSTAR\tabularnewline
% \midrule 
% air temperature &HARCO 100009-1  &anti-iced, -80 to +40$^{\circ}$C  &0.3$^{\circ}$C  & needed for TAS calc.\tabularnewline
% \bottomrule
% \end{tabular}
% 
% \protect\caption{Characteristics of measurements from the radome-based system that
% are used for the standard calculation of the wind. See further
% discussion of each measurement in Sect.~\ref{sub:The-radome-based-system}.\label{tab:Radome-system-measurements}}
% \end{table}
\sindex[var]{ATX=selected best measurement of ambient \\temperature {[}deg C{]}}\sindex[var]{DPX=dew point {[}deg C{]}}
\sindex[var]{HARCO=manufacturer of the primary temperature sensor on the GV. This is not an acronym.}
\begin{table}
\begin{tabular}{>{\centering}p{2.3cm}>{\centering}p{2.7cm}>{\centering}p{2.5cm}>{\centering}p{2.2cm}>{\centering}p{2.5cm}}
\toprule 
\textbf{Measurement  \small{(VARIABLE)}} &
\textbf{Instrument} &
\textbf{Range, Characteristics} &
\textbf{Standard Uncertainty} &
\textbf{Comments}\tabularnewline
\midrule
\midrule 
pitch, roll\index{roll}\index{pitch}\\
(PITCH\sindex[var]{PITCH>@PITCH}, ROLL\sindex[var]{ROLL>@ROLL}) &
Honeywell Laseref IV HG2001 GD03\index{Honeywell Laseref IV}&
ring gyros, strap-down system &
0.05$^{\circ}$ &
mixed bias and random error\tabularnewline
\midrule 
heading\\
(THDG)\sindex[var]{THDG>@THDG} &
`` &
`` &
0.2$^{\circ}$ &
``\tabularnewline
\midrule 
ambient pressure (PSF)\sindex[var]{PSF>@PSF} &
Paroscientific 1000-15A-28 (absolute)\index{sensor!pressure} &
0--15 psi $\simeq$0--1035\,hPa &
0.10\,hPa\\
 &
specs. assumed std. uncertainty\tabularnewline
\midrule 
dynamic pressure (QCF, QCR)\sindex[var]{QCR>@QCR}\sindex[var]{QCF>@QCF} &
Honeywell PPT0005-DXX2VB-5021 &
0--5 psi $\simeq$0--345 hPa &
0.34 hPa\\
0.68 hPa max. &
``\tabularnewline
\midrule 
pressure differences (\{A,B\}DIFR) &
Honeywell PPT0001-DXX2VB-5021 &
$\pm1$\textasciitilde{}psi $\simeq$$\pm$68.95 hPa &
0.07 hPa\\
0.14 hPa max. &
the first is ``typ.'', average over the range\tabularnewline
\midrule 
horizontal GV velocity components\index{speed of aircraft!ground speed}
(VNS, VEW)\sindex[var]{VNS>@VNS}\sindex[var]{VEW>@VEW} &
Laseref IV (see above) &
strap-down accelerometers &
2.1\,m\,s$^{-1}$  &
0.1~m~s$^{-1}$ with slow updating to GPS\tabularnewline
\midrule 
``\\
(GGVNS, GGVEW)\sindex[var]{GGVNS>@GGVNS}\sindex[var]{GGVEW>@GGVEW} &
Novatel\index{GPS!Novatel} OEMV differential GPS  &
correction via OmniSTAR\index{OmniSTAR} XP &
0.03\,m\,s$^{-1}$ &
 still smaller with OmniSTAR\tabularnewline
\midrule 
vertical GV speed (VSPD)\sindex[var]{VSPD>@VSPD} &
Laserref IV (see above) &
strap-down accelerometers &
0.76 m\,s$^{-1}$ &
with baro-loop updating\tabularnewline
\midrule 
 " \\(GGVSPD)\sindex[var]{GGVSPD>@GGVSPD} &
Novatel GPS (see above) &
 &
0.03\,m\,s$^{-1}$ &
still smaller with OmniSTAR\tabularnewline
\midrule 
temperature (ATX)\sindex[var]{ATX>@ATX} &
HARCO 100009-1 &
$-80$ to +40$^{\circ}$C, anti-iced &
0.3$^{\circ}$ &
needed for airspeed\tabularnewline
\midrule 
dew point

(DPX)\sindex[var]{DPX>@DPX} &
Buck Research 1011C &
$-70$ to +30$^{\circ}$C &
<5$^{\circ}$ &
for level flight\tabularnewline
\bottomrule
\end{tabular}

\protect\caption{Characteristics of measurements from the radome-based system that
are used for the standard calculation of the wind. See the
discussion of each measurement in the text of Sect.~\ref{sub:The-radome-based-system}.\label{tab:Radome-system-measurements}\index{specifications!standard system}}
\end{table}


\subsubsection{Attitude angles\label{sub:Attitude-angles}}

Attitude angles\index{angle!attitude} (roll\index{roll}, pitch\index{pitch}, \index{angle of attack|see {attack, angle of}} and heading\index{heading}) are provided by a Honeywell IRU\index{inertial reference unit}, with specifications\index{IRU!specifications} as listed in Table~\ref{tab:Radome-system-measurements}. There are duplicate inertial systems, so a measure of uncertainty is how well they agree.\index{inertial reference unit!comparison} For DEEPWAVE\index{DEEPWAVE} flight 16, the mean difference in pitch was 0.2$^{\circ}$ (reflecting a small difference in installed orientation relative to the aircraft axes) and the standard deviation in the difference between measurements was about 0.015$^{\circ}$ (for measurements with absolute value of the roll smaller than 3$^{\circ}$). If the measurements are filtered to remove variations with period exceeding about 1000~s the slowly varying component of the difference has standard deviation of about 0.012$^{\circ}$ while the fast-varying component has standard deviation of 0.008$^{\circ}$. This was characteristic of most flights, although there were two (8 and 20) that had slightly larger standard deviations. The project averages were 0.02$^{\circ}$ for the slow component and about 0.007$^{\circ}$ for the fast component. This is an indication that the IRU performs better than indicated by the specifications, and indeed additional evidence for this is provided in Section \ref{sub:Schuler}. As discussed later in Section~\ref{sub:Schuler}, the error in pitch tends to precess with a period of about 84.4~min, so the slowly varying component tends to be dominated by this precession which, for periods short compared to 84.4~min, introduces a bias while the faster varying component has the character of a random error. 


\subsubsection{Ambient pressure\label{sub:Ambient-pressure}}

Ambient or ``static'' pressure \index{pressure!ambient} is measured on the GV at pressure ports called \index{static buttons}static buttons that are located at positions on the fuselage where in normal flight the pressure is approximately the pressure present outside the airflow disturbance produced by the aircraft. Because there are residual effects of airflow\index{airflow distortion} that change with angle of attack\index{attack!angle of} and \index{Mach number}Mach number, corrections are applied to these measurements to obtain better representation of the true ambient pressure. These corrections are described in \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{this document on processing algorithms}, Sect.~4.3, and in \citet{CooperEtAl2014}. The latter reference has additional information on the locations of the sensors and the system configuration. The \index{sensor!pressure}transducer characteristics are listed in Table~\ref{tab:Radome-system-measurements}, and the transducer is temperature-compensated to maintain these characteristics in flight when the cabin-mounted transducer can encounter fluctuating temperature. It is a digital transducer with resolution of 0.001\,hPa, equivalent to about 20-bit resolution, when sampling at 1\,Hz. The characteristic response time\index{sensor!pressure!response time} of the sensor is 0.02\,s and measurements are normally sampled at 50\,Hz and filtered to 25\,Hz. However, \index{pressure!lines}lines of length 2.3\,m and inside diameter 0.21 inch (0.53 cm) connect the transducer to the static buttons\index{buttons!static}, and there is an additional long line (5\,m) extending to the low-pressure port on the differential sensor measuring dynamic pressure.\index{pressure!dynamic}. Some problems apparently arise from these lines that affect the high-frequency response, as discussed in Appendix B\@. More information is available in the EOL instrument pages; see \href{https://www.eol.ucar.edu/instruments/ambient-static-pressure}{this link}. 


\subsubsection{Dynamic pressure\label{sub:Dynamic-pressure}}

The dynamic pressure\index{pressure!dynamic} is the pressure difference above ambient that develops if air is compressed and adiabatically brought to rest relative to the moving aircraft. The total pressure, the sum of ambient and dynamic pressure, is sensed using a pitot\index{pitot tube} tube, a tube pointed in the direction of the relative airflow and designed to be relatively insensitive to small-angle changes in the direction of the relative airflow. Figure~\ref{fig:pitot-tube-photo} shows the location of the research-system pitot tube on the GV as well as one of the avionics-system pitot tubes.\index{pitot tube!location} The excess pressure $q$ above the ambient sensed by a pitot tube or, approximately, by the center port on the radome is $q=0.5\rho_{a}V^{2}$ where\sindex[lis]{q@$q$=dynamic pressure} $\rho_{a}$ \sindex[lis]{rho@$\rho_{a}$=density of air}is the density of \DIFaddbegin \DIFadd{the ambient }\DIFaddend air and $V$ the airspeed, so this excess pressure can be used to determine the airspeed\index{airspeed} of the aircraft. On NSF/NCAR aircraft, the measurement of dynamic pressure is made using differential sensors connected between a static source and a total-pressure source from either a pitot tube (QCF)\sindex[var]{QCF=dynamic pressure measured using a fuselage-mounted pitot tube} or the front port on the radome (QCR).\sindex[var]{QCR=dynamic pressure measured at the center port on the radome} The sensor used, with specifications listed in Table~\ref{tab:Radome-system-measurements}, has these additional characteristics: resolution\index{sensor!pressure!resolution} is 0.0011\% of full scale or 0.0076 hPa, which is better than 16-bit resolution; the maximum sampling rate is 120 Hz, \index{sensor!pressure!response time}response time 50\,ms and response delay\index{sensor!pressure!delay} 21 ms or about one sample period at 50\,Hz sample rate. The response time is affected further by the pressure lines between the pressure ports and the transducers, as discussed above. The transducer provides 50-Hz output that is then filtered digitally to 25\,Hz or 1\,Hz in processing.\footnote{The specifications indicate that the appropriate time lag to apply in processing would be 21 ms but there is additional delay introduced by the sample tubing. Most processing including preliminary processing for DEEPWAVE has not included a delay for QCF or QCR.} 

Because any errors affecting the measurement of static pressure\index{pressure!ambient!corrections}\index{pressure!dynamic!corrections}\index{static defect} also affect the difference between dynamic and static pressure, the same corrections that are applied to static pressure (for errors in the pressure delivered by the static ports) are also applied to the dynamic pressure. See the references in the preceding subsection for more information. \citet{CooperEtAl2014} argue that the measurements of static and dynamic pressure, corrected for flow distortion or generation of a ``static defect'' at the static-pressure ports, each have standard uncertainty of 0.3 hPa and precision (for straight and level flight) of 0.1 hPa.\index{pressure!ambient!uncertainty}\index{pressure!dynamic!uncertainty}\index{pitot tube!photo} 

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=8.5cm]{SpecialGraphics/PitotTube-r.png}  
\par\end{centering}

\protect\caption{A pitot tube used for the measurement of dynamic pressure.\label{fig:pitot-tube-photo}}
\end{figure}



\subsubsection{Airflow angles\label{sub:Airflow-angles}}

The radome gust-sensing system consists of five pressure ports\index{radome!ports} installed in a standard GV radome\index{radome}, as shown in \index{radome!photograph}Fig.~\ref{fig:radome-photo}. 
\begin{figure}
\noindent \begin{centering}
\includegraphics[width=8cm]{SpecialGraphics/RadomePhotoGV.png}  
\par\end{centering}

\protect\caption{Photograph of the GV radome showing three of the five pressure ports on the radome used for measurement of components of the relative wind.\label{fig:radome-photo}} 
\end{figure}

\index{radome!photograph}The pressure ports are connected to differential pressure sensors, one between the top and bottom ports (variable ADIFR),\sindex[var]{ADIFR=pressure difference, bottom minus top source on radome {[}hPa{]}}\sindex[var]{BDIFR=pressure difference, starboard minus port source on radome {[}hPa{]}} one between the left and right ports (variable BDIFR), and one between the center port and the static source (variable QCR).\sindex[var]{QCR>@QCR} The latter provides an alternative measurement of dynamic pressure but is not normally used. The measurements ADIFR and BDIFR are obtained from differential pressure transducers, with characteristics\index{sensor!pressure!characteristics} as shown in Table~\ref{tab:Radome-system-measurements}. The transducers have specified response times of 0.05\,s and resolution 0.0015\,hPa, with quoted stability of about 0.03\,hPa per year. These measurements are used with procedures discussed in Section \ref{sub:radome-sensitivity} to find the angle of attack and sideslip angle of the relative wind. Additional information is available at \href{https://www.eol.ucar.edu/instruments/radome-gust-probe-3-d-wind-measurements}{this URL}. 


\subsubsection{Components of aircraft velocity relative to the Earth}

There are two sources of information regarding the \index{speed of aircraft!ground speed}ground-speed vector, an inertial reference unit (IRU)\index{inertial reference unit} and a Global Positioning System (GPS).\index{Global Positioning System}  
\begin{enumerate}
\item \uline{The IRU:} The inertial system on the GV is a Honeywell\index{inertial reference unit!Honeywell!characteristics} Laseref IV Model HG2001 GD03, with specifications listed in Table~\ref{tab:Radome-system-measurements}.  There are three units on the aircraft, two of which are recorded via the ARINC\sindex[var]{ARINC=Aeronautical Radio, Inc.; ARINC-429 is a communications standard} data bus to standard data files. These are strap-down ring-laser "gyro micro" inertial systems. The measurements of ground-speed components are affected by errors that arise from initial alignment errors or orientation errors resulting from gyro responses to acceleration and so often exhibit a characteristic Schuler\index{Schuler oscillation} oscillation with magnitude that can be as much as 1--3 m\,s$^{-1}$. This is \DIFdelbegin \DIFdel{the primary }\DIFdelend \DIFaddbegin \DIFadd{a potentially important }\DIFaddend source of error in the measurements of wind, so for aircraft velocity components it is important to remove these errors by comparison to lower-uncertainty measurements, provided by the GPS, that are not subject to the Schuler oscillation. \DIFdelbegin \DIFdel{In addition, there are }\DIFdelend \DIFaddbegin \DIFadd{However, the Honeywell IRUs on the GV are stand-alone inertial navigation systems and do not use any external information except pressure which is used to control the instability of the vertical integration of position. As received by the GV data system, there are also errors that arise from }\DIFaddend signal delays\index{GPS!delay time}\DIFdelbegin \DIFdel{that are }\DIFdelend \DIFaddbegin \DIFadd{. These must be }\DIFaddend accounted for in post processing to align measurements with other recorded data, and there are \DIFaddbegin \DIFadd{also }\DIFaddend some inherent filters\index{inertial reference unit!filters} in the IRU computer that affect the signals transmitted to the \DIFdelbegin \DIFdel{GV data }\DIFdelend \DIFaddbegin \DIFadd{recording }\DIFaddend system. The orientation\index{inertial reference unit!orientation} of this unit was defined and checked by initial survey to coincide with the aircraft reference axes.  
\item The \uline{GPS:} The primary GPS\index{Global Positioning System}
unit is a Novatel OEMV differential GPS unit (L1/L2) with OmniSTAR\index{OmniSTAR} XP satellite update for ionospheric and other corrections. As used on the GV, it reports ground-speed components at a rate of 5 Hz, although faster rates are possible and 10\,Hz is in standard use after DEEPWAVE. The claimed standard uncertainty\index{GPS!uncertainty} for position is 0.15~m for vertical position; the standard uncertainty in velocity is 0.03 m\,s$^{-1}$, with still better
performance  when OmniSTAR corrections are available.
\end{enumerate}

\subsubsection{Temperature\label{sub:Temperature}}

A measurement of temperature\index{temperature} is needed to calculate the wind because the conversion from dynamic pressure to airspeed involves the temperature, as documented in \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{this document on processing algorithms}.\index{processing algorithms} The measurements of temperature were checked against expectations for height-vs-pressure changes from the hydrostatic equation by \citet{CooperEtAl2014}, with the result that the measurements were validated to an uncertainty\index{temperature!uncertainty} of about 0.3$^{\circ}$C. Documentation of the temperature uncertainty will be presented in more detail in a separate document. 

\subsubsection{Humidity (dew point)\label{sub:dewpoint}}

The calculation of true \index{dew point}\index{humidity, effect on airspeed}airspeed from measured dynamic and static pressure involves the specific heats and gas constant for air, and this can depart from dry-air values when water vapor is present in significant amounts. This correction is usually insignificant for dew-point temperatures below about -20$^{\circ}$C. The equations used are those in \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{the document on processing algorithms}. The correction to airspeed is approximately a factor of (1+0.3$q_{h}$) where $q_{h}$ is the dimensionless specific humidity,\DIFdelbegin %DIFDELCMD < \sindex[sym]{qh@$q_h$=specific humidity} %%%
\DIFdelend \DIFaddbegin \sindex[lis]{qh@$q_h$=specific humidity} \DIFaddend typically about 0.01 at 10$^{\circ}$C dew point and 700~hPa pressure. In this case the correction to airspeed, typically 150~m/s at this altitude, is about 0.45~m/s, so the correction is not negligible but is relatively insensitive to uncertainty in the measured humidity. The dew point measurements become more uncertain than listed here at the low end of this range, but the humidity correction is insignificant there. Those measurements are likely better than listed here for the upper range, in level flight, but lags and overshooting introduce errors when conditions are changing rapidly as in climbs or descents. 

\subsubsection{Examples of measurements}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/radome-plot-angles-1} \caption[Attitude angles pitch, roll, and heading as measured by three independent systems inertial reference systems]{Attitude angles pitch, roll, and heading as measured by three independent systems inertial reference systems. The systems are: (1) the standard Honeywell IRU (PITCH, ROLL, THDG, blue lines); (2) a duplicate backup Honeywell IRU (PITCH\_IRS2, ROLL\_IRS2, THDG\_IRS2, green lines), and the C-MIGITS III IRU mounted in the gust pod (CPITCH\_GP, CROLL\_GP, CTHDG\_GP, red lines). All units are degrees. Data from DEEPWAVE flight 16 (4 July 2014), 9:00:00 to 10:00:00.}\label{fig:radome-plot-angles}
\end{figure}


\end{knitrout}

Typical measurements \index{example of measurements!attitude angles}\sindex[var]{UTC=Coordinated Universal Time} of the attitude angles are shown in Fig.~\ref{fig:radome-plot-angles}.\sindex[var]{ROLL>@ROLL}\sindex[var]{PITCH>@PITCH}\sindex[var]{CPITCH_GP>@CPITCH\_GP}\sindex[var]{CTHDG_GP>@CTHDG\_GP}\sindex[var]{THDG>@THDG} The large difference in pitch is a result of the gust pod being installed in a canister below the wing where it points downward by several degrees relative to the aircraft longitudinal axis. (The pods were designed this way to provide better approaching airflow for cloud-imaging probes and other sampling from the airstream.) There is also a significant difference in heading and in roll for similar reasons. 

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/radome-plot-pressures-1} \caption[The measurements of dynamic pressure (QCF and, after correction QCFC), ambient pressure (PSF and corrected PSFC) and the resulting airspeed TASX]{The measurements of dynamic pressure (QCF and, after correction QCFC), ambient pressure (PSF and corrected PSFC) and the resulting airspeed TASX. Data from DEEPWAVE flight 16.}\label{fig:radome-plot-pressures}
\end{figure}


\end{knitrout}

The measurements of pressures and the airspeed calculated from these \index{example of measurements!pressure}\index{example of measurements!airspeed} measurements are shown in Fig.~\ref{fig:radome-plot-pressures}\sindex[var]{QCFC>@QCFC}\sindex[var]{QCF>@QCF}\sindex[var]{PSF>@PSF}\sindex[var]{PSFC>@PSFC} for the same period as in the preceding figure.\sindex[var]{TASX=primary airspeed} Corrections have been applied to the pressure measurements according to the calibration determined from LAMS measurements, as described by \citet{CooperEtAl2014}; these corrections vary with flight conditions but normally are smaller than a few hPa so are not evident in these plots. They are nevertheless crucial to reducing the uncertainty in the airspeed to about 0.3\,m\,s$^{-1}$, as shown in that reference. 

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/radome-plot-airflow-angles-1} \caption[Pressure differences measured on the radome (ADIFR and BDIFR)]{The pressure differences measured on the radome (ADIFR and BDIFR, respectively between the vertically separated ports and the horizontally separated ports) and the resulting airflow angles AKRD (angle of attack) and SSRD (sideslip angle). Data from DEEPWAVE flight 16.}\label{fig:radome-plot-airflow-angles}
\end{figure}


\end{knitrout}

Figure~\ref{fig:radome-plot-airflow-angles}\sindex[var]{AKRD>@AKRD}\sindex[var]{ADIFR>@ADIFR}\sindex[var]{SSRD>@SSRD}\sindex[var]{BDIFR>@BDIFR} shows the measurements\index{example of measurements!dynamic pressure}\index{example of measurements!angle of attack}\index{example of measurements!sideslip} of differential pressure at the radome and the resulting angle of attack and sideslip angle calculated from those pressure differences. The calculation is described in Section 4 of this document. Fluctuations in sideslip angle are seldom more than a fraction of a degree, while there can be several-degree fluctuations in the angle of attack. The gradual decrease in angle of attack\sindex[var]{AOA=angle of attack} is a result of the change in fuel load on the aircraft, which requires a smaller angle of attack to keep the aircraft level as the weight becomes smaller. 

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/radome-plot-groundspeed-1} \caption[Ground-speed components measured by the IRU and GPS and vertical wind, DEEPWAVE flight 16.]{{Top two panels: Ground-speed components as measured by the IRU and GPS, and (red lines) the difference between the two measurements multiplied by a factor of 100. Bottom panel: Aircraft vertical speed as measured by the IRU (with built-in damping to the pressure altitude) and by the GPS unit. Data from DEEPWAVE flight 16.}}\label{fig:radome-plot-groundspeed}
\end{figure}


\end{knitrout}

The last set of components entering the measurement of wind consists of the measurements of the motion of the aircraft with respect to the Earth. These measurements must be combined with the measurement of relative wind to transform the measurements to an Earth-referenced measurement. Figure~\ref{fig:radome-plot-groundspeed} shows the east and north components of the ground speed\index{speed of aircraft!ground speed} as measured by the IRU and GPS. They are close enough to lie almost on top of each other in this plot, but the red lines show the difference magnified by a factor of 100. They clearly show the Schuler oscillation that results from an IRU error in pitch, having magnitude of about 1--2~m\,s$^{-1}$. This error is discussed in the next section, and Section~\ref{sub:comp-filter} discusses how the IRU measurements (having good short-term response but long-term drift) and the GPS measurements (having long-term accuracy but inferior short-term response) are combined in the measurement of wind. In addition to the Schuler oscillation, additional perturbations associated with turns result from the mixing of pitch, roll, and heading errors when the aircraft is banked. 

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/radome-plot-wind-1} \caption[Wind measurements for DEEPWAVE research flight 16]{Wind measurements for DEEPWAVE research flight 16.}\label{fig:radome-plot-wind}
\end{figure}


\end{knitrout}

Finally, Fig.~\ref{fig:radome-plot-wind} \index{example of measurements!wind components} shows the resulting wind measurements for this flight.\index{wind!example of measurements} These measurements will be discussed extensively in the remainder of this report, and the uncertainty associated with them is estimated in Sect.~\ref{sec:Uncertainty-components}. 

\subsection{The gust-pod system\label{sub:The-gust-pod-system}}


\subsubsection{Overview}

The all-weather gust pod\index{gust pod}\index{all-weather wind pod|see {gust pod}} was developed by Allen Schanot and is available for mounting under the wing of the GV, where it was installed during the 2014 project DEEPWAVE\index{DEEPWAVE}. It was still regarded as experimental for that project, but as described in this report it performed well when measuring vertical wind so it is now ready for deployment as a requestable instrument. The system has also been called the all-weather wind pod because the primary reason for its development was to provide a backup wind measurement for cases when the standard system malfunctions because its lines or apertures are blocked by ice. The gust pod fits into a standard PMS-style canister\sindex[var]{PMS=Particle Measuring Systems} and uses a \index{Rosemount 858 probe}Rosemount 858 probe, but the location under the wing is one where there is substantial flow distortion\index{airflow distortion} in comparison to the free stream so an unconventional calibration is needed to use the measurements. The 858 probe is anti-iced by heaters and should be unaffected by icing or ice accumulation. Five ports are oriented forward, upward and downward 45$^{\circ}$, and left and right 45$^{\circ}$ on the leading edge of the sensor, which has the shape of a hemisphere. There are also ports in a ring around the cylinder behind the hemisphere that provide a static source. The measurements are the pressure difference between the top and bottom ports (ADIF\_GP),\sindex[var]{ADIF_GP@ADIF\_GP=pressure difference between bottom and top sources, 858  probe [hPa]} the pressure difference between the right and left ports (BDIF\_GP),\sindex[var]{BDIF_GP@BDIF\_GP=pressure difference, starboard minus port sources,  858 probe [hPa]} and the pressure difference between the forward port and the static ports (QC\_GP).\sindex[var]{QC_GP@QC\_GP=pressure difference between forward and
 static ports, 858  probe [hPa]} In addition, the pressure provided by the ring of static ports is recorded as PS\_GP.\index{PS_GP=pressure at static ports, 858 probe [hPa]@PS\_GP=pressure at static ports, 858 probe} The system incorporates a Systron Donner \sindex[var]{C-MIGITS III=model of IRU used with the gust pod}\index{IRU!C-MIGITS}C-MIGITS III GPS/INS MEMS\sindex[var]{MEMS=micro-electro-mechanical system} Tactical Grade navigation system (henceforth called the C-MIGITS IRU), which is mounted in the pod to measure vibrations and wing-flex motions that will affect the measurements of wind. This unit provides measurements of attitude angles, ground-speed components, and accelerations and uses a GPS signal in a Kalman-filter feedback loop to reduce errors in the measurements. The relevant specifications\index{IRU!C-MIGITS!specifications} are listed in Table~\ref{tab:Gust-pod-measurements}. 

\noindent \begin{center}
\includegraphics[width=12.1cm]{SpecialGraphics/GustPod1-r.png}\includegraphics[height=5.1cm]{SpecialGraphics/GustPod2x-r}\\  \textsl{Photograph of the Gust Pod (bottom left) and the ports on the Rosemount 858 probe (right).} \index{gust pod!photograph} 
\par\end{center}

\begin{table}
\begin{minipage}[t]{0.93\columnwidth}%
\begin{tabular}{>{\centering}p{2.3cm}>{\centering}p{2.7cm}>{\centering}p{2.5cm}>{\centering}p{2.2cm}>{\centering}p{2.5cm}}
\toprule 
\textbf{Measurement \small{(VARIABLE)}} & \textbf{Instrument} & \textbf{Range, Characteristics} & \textbf{Standard Uncertainty} & \textbf{Comments}\tabularnewline
\midrule
\midrule 
velocity components
(CVNS\_GP,\sindex[var]{CVNS_GP>@CVNS\_GP} CVEW\_GP,\sindex[var]{CVEW_GP>@CVEW\_GP} CVSPD\_GP\sindex[var]{CVSPD_GP>@CVSPD\_GP}) & C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} IRU& with GPS & 0.1\,m\,s$^{-1}$  & horizontal and vertical\tabularnewline
\midrule 
pitch, roll\\
(CPITCH\_GP,\sindex[var]{CPITCH_GP>@CPITCH\_GP} CROLL\_GP)\sindex[var]{CROLL_GP>@CROLL\_GP} & C-MIGITS IRU& with GPS & 1\,mrad$\simeq$0.06$^{\circ}$ & with Kalman filter \tabularnewline
\midrule 
heading\\
CTHDG\_GP\sindex[var]{CTHDG_GP>@CTHDG\_GP} & C-MIGITS IRU & with GPS & 1.5\,mrad\\
$\simeq$0.09$^{\circ}$ & valid when in motion%
\footnote{Without occasional turns the heading error grows linearly at about
1--10$^{\circ}$/hour%
}\tabularnewline
\midrule 
pressure differences,858 ports\\
(ADIF\_GP,\sindex[var]{ADIF_GP>@ADIF\_GP} BDIF\_GP\sindex[var]{BDIF_GP>@BDIF\_GP}) & Honeywell PPT0001-DXX2VB-S021 & $\pm1$ psi$\simeq$$\pm$68.95 hPa & 0.07 hPa\\
0.14 hPa max. & the first is ``typ.''; same transducers as for radome\tabularnewline
\midrule 
dynamic pressure (QC\_GP)\sindex[var]{QC_GP>@QC\_GP} & Honeywell PPT0005-DXX2VB-S021%
 & 0--5 psi $\simeq$0--345 hPa & 0.17 hPa\\
0.34 hPa max. & ``\tabularnewline
\midrule 
ambient pressure (PS\_GP) & Paroscientific 6000-15A-28 & 0--15 psi $\simeq$0--1035\,hPa & 0.10\,hPa & digital transducer\tabularnewline
\bottomrule
\end{tabular}%
\end{minipage}

\protect\caption{Characteristics of measurements from the gust-pod that are used for
the calculation of the wind. There is further discussion of each measurement
in the text of Sect.~\ref{sub:The-gust-pod-system}.\label{tab:Gust-pod-measurements}\index{specifications!gust pod}}
\end{table}

\subsubsection{Attitude angles}

The C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} \index{angle!attitude!gust pod}\index{gust pod!components} IRU unit provides measurements of the attitude angles, recorded as variables CROLL\_GP,\sindex[var]{CROLL_GP>@CROLL\_GP} CPITCH\_GP,\sindex[var]{CPITCH_GP>@CPITCH\_GP} and CTHDG\_GP.\sindex[var]{CTHDG_GP>@CTHDG\_GP} The estimated standard uncertainty\index{IRU!C-MIGITS!uncertainty} in measurement of pitch, 1~mrad (cf.~Table~\ref{tab:Gust-pod-measurements}), is supported by comparison to the cabin-mounted inertial systems; the standard deviation in the difference between the two systems was about 0.1$^{\circ}\simeq1.7$~mrad for extensive multi-flight comparisons, while the expected difference for two systems each having standard uncertainties of 1 mrad would be 1.4\,mrad. Some contribution would be expected from vibrations and wing flex that affect the gust pod, so these comparisons are good support for the approximate validity of the specifications. However, the feedback from the Kalman filter using GPS measurements can be ineffective in the absence of turns or maneuvers, so some of the specified uncertainties, esp.~for heading, can be exceeded significantly in such cases, as noted in Table~\ref{tab:Gust-pod-measurements}. 


\subsubsection{Ambient or static pressure}

Ambient pressure (variable PS\_GP) is measured by a digital transducer with \index{pressure!ambient!gust pod}\index{gust pod!components} low uncertainty, as listed in Table~\ref{tab:Gust-pod-measurements}. However, the Rosemount 858 probe is located under the wing in a location where there is significant airflow distortion, so these measurements often differ from the measurements from the static buttons on the fuselage by 10--20\,hPa and significant corrections are needed if these measurements are to be used for pressure measurements. With the gust-pod, the use of this measurement is as a reference for the differential measurement of dynamic pressure because the dynamic-pressure transducer is connected between the total-pressure port on the front of the 858 probe and the static ports. No calibration has been determined that would make this measurement useful as a measure of true ambient pressure, although that could be done by fitting to match the standard static pressure. In the absence of such a correction, PS\_GP should not be considered an alternate measurement of ambient pressure. The use of this measurement to determine an alternate measure of airspeed will be discussed in Section~\ref{sub:GP-TAS}. 


\subsubsection{Dynamic pressure}

The dynamic pressure QC\_GP\sindex[var]{QC_GP>@QC\_GP} is measured by a differential pressure transducer, \index{pressure!dynamic!gust pod}\index{gust pod!components} with specifications listed in Table~\ref{tab:Gust-pod-measurements}. The measurement is the pressure difference between the forward-pointing port on the Rosemount 858 probe and the static ports on the side of that probe. Because the system is located under the wing in a region of disturbed airflow, the dynamic pressure requires unconventional correction to obtain the airspeed, as discussed in Sect.~\ref{sec:Calibrations}. This measurement is also used in the calculation of flow angles from the gust-pod pressure ports, as also discussed in that section. 


\subsubsection{Airflow angles}

The difference between pressures at \index{angle!airflow!gust pod} the top and bottom ports of the Rosemount 858 probe (ADIF\_GP)\sindex[var]{ADIF_GP>@ADIF\_GP} and the corresponding difference between right and left ports (BDIF\_GP)\sindex[var]{BDIF_GP>@BDIF\_GP} are also measured using differential transducers listed in Table~\ref{tab:Gust-pod-measurements}. These are digital transducers that produce output with a fixed relationship to the pressure differences, and those digital outputs are recorded by the aircraft data system. 


\subsubsection{Components of aircraft velocity relative to the Earth}

The C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS}\index{IRU!C-MIGITS} IRU, mounted with the gust pod, provides digital representations of the ground-speed components CVEW\_GP\sindex[var]{CVEW_GP>@CVEW\_GP} and CVNS\_GP\sindex[var]{CVNS_GP>@CVNS\_GP} and the vertical speed CVSPD\_GP.\sindex[var]{CVSPD_GP>@CVSPD\_GP} (cf.~Table~\ref{tab:Gust-pod-measurements}). The unit incorporates a GPS\index{Global Positioning System} receiver and uses GPS information as input to a Kalman filter\index{filter!Kalman} for adjustment of these measurements and others discussed in this section. 


\subsubsection{Temperature and humidity}

Air temperature and dew point are measured in the same way as discussed for the radome system in Sects.~\ref{sub:Temperature} and \ref{sub:dewpoint}, and the same variables (ATX and DPX)\sindex[var]{ATX>@ATX}\sindex[var]{DPX>@DPX} are used. 


\subsubsection{Examples of measurements}

A new calibration is developed in Section \ref{sec:Calibrations}. On the basis of that calibration, it appears that the gust pod provides a useful alternative to the standard wind measurements, at least for the vertical and longitudinal components of the wind. Plots and average values are presented in that section to support the validity of this measurement.\index{example of measurements!gust pod} 

% For coding of the processing and construction of the plots used here,
% see the file \textasciitilde{}cooperw/ RStudio/DEEPWAVE/GustPodProcessor.Rnw
% on EOL file systems. This program, if run from within the html interface
% to RStudio on tikal using the \textquotedbl{}Compile PDF\textquotedbl{}
% function, will produce this section of the current document while
% processing a netCDF file to add new gust-probe variables to it. The
% processor also attempts to flag bad CTHDG\_GP measurements, which
% apparently occur as the heading moves through 180 deg. (This would
% be better replaced by interpolation at these points.)

%For similar
%results from DEEPWAVE rf05, saved for reference, see GPcal.pdf, a
%note saved on 22 June 2014.\marginpar{XXX}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/vw-gp-vs-wic-1} \caption[Comparison of vertical wind calculated from the gust pod (WI\_GP) to the conventional measurement of vertical wind (WIC)]{Comparison of vertical wind calculated from the gust pod (WI\_GP) to the conventional measurement of vertical wind (WIC). The dashed orange line is a 1:1 reference line, and each blue dot represents a 1-s pair of corresponding measurements.}\label{fig:vw-gp-vs-wic}
\end{figure}


\end{knitrout}
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend \begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/hw-gp-vs-std-1} \caption[Horizontal wind direction and speed from the gust pod and from the conventional radome-based system.]{Comparison of horizontal wind direction (top panel) and horizontal wind speed (bottom panel) as determined from the gust pod and from the conventional radome-based system, for measurements where the airspeed is greater than 130 m/s (to exclude periods of possible flap deployment). Only measurements considered valid are plotted for the gust pod; the restrictions where the gust-pod measurement is flagged as missing and therefore is not plotted here are: altitude (GGALT) > 5000 m, absolute value of roll (ROLL) < 5$^{\circ}$. This causes exclusion of some measurements near the start and end of the flight and during turns.}\label{fig:hw-gp-vs-std}
\end{figure}


\end{knitrout}

The following are some plots that show the results of this processing, in this case from DEEPWAVE flight 16 on 4 July 2014. Figure~\ref{fig:vw-gp-vs-wic} shows  a comparison of the vertical wind calculated from the gust pod (WI\_GP)\sindex[var]{WI_GP>@WI\_GP} vs the conventional vertical wind (WIC)\sindex[var]{WIC>@WIC}. The standard deviation between the two measurements is 0.27\,m/s. % mean diff 0.13 
This is a good illustration of performance because this is a flight with large-amplitude waves and some of the largest vertical-wind measurements in the DEEPWAVE project, so the consistency of these measurements even to extremes in this plot indicates that the measurements from the gust pod are useful even for these large-amplitude measurements. Figure~\ref{fig:hw-gp-vs-std}\sindex[var]{ROLL>@ROLL} shows the corresponding horizontal-wind measurements, and also shows good agreement between the gust pod and the conventional wind-sensing system.\footnote{Some spikes would occur in turns if the exclusions listed in the figure caption were not applied to the measurements from the gust pod. These are the result of a problem with the C-MIGITS IRU measurement of heading, which exhibits noisy fluctuations as it moves through 180$^{\circ}$.  These fluctuations introduce large perturbations in the horizontal wind measurements,  affecting esp.~the east component of the wind. This
problem was solved after the data files used in these studies were produced, and it will not appear in reprocessed or future data files.} 

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/vw-gp-small-segment-1} \caption[A 30-min segment from flight 16 of the DEEPWAVE project, showing the good agreement of the vertical wind measurements from the gust pod (WI\_GP) and from the conventional wind-sensing system on the GV (WIC)]{A 30-min segment from flight 16 of the DEEPWAVE project, showing the good agreement of the vertical wind measurements from the gust pod (WI\_GP) and from the conventional wind-sensing system on the GV (WIC).}\label{fig:vw-gp-small-segment}
\end{figure}


\end{knitrout}

A small segment of flight from a period with large-amplitude waves is shown in Fig.~\ref{fig:vw-gp-small-segment}. The two measurements match quite well in regard to the structure of these waves and the amplitudes of the fluctuations. The measurements of horizontal wind speed are in similar agreement, but the wind direction for this period shows an offset for the gust pod measurement relative to the conventional measurement, varying from about 5$^{\circ}$ near the start of this period to about 1$^{\circ}$ near the end. This is a result of an apparent error in heading from the C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} IRU, a common feature to see near the start of flights but one that usually was made smaller during flight by GPS updating via the Kalman filter in that IRU. 

The result of this error in wind direction and additional problems that occur with measured heading very close to southbound complicate the use of the measurements of horizontal wind from the gust pod and make them of lesser quality that the standard measurements. Fortunately, in DEEPWAVE and most projects, the horizontal-wind measurements are available from the radome-based system on all flights and are usually not compromised even when there is loss of the measurement of angle of attack from plugging of the lines in the radome, because the side-mounted ports for the measurement of sideslip seldom are plugged. 


% \begin{figure}
% {\centering \includegraphics[width=300pt]{figure/Plotted-Results1}
% 
% }
% 
% \protect\protect\caption[WIG (vertical wind based on the gust pod) plotted against WIC (vertical
% wind from the conventional radome-based gust system)]{WIG (vertical wind based on the gust pod) plotted against WIC (vertical
% wind from the conventional radome-based gust system)\label{fig:Plotted-Results1}}
% \end{figure}
% 
% 
% \begin{figure}
% {\centering \includegraphics[width=300pt]{figure/Plotted-Results2}
% 
% }
% 
% \protect\protect\caption[Angle of attack determined from gust-pod measurements, plotted vs]{Angle of attack determined from gust-pod measurements, plotted vs.
% corresponding measurements AKRD from the standard wind sensing system\label{fig:Plotted-Results2}}
% \end{figure}
% 
% 
% \begin{figure}
% {\centering \includegraphics[width=300pt]{figure/Plotted-Results3}
% 
% }
% 
% \protect\protect\caption[Comparison of horizontal wind measurements from the gust pod (red
% lines) and from the standard wind measurements WDC and WSC (thicker
% blue lines)]{Comparison of horizontal wind measurements from the gust pod (red
% lines) and from the standard wind measurements WDC and WSC (thicker
% blue lines).\label{fig:Plotted-Results3}}
% \end{figure}
% 
% 
% \begin{figure}
% {\centering \includegraphics[width=300pt]{figure/Plotted-Results4}
% 
% }
% 
% \protect\protect\caption[Comparison of vertical wind measurements from the gust pod (red line)
% and from the standard wind measurement (WIC, blue line)]{Comparison of vertical wind measurements from the gust pod (red line)
% and from the standard wind measurement (WIC, blue line).\label{fig:Plotted-Results4}}
% \end{figure}
% 
% 
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=10cm]{GPrf11Fig1} 
% \par\end{centering}
% 
% \protect\protect\protect\caption{\label{fig:3panelHWVW}A comparison between the conventional wind
% components (blue lines) and the wind from the gust pod (red lines).
% Data from flight RF05.}
% \end{figure}
% 
% 
% Some plots showing the nature of the new variables (WDG, WSG, WIG)
% are included here. The first one (Fig.~\ref{fig:3panelHWVW}) shows
% a comparison of all three wind variables for a segment from flight
% RF11. The spike in WSG at about 9:43 has a known origin and will be
% removed. There is also a short period near 9:23 when the vertical
% wind measurements appear offset by a few tenths m\,s$^{-1}$. Otherwise, the
% gust pod provides a good representation of the standard variables.
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=10cm]{GPrf11Fig2} 
% \par\end{centering}
% 
% \protect\protect\protect\caption{\label{fig:ExpandedViewF1}An expanded view of a section of Fig.~\ref{fig:3panelHWVW}.}
% \end{figure}
% 
% 
% Figure \ref{fig:ExpandedViewF1} shows an expanded view and emphasizes
% the small difference between wind speeds from the two systems; this
% is likely caused by IRU differences and can later be improved by reference
% to the GPS signals with OMNISTAR. The similarities and differences
% in WIG vs WIC are also more evident in this figure.

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=10cm]{SpecialGraphics/GPrf11Fig5.png}  
\par\end{centering}

\protect\caption{\label{fig:VarSpecWICandWIG}Variance spectra for WIC (red line labeled PSD, unsmoothed, and also shown smoothed as the blue line), compared to the smoothed spectrum for WIG from the gust pod (green line). Data from DEEPWAVE flight 5, 9:15:00--9:40:00.\index{variance spectrum!vertical wind!gust pod}\index{power spectrum|see {variance spectrum}}} 
\end{figure}
\sindex[var]{WIC>@WIC}{\sindex[var]{WIG=alternate name for WI\_GP, used for non-standard calculations}


Figure \ref{fig:VarSpecWICandWIG} shows variance spectra from the two systems. There is a significant difference at frequencies above about 3 Hz, with the gust-pod distribution dropping faster and the standard wind WIC\sindex[var]{WIC>@WIC} showing more variance. The high frequency spectrum from the gust pod may be more realistic; it is unusual to see high variance at these frequencies without a related generating source. The coherence between the radome and gust-pod measurements was above 0.9 for frequencies less than 1 Hz but then fell to around 0.2 at 10 Hz. This is an indication that the two measurements are different in important ways at high frequency. This would not be the case if they were responding with different amplitudes; the signals must really be mostly incoherent at the highest frequency. The separation wing-to-fuselage is about 7 m lateral and 13 m longitudinal, so that doesn't seem enough to cause the low high-frequency coherence. The phase changes from in-phase at frequencies less than 1 Hz to 180$^{\circ}$ out-of-phase at 9 Hz, with WIG\sindex[var]{WIG>@WIG} lagging, so this is consistent with the longitudinal offset. Shifting WIG relative to WIC\sindex[var]{WIC>@WIC} also gave maximum coherence when WIG was shifted forward 1/25 s. Figure~\ref{fig:FurtherExpandedWIGshifted} shows an example of the good correspondence between gust-pod and radome measurements of vertical wind after application of such a shift to 25-Hz measurements. 

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=10cm]{SpecialGraphics/GPrf11WIGshiftM1.png}  
\par\end{centering}

\protect\caption{\label{fig:FurtherExpandedWIGshifted}Comparison of vertical wind as measured by the gust pod (WIG,red line) and the standard measurement (WIC, blue line) after shifting WIG 1/25 s earlier to compensate for the longitudinal displacement of the sensor.} 
\end{figure}
\sindex[var]{WIC>@WIC}\sindex[var]{WIG>@WIG}


\subsubsection{Mixing of Attitude Angles for the Gust Pod}

% The gust pod does not yet perform well
% in turns. The reason is that the gust-pod IRU is oriented to point a few degrees from
% the longitudinal axis of the aircraft, and as
% a result any roll of the aircraft introduces complex combinations
% of roll, heading, and pitch into the gust-pod IRU. It should be possible
% to remove these to some extent, but a procedure for correction of the
% angles in turns has not yet been developed or implemented.

% The circle maneuvers
% from the calibration flight should provide valuable information regarding
% the potential for improving the in-turn performance of the gust pod.

The attitude angles (pitch, roll, \index{gust pod!problem in turns} heading) as measured by the gust-pod IRU are defined relative to the orientation of the inertial unit in the gust pod, which is aligned a few degrees from the longitudinal axis of the aircraft. The canisters on the GV are oriented with axis pointing inward and downward relative to the aircraft longitudinal axis, in order to align with normal airflow at the pods. This is desirable for hydrometeor sampling and minimum drag, but it complicates the calculation of wind because roll introduced in turns, primarily a rotation about the aircraft longitudinal axis, will appear as a combination of attitude-angle changes in the gust pod. Errors arising from the initial alignment at the start of flights will also cause problems with the measured attitude angles, and it is likely that these will be more significant near the start of flights because the built-in Kalman filter uses GPS measurements to correct such errors in the course of the flight. 

This problem with the reference frame for attitude angles has two consequences:  
\begin{enumerate}
\item Measurements from the gust pod in turns have large errors in comparison to the errors in level flight, because for example relatively large errors in heading can contribute to errors in pitch. The measurements from the gust pod should probably be flagged as of poor quality whenever the roll exceeds some threshold like perhaps $\pm5^{\circ}$. The measurements usually look reasonable in turns despite this worry, but the largest errors occur there.  
\item There may be an offset introduced by the mixing of sideslip and angle of attack, arising from the difference in roll angle, and this will affect the reference or average value of the measured vertical wind. Some flights (e.g., DEEPWAVE\index{DEEPWAVE!flight 18} flight 18) have a significant offset in vertical wind from the gust pod at the start of the flight, related to offsets in heading and roll, that gradually is corrected in the course of the flight via the C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} III IRU Kalman filter.  
\end{enumerate}
Because the weight of the aircraft decreases during the flight, so does the angle of attack. When the wing flexes, the measured sideslip at the gust pod also varies with weight of the aircraft. This change in sideslip causes an offset in the mean lateral component of the wind as measured by the gust-pod system. 

% as shown by Fig.~\ref{fig:SSGPrf18}, so there will be an offset
% in sideslip that will affect the mean lateral component of the wind.
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=10cm]{GPF1} 
% \par\end{centering}
% 
% \protect\protect\protect\caption{\label{fig:AOAGPrf18}Angle of attack measured by the gust-pod system
% on DEEPWAVE flight RF18.}
% \end{figure}
% 
% 
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=10cm]{GPF2RF18} 
% \par\end{centering}
% 
% \protect\protect\protect\caption{\label{fig:SSGPrf18}Sideslip angle measured by the gust-pod system
% on DEEPWAVE flight RF18.}
% \end{figure}
% 
% 
% In addition, this flight had a particularly large offset in the vertical
% wind from the gust pod (WIG) at the start of the flight, as shown
% in 
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=10cm]{GPF3} 
% \par\end{centering}
% 
% \protect\protect\protect\caption{\label{fig:WIGoffset}The vertical wind determined by the gust pod
% (WIG) and via standard processing (WIX, to distinguish this from WIC
% as determined by erronous in-field processing), for flight RF18 of
% the DEEPWAVE project.}
% \end{figure}
% 
% 
% Fig.~\ref{fig:WIGoffset}. This offset is associated with a brief
% period where the difference in heading between the IRU in the gust
% pod and that in the fuselage were unusually large, as shown in 
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=10cm]{GPF4} 
% \par\end{centering}
% 
% \protect\protect\protect\caption{\label{fig:HDGerror}The difference in heading between the values
% measured by the IRU in the gust pod and the IRU in the cabin, for
% DEEPWAVE flight RF18.}
% \end{figure}
% 
% 
% Fig.~\ref{fig:HDGerror}. In addition, the mean value of the measured
% roll was close to zero for the in-cabin IRU but about 1.375$^{\circ}$
% for the gust-pod IRU. Coupling among these attitude angles appears
% to have caused the large offset in WIG at the start of this flight.
% Because the gust-pod IRU incorporates a Kalman filter that can use
% measured errors in position and ground speed as determined by comparison
% to a GPS measurement to refine the measurements, the large error appears
% to have been corrected as the flight progressed.

These effects suggest that the vertical wind measured by the gust pod may have an offset in some cases, particularly at the start of flights, and the measurement of sideslip can also have an offset that will contribute to the lateral component of the measured wind. These are weaknesses in the measurements from the gust pod that, at this stage, do not appear easily corrected. A future study implementing Schuler tuning in a post-processing step and correcting for the entwined-angle effects may be able to reduce these weaknesses, but that will require continued analysis not performed for this report. It may also be possible to develop special processing that corrects the measurement of attitude angles in turns, but that has not yet been developed or implemented. 
% 
% \subsubsection{Next Steps}
% \begin{enumerate}
% \item A procedure for processing the gust-pod measurements will be needed.
% It may be possible to use code in gusto.c for this purpose or otherwise
% to implement the process used here into nimbus, because this is being
% done second-by-second as needed for nimbus. Alternately, the code
% used here can run after nimbus processing to add the gust-pod variables.
% If this course is followed, the R script could be improved because
% I didn't vectorize the angle transformations yet, in the interest
% of getting it to work first. The software / data processing group
% will have to decide which is better, and it may be preferable to use
% different procedures for DEEPWAVE and for future use in order to produce
% the DEEPWAVE data quickly. 
% \item As noted above, there are issues with the gust-pod measurements in
% turns that need to be addressed. These issues will affect the standard
% data also because in turbulence the roll changes and this may feed
% into the other measurements even at small roll angles. 
% \item The relative timing of the measurements entering the calculation of
% wind still needs to be addressed. The IRU information is transmitted
% for recording with some delay, and corrections for those delays are
% in place. However, small errors in those delays can cause phase shifts
% among the measurements that, for example, result in residual perturbations
% of the vertical wind during pitch maneuvers. These should be tuned
% to minimize those perturbations. 
% \item An additional worthwhile study will be to see if using GPS measurements
% to determine the Schuler oscillation can improve measurements of pitch
% and heading and so lead to improved wind measurements. There is some
% evidence of this problem in an apparent changing offset in the vertical
% wind, so any improvement here can be very useful to DEEPWAVE. \end{enumerate}

\subsection{The laser air-motion sensor\label{sub:LAMS-description}}

\subsubsection{General description}

The laser air-motion sensor (LAMS)\index{laser air-motion sensor} is still under development so results presented here will be more tentative than for the other systems. The characteristics and associated uncertainties in measured wind are discussed by \citet{SpulerEtAl2011} and \citet{CooperEtAl2014}. Figure~\ref{fig:LAMSschematic} shows the one-beam LAMS as installed on the GV, and Fig.~\ref{fig:LAMS-4Beam} shows the LAMS wind-pod used for the three or four-beam version.\index{LAMS!schematic}

\begin{figure}%
\noindent \begin{centering}%
\includegraphics[width=0.9\columnwidth]{SpecialGraphics/amt-2014-0031-f01.png}%
%\includegraphics[width=120mm]{amt-2014-0031-f01}%
\caption[Diagram showing the LAMS as operated on the GV.]{Diagram of the LAMS. Light generated by the laser in the cabin is transmitted by optical fibers to a~wing pod, where it is transmitted in a beam that has a~focal point well ahead of the aircraft (farther ahead than suggested by this not-to-scale diagram). The light backscattered from aerosol particles in the focal region is collected by the lens, and a circulator routes the returned signal, along with a~portion of the transmitted signal (generated from a reflection at the end of the transmission fiber) back to the cabin along a separate return fiber. The resulting signal, with interference patterns that measure the Doppler shift of the backscattered light, is digitized and recorded by the data acquisition system in the cabin. Also illustrated in this figure are the approximate locations of the static pressure ports and the fuselage pitot tube used by the research data system to measure static and dynamic pressures. This figure appears in Applied Optics in the article by \citet{SpulerEtAl2011} and is used here with permission from the Optical Society of America.\label{fig:LAMSschematic}}%
\end{centering}%
\end{figure}%
\begin{figure}%
\noindent \begin{centering}%
\includegraphics[width=0.59\columnwidth]{SpecialGraphics/LAMS-1r}% 
\includegraphics[width=0.4\columnwidth]{SpecialGraphics/LAMS-2r}% 
\caption{The four-beam configuration of the LAMS optical head as installed in a GV under-wing pod.}%
\label{fig:LAMS-4Beam}\index{LAMS!photograph}%
\end{centering}%
\end{figure}%
The system consists of one, three or four fiber-based laser beams focused ahead of the aircraft and a collection system to detect the Doppler shift in light backscattered from aerosols. The transmitter optical components are mounted in an under-wing pod, similar to that used for the gust pod, and like the gust pod the system incorporates a compact \sindex[var]{SDN500=model of IRU used with the gust pod}\index{IRU!LAMS}\index{IRU!SDN500}Systron Donner SDN500 GPS/INS MEMS Tactical Grade navigation system (henceforth called the SDN500 IRU) to measure the attitude angles and ground speed\index{speed of aircraft!ground speed} of the pod. Early measurements from this system have been used to determine corrections to the pressure measurements, and those serve an important role in reducing uncertainty in the wind measurements, as described in \citet{CooperEtAl2014} and later in this report.\footnote{LAMS measurements prior to July 2014 used a C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} III IRU with characteristics identical to those listed for the gust-pod IRU. The specifications for the SDN500 are almost
identical but the performance of the SDN500 appears to be better than the C-MIGITS III.} 

LAMS hardware supports up to four \index{LAMS!4-beam configuration} beams, with three pointing $35^{\circ}$ off the forward direction and separated by $120^{\circ}$ in the azimuthal direction. The fourth beam is directed forward from the LAMS unit. The LAMS\index{LAMS!in DEEPWAVE} channel designations changed after DEEPWAVE (summer 2014) when it was decided the instrument would benefit from having a lower noise channel for forward pointing measurements (the laser/detector on channel 4 had lower signal-to-noise ratio than the other three channels). Table \ref{tab:BeamConfig} summarizes the labels and pointing angles of each beam for both up to and after DEEPWAVE. The number designation refers to the laser, detector, and data processing channels, and the letter designation is associated with the exit window on the LAMS head. The pointing angles reported here are target values; measured values are given below. The angle $\theta_L$ is measured relative to the forward direction of the LAMS pod (approximately the angle between the beam and $\hat{x^{\prime}}$) and the angle $\phi_L$ is the rotation angle about $\hat{x^{\prime}}$ relative to the $\hat{z^{\prime}}$ axis. This geometry is designed for GV installation where the LAMS pod is installed on the left wing, outboard pylon, outboard position.\footnote{The pointing geometry relative to the aircraft may change based on the installation configuration on the C-130 (to be determined in fall 2015) where the LAMS optical fibers are routed to the aircraft right wing.}

\begin{table}
\begin{minipage}[t]{0.93\columnwidth}%
\begin{center}
\begin{tabular}{>{\centering}p{3.5cm}>{\centering}p{3.5cm}>{\centering}p{2.5cm}>{\centering}p{2.5cm}}
\toprule 
\textbf{Beam Name} &
\textbf{Beam Name} &
 &
\tabularnewline
After DEEPWAVE &
Before/During DEEPWAVE &
\textbf{$\theta_{L}$}  &
\textbf{$\phi_{L}$} \tabularnewline
\midrule 
Beam 1/A  &
Beam 1/A  &
$35^{\circ}$  &
$180^{\circ}$ \tabularnewline
\midrule 
Beam 4/B  &
Beam 2/B  &
$35^{\circ}$  &
$60^{\circ}$ \tabularnewline
\midrule 
Beam 3/C  &
Beam 3/C  &
$35^{\circ}$  &
$-60^{\circ}$ \tabularnewline
\midrule 
Beam 2/D  &
Beam 4/D  &
$0^{\circ}$  &
-- \tabularnewline
\bottomrule
\end{tabular}
\par\end{center}%
\end{minipage}
\protect\caption[Designations and ideal orientations of LAMS beams for installation on the GV.]{Designations and ideal orientations of LAMS beams for installation
on the GV. $\theta_{L}$ is the angle from the longitudinal axis of
the aircraft to the beam, and $\phi_{L}$ is the azimuthal angle of
rotation about the longitudinal axis relative to the downward (aircraft-axis)
direction, with positive values to starboard. In particular, beam
1 is upward at an angle of 35$^{\circ}$ from the centerline of the
aircraft.\label{tab:BeamConfig}\index{LAMS!pointing angles}}
\end{table}

During the test program IDEAS-4-GV (Instrument Development and Education in Airborne Science Phase 4) in Sept-Oct 2013,\sindex[var]{IDEAS-4-GV=Instrument Development and Education in Airborne Science Phase 4} the LAMS beams\index{LAMS!focal distance} were focused approximately 15 m from the LAMS exit ports on the pod. After this flight program, concerns were raised about the aircraft causing flow distortion in the LAMS sample \index{LAMS!airflow distortion} volumes, and the beam focus was moved to 20 m from the exit port. In both cases the sample volume is approximately 2 m long. 

\subsubsection{Relative Beam Pointing}

The relative pointing of the LAMS beams is defined by the orientation of each beam relative to the others. If the absolute pointing direction of one beam is known, the relative pointing may be used to determine the absolute pointing of all other beams. We define the relative pointing coordinates such that the z-axis is directed along the forward beam (D). The angle $\theta_{L}$ is the angle between the beam and the z-axis and the azimuthal angle $\phi_{L}$ is measured relative to the x-axis such that beam 1 (A) is positioned at $\phi_{L}=180^{\circ}$.\sindex[lis]{phi\_subL@$\phi_{L}$=LAMS azimuthal pointing angle}\sindex[lis]{theta\_subL@$\theta_{L}$=LAMS pointing angle from longitudinal axis}\marginpar{180 OK?}

Two methods were used to determine the relative pointing angles. The first, performed prior to September 2013, used a FARO Laser Tracker Survey, in which a commercial laser surveying\index{LAMS!pointing angles!survey} company measured the positions of the LAMS head and the beam focal points. The 
LAMS head was positioned in the hangar so the bottom two beams were approximately parallel to the floor. Two infrared (IR) card targets were placed at the focal points of those beams. 

A laser tracker locks onto a locating target, a precise corner cube reflector that contacts the surfaces being surveyed, to register the surface
position in space. The corner cube target was first used to estimate the position of the LAMS exit ports by taking a series of points around their circumference. The tracker then registered the positions of the IR card targets by the same method. Once complete, the LAMS head was rotated by $120^{\circ}$ and the process was repeated. This measurement was repeated for three different LAMS head rotations, where two beams were surveyed at a time. 
The beam exit and target measurements were then used to provide a best fit for the beam pointing angles. 

The benefits of this method are  
\begin{itemize}
\item It measures the beam focal distance. 
\item A laser tracker provides exceptionally good 3-dimensional locations with an uncertainty of 25\,$\mu$m (0.001\,in) at 5~m range.

\end{itemize}

The weaknesses of this method are  
\begin{itemize}
\item Only two beams can be surveyed at any one time. 

\item The measurement process can perturb the beam target because
contact is required. 

\item There is no reference to the SDN500 IRU. 

\item There is no independent redundant measurement and uncertainty is difficult to quantify. 

\item The survey can be expensive, requiring the hire of an outside vendor.  
\end{itemize}

%The beam pointing results from the telescope measurement system are typically used going forward, first because they are the most recent beam pointing measurements, but also because redundant measurements and the position invariance of Fourier plane measurements generally illicit greater confidence in those pointing results.

%\subsubsubsection{Laser Survey}

% Prior to IDEAS-4-GV in Sept.--Oct.~2013, a laser survey system was used to estimate the LAMS beam pointing angles of Beams 1, 2, and 3 (the forward pointing beam had not been added at that point). 

%The results of the laser survey method were used to process IDEAS-4-GV data, but those angle calibrations have since been traded for the Telescope technique described below. 


%\subsubsubsection{Telescope Measurement}

The second method used an afocal off-axis telescope as a 30x beam reducer with
an additional focusing lens and target (referred to here as the receiver
system). The LAMS head was mounted in an astronomical telescope
elevation-over-azimuth (El/Az) gimbal mount. A CCD (charge-coupled device) camera was placed at the focal 
point of the receiver system and the El/Az gimbal mount was used to steer
the LAMS beams into the receiver system such that each beam was centered on
the camera. This method provided redundant pointing-angle measurements, using
both the IRU (SDN500) and telescope-mount measurements of angles.

With this method, the
relative positions of the LAMS system can be determined by defining a fixed reference vector and directing each beam onto it. The pointing of the LAMS module is recorded when each beam is directed onto the reference. Without absolute knowledge of the reference vector, this only allows the relative beam geometry to be determined. Thus, we define a LAMS beam pointing coordinate frame such that the z-axis is along the forward beam. 

The telescope beam measurement system was developed in house to provide position insensitive angular measurement. It uses a 30x beam expander consisting of an off-axis parabola and convex secondary (exact type is unknown). The light from that beam expander is focused onto an IR card using a 50 mm lens, yielding a total focal length of 1.5 m. The IR card was then reimaged using a 45 mm lens onto a CCD to monitor the beam position (see Figure \ref{fig:TelescopePointingRX} and \ref{fig:TelescopePictures}). 

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=10cm]{SpecialGraphics/BeamPointing_ReceiverDiagram}  
\par\end{centering}
\protect\caption[Diagram of the LAMS receiver system]{\label{fig:TelescopePointingRX}Diagram of the receiver system. The invisible infrared beam enters the beam expander which amplifies the angle of the beam relative to the telescope optic axis, and is then focused onto an IR card. The IR card fluoresces at a visible wavelength and that light is reimaged onto a CCD.} 
\end{figure}

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=10cm]{SpecialGraphics/BeamPointingCollection-r.png}  
\par\end{centering}
\protect\caption[Photographs of the telescope angle measurement system.]{\label{fig:TelescopePictures}Photographs of the telescope angle measurement system in the RAF optics lab. View of the setup from behind the LAMS pod (top left), the receiver system (bottom left), LAMS mounted in the telescope mount (right).} 
\end{figure}

With the IR card at the back focus of the optical system, the beam image is position independent. Its location in this plane is dictated solely by the angle of the input beam. Even though each beam is slightly translated relative to its counterparts, we can still perform accurate angle measurements. 

The precision telescope mount onto which the LAMS system was mounted provides angular measurements with uncertainty of about $1^{\prime\prime}$ or about $0.0003^{\circ}$. The mount gives fine resolution in adjusting LAMS pointing into the receiver reference system and provides a digital readout of altitude and azimuth coordinates. These coordinates provide the first set of pointing data for the LAMS system. The second set of pointing data is provided by the SDN500 IRU, which is attached and operated during data collection. Thus, two measurements of the LAMS pointing are provided. 

The telescope mount readout provides the quantities altitude angle ($\vartheta_{T})$\sindex[lis]{theta\_T@$\vartheta_{T}$=altitude angle, telescope mount, LAMS calibration} and azimuth angle ($\varphi_{T}$).\sindex[lis]{phi\_T@$\varphi_{T}$=azimuth angle, telescope mount, LAMS calibration} When a beam is directed into the reference telescope, it is accomplished through rotation operations:  
\begin{equation}
\hat{r}=\mathbf{R}(\vartheta_{T},\hat{x})\mathbf{R}(\varphi_{T},\hat{y})\hat{u},\label{TelMountReference}
\end{equation}
where $\hat{r}$\sindex[lis]{r\_hat@$\hat{r}$=reference direction, LAMS receiving telescope, for LAMS angle calibration} is the reference direction of the receiving telescope, $\hat{u}$ is the beam pointing direction and $\mathbf{R}(\gamma,\hat{v})$\sindex[lis]{R\_LAMS@$\mathbf{R}(\gamma,\hat{v})$=rotation matrix used for LAMS calibration} is a rotation matrix of angle $\gamma$ about the vector $\hat{v}$. 

To determine the beam pointing angle, we invert the rotation operations (or perform the opposite rotations in the opposite order), which results in  
\begin{equation}
\hat{u}=\mathbf{R}(-\varphi_{T},\hat{y})\mathbf{R}(-\vartheta_{T},\hat{x})\hat{r}.\label{TelMountBeam}
\end{equation}
To obtain a beam pointing vector, we first need to know the reference vector in some coordinate basis. We let Beam 4 (the forward pointing beam) define the z-axis in this coordinate basis and obtain $\hat{r}$ by evaluating Eq. \eqref{TelMountReference} for the recorded Alt/Az angles of Beam 4 (D) where $\hat{u}=\left[\begin{array}{ccc} 0 & 0 & 1\end{array}\right]^{T}$. We then obtain all other beam vectors from their respective altitude and azimuth coordinates using Eq. \eqref{TelMountBeam}. 

The process for obtaining the beam pointing vectors from the SDN500 IRU is essentially identical to the process above, except that the SDN500 IRU provides roll, pitch and heading. It should be noted, as will be addressed later, that the SDN500 IRU heading is not reliable when the device is stationary. 

After the pointing angles of the beams are obtained from the telescope mount and SDN500 IRU, the pointing angles need to be compared. However, the beam vectors are recorded in different coordinate frames and SDN500 IRU heading data cannot be treated as reliable. A transformation matrix between these two frames and heading adjustments to SDN500 IRU are determined using minimization of errors so we can compare the beam pointing results. Table \ref{tab:AngleDiff} shows the difference in angle between each of the four beams after optimizing the transformation between the two coordinate frames. The two beam pointing measurements give results that are quite close. 

\begin{table}
\begin{minipage}[t]{0.93\columnwidth}%
\noindent \begin{center}
\begin{tabular}{>{\centering}p{2.5cm}>{\centering}p{7cm}}
\toprule 
\textbf{Beam}  &
\textbf{Angle difference between \\
SDN500 IRU and Telescope Mount}
\tabularnewline
\midrule
\midrule 
Beam 1 (A) &
\tabularnewline
(Upward)  &
$0.024^{\circ}$ \tabularnewline
\midrule 
Beam 2 (B) &
\tabularnewline
(Down-In)  &
$0.004^{\circ}$ \tabularnewline
\midrule 
Beam 3 (C) &
\tabularnewline
(Down-Out)  &
$0.003^{\circ}$ \tabularnewline
\midrule 
Beam 4 (D) &
\tabularnewline
(Forward)  &
$0.024^{\circ}$ \tabularnewline
\midrule 
  &
\tabularnewline
\end{tabular}
\par\end{center}%
\end{minipage}
\protect\caption{Differences between angles measured by the SDN500 IRU and the telescope mount, for each beam.\label{tab:AngleDiff}}
\end{table}

To assess the uncertainty in beam pointing angles, the focused beam was positioned across the IR card to determine the spread of angles accepted by the optical system. The full angle field-of-view of the system was approximately $2^{\prime}$ or about $0.02^{\circ}$. The beam spot position can be repeated to greater accuracy than this (we can see when it is well centered using the CCD), however this is probably a reasonable uncertainty figure because the IR card may not be located at the exact Fourier plane of the optical system.  

The benefits of the telescope beam measurement method\index{LAMS!angle calibration!telescope method} are:  
\begin{itemize}
\item All four beams are measured without changes to the setup. 

\item The measurement is \textquotedbl{}hands off\textquotedbl{}, so there is very little risk of perturbing the system during the measurement processes. 

\item The process provides redundant angle measurements (SDN500 IRU and the telescope mount). 

\item The entire LAMS pod is used and referenced directly to the same SDN500 INS used in flight.  
\end{itemize}

The weaknesses of this method are:  
\begin{itemize}
\item Beam focal positions are not measured. 

\item Setup and alignment of the system is time consuming (approximately 2 days). 

\item The procedure still does not provide an absolute pointing measurement because the telescope acceptance vector is not known.  
\end{itemize}

\begin{table}
{\footnotesize{}}%
\begin{minipage}[t]{0.93\columnwidth}%
\begin{tabular}{>{\centering}p{1.8cm}>{\centering}p{1.8cm}>{\centering}p{1.8cm}>{\centering}p{1.8cm}>{\centering}p{1.8cm}>{\centering}p{1.8cm}>{\centering}p{1.8cm}}
\toprule 
\textbf{Beam}  &
\textbf{$\theta_{L}$ Telescope}  &
\textbf{$\theta_{L}$ SDN500 IRU}  &
\textbf{$\theta_{L}$ Laser Survey}  &
\textbf{$\phi_{L}$ Telescope}  &
\textbf{$\phi_{L}$ SDN500 IRU}  &
\textbf{$\phi_{L}$ Laser Survey}\tabularnewline
\midrule
\midrule 
Beam 1 (A) &
 &
 &
 &
 &
 &
\tabularnewline
(Upward)  &
$35.03^{\circ}$  &
$35.08^{\circ}$  &
$34.95^{\circ}$  &
--\footnote{Beam 1 is used as the basis for $\phi=0$ in the relative pointing
coordinate frame}  &
--  &
-- \tabularnewline
\midrule 
Beam 2 (B) &
 &
 &
 &
 &
 &
\tabularnewline
(Down-In)  &
$34.86^{\circ}$  &
$34.85^{\circ}$  &
$34.96^{\circ}$  &
$119.74^{\circ}$  &
$119.74^{\circ}$  &
$120.01^{\circ}$\tabularnewline
\midrule 
Beam 3 (C) &
 &
 &
 &
 &
 &
\tabularnewline
(Down-Out)  &
$34.86^{\circ}$  &
$34.85^{\circ}$  &
$35.01^{\circ}$  &
$120.16^{\circ}$  &
$120.16^{\circ}$  &
$120.00^{\circ}$\tabularnewline
\midrule 
  &
 &
 &
 &
 &
 &
\tabularnewline
\end{tabular}%
\end{minipage}{\footnotesize \par}
\protect\caption{Comparison of beam pointing angles determined by the telescope-mount method and the laser-survey method.\label{tab:PointingAngles}}
\end{table}

The two methods for determining the beam angles are compared in Table~\ref{tab:PointingAngles}. The methods were in reasonable agreement, with differences in combined pointing angles smaller than about $0.2^{\circ}$. However, the forward pointing beam was added after the laser survey, and that required some disassembly of the LAMS head, so there might have been some small changes in the locations of the fibers on the LAMS head. Therefore, the relatively small difference in beam pointing in this table may be partially attributable to that work. 

\subsubsection{Examples of measurements\label{sub:LAMS-examples}}

Some details of the calculation of wind from the LAMS measurements are included in Sect.~\ref{sub:LAMS-uncertainty}. The single-beam measurements have been discussed in \citet{CooperEtAl2014}, but since that article was written the three-beam system was tested in flight. Some examples of the measurements are shown in the following figure. See also Sect.~\ref{sub:LAMS-aoa-and-sideslip} for further comparison of these measurements to those from the conventional system.



\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/transform-1} \caption[Wind measurements from LAMS compared to those from the standard wind-sensing system.]{Wind measurements from LAMS (WD\_LAMS, WS\_LAMS, WI\_LAMS) compared to those from the standard wind-sensing system (WDC, WSC, WIC) for a flight segment from the HCRTEST program, flight 3, 24 Nov 2014.}\label{fig:transform}
\end{figure}


\end{knitrout}

The wind components measured by the LAMS\sindex[var]{WDL=wind direction, LAMS}\sindex[var]{WSL=wind speed, LAMS}\sindex[var]{WIL=vertical wind, LAMS} are shown in Fig.~\ref{fig:transform}.\sindex[var]{WDC>@WDC}\sindex[var]{WSC>@WSC}\sindex[var]{WIC>@WIC} For the full segment, which includes maneuvers and many turns, the mean mean difference in wind direction between the LAMS and standard measurements was 0.1$^{\circ}$ with standard deviation 3.8$^{\circ}$; for wind speed, the mean difference and standard deviation were $-0.2$\,m/s and 1.4\,m/s, and for vertical wind $-.04$\,m/s and 0.9\,m/s. Some apparent
noise in the first beam between 19:50 and 20:00 UTC accounts for most of the large
standard deviation in vertical wind. Spikes in the measurements from LAMS are associated with low signal-to-noise resulting from the relatively low aerosol concentrations present at the flight level (about 20,500~ft or about 6.25 km). The two sets of measurements in this plot are
independent of each other because they are based on different measuring systems for
the relative wind and for the ground-speed components and rate-of-climb of the aircraft.
This good agreement thus provides support for the validity of the measurements from both systems.





\section{Calibration procedures\label{sec:CalProcedures}}

\subsection{Scope}

\index{calibrations!general}
The measurements from the components described in the preceding section are used to calculate the wind, but those calculations also involve several empirically determined relationships and adjustments arising either from calibrations or flight maneuvers. This short section outlines the procedures used for calibration, for determining the empirical relationships, and for quality control. It also provides links to sections of this report where the procedures are discussed in more detail.

\subsection{Laboratory calibrations}

\index{calibrations!laboratory/bench}
The key pressure sensors are digital sensors having low uncertainty and good stability, so the laboratory calibrations of those sensors are used primarily to ensure performance within specifications rather than to make adjustments to the output. 

The pressures on the GV for the measurements ADIFR,\sindex[var]{ADIFR>@ADIFR} BDIFR,\sindex[var]{BDIFR>@BDIFR} QCR,\sindex[var]{QCR>@QCR} QCF,\sindex[var]{QCF>@QCF} and PSF\sindex[var]{PSF>@PSF} (cf.~Table~\ref{tab:Radome-system-measurements}) are calibrated before each project, and a leak check is performed on the pressure lines. The calibrations are done at/on the GV by use of a portable pressure-calibration cart. All GV pressure transducers have serial outputs and quoted uncertainty limits similar to the calibration unit, so the calibration is treated as a check and external calibrations are not applied to the five pressure sensors.  

The calibration cart consists of a Ruska Digital Control Unit/Pressure Gauge (model 7010), a vacuum pump and pressure pump, and a data-system interface. The various systems are sealed off for the leak check and then the calibrations are performed. (The static ports and radome ports are sealed off with tape. For the static-pressure calibration the calibrator is attached by a "T" at the transducer. For the radome ports the calibrator is attached to the drain lines and the ports are sealed with tape. For QCF\sindex[var]{QCF>@QCF} the pressure line is connected to the nose of the pitot itself.)

A set of calibration pressures are provided by the Ruska controller, and the results are read out and recorded on the GV data system. For ADIFR\sindex[var]{ADIFR>@ADIFR} and BDIFR\sindex[var]{BDIFR>@BDIFR} the calibration pressures are $\pm$50, 40, 25, 10, 0 hPa; for QCF\sindex[var]{QCF>@QCF} and QCR,\sindex[var]{QCR>@QCR} 0 to 200 hPa in increments of 25 hPa; and for PSF\sindex[var]{PSF>@PSF}, 150, 200, 300, ..., 900, 1025 hPa.

The specifications for the controller quote precision equal to 0.003\% of full-scale and stability of 0.005\% of reading over the recommended recalibration interval. Those specifications translate to about 0.02~hPa for the range used for ADIFR, BDIFR, QCF,\sindex[var]{QCF>@QCF} and QCR\sindex[var]{QCR>@QCR} and 0.2~hPa for the range used for PSF. %007\% or 0.02 hPa for the range 1-4.9 psi (69 to 338 hpa) that is used for ADIFR, BDIFR, QCF, 
%, and QCR, and 0.003\% or 0.007% FS; for the range 5 - 100 psi (345 to 6900 hpa), PSF, 
%0.003\% FS.
All calibrations are recorded in an RAF calibration database, and any departures from standard calibrations are documented with comments in the attributes associated in the netCDF file with the measured variable.

The other basic variable entering the calculation of wind that is subject to calibration is temperature, which is needed for the calculation of airspeed.\index{temperature!calibration of sensors} The temperature sensors are calibrated in a laboratory stirred bath to determine the appropriate relationship between resistance and temperature. Then on the aircraft known resistances representing a set of fixed temperatures for the sensor to be used are inserted in place of the temperature sensor. The measured voltages corresponding to these resistances then link the bath calibration with calibration of the onboard measuring system that measures the sensor resistances. This also calibrates the analog-to-digital converters used to record the measurements\index{converter!analog to digital} and results in a calibration of temperature as a function of measured digital representation of voltage. Bath calibrations normally provide repeated calibrations with consistency small compared to 0.1$^{\circ}$C, and fits to the calibration of temperature in terms of measured voltage normally provide standard deviations between fitted and measured values smaller than 0.01$^{\circ}$C.


\subsection{Quality-assurance checks}

\index{quality assurance!IRU}
The output from the inertial sensors is monitored primarily by comparison to other similar units. The duplicate Honeywell inertial systems are compared on each flight to ensure that their performance remains consistent, and when present the gust-pod and LAMS inertial systems are also compared to each other and to the Honeywell systems. The alignment angles of the various inertial systems have been determined by survey and are not expected to change. Ground-speed measurements from the inertial systems are compared routinely to GPS measurements of ground speed,\index{speed of aircraft!ground speed} and the Schuler oscillations in ground-speed components are monitored as indicators of the quality of these measurements. The oscillating errors in ground speed normally do not exceed a few m/s and in the best cases are about 1~m/s.

Errors in the pitch measurement\index{pitch!errors} from the Honeywell inertial system will result in errors in ground-speed components, so the differences between inertial-system and GPS measurements of ground-speed components can be used as indicators of the quality of the measurement of pitch. This is discussed in detail in Sect.~\ref{sub:Schuler}, where a procedure is also developed that can reduce the uncertainty in the measurement of pitch. 

\index{quality assurance!airflow angles}
A calibration procedure for determining angle of attack and sideslip angle is developed in Sect.~\ref{sec:Calibrations}. To monitor the validity of the relationships determined there, the equations employed (\eqref{eq:alphaWithwZero} and \eqref{eq:beta-equation}) are also used during projects for quality assurance to check that the sensitivity coefficients in use give angles consistent with these predictions.

\index{quality assurance!maneuvers}
Some special maneuvers are used frequently during projects to monitor the performance of the wind-measuring systems. Pitch maneuvers,\index{maneuver!pitch} in which variations in pitch lead to oscillating vertical motion of the aircraft, are used to check that this motion does not enter the vertical-wind measurement to any significant extent. (An example is discussed in Sect.~\ref{sub:Timing}; cf.~Fig.~\ref{fig:plot-shifted-vertical-wind}.) Other maneuvers with pilot-induced sideslip\index{maneuver!yaw} are used to see that no significant effects of the sideslip enter the final wind. Speed runs\index{maneuver!speed run} provide good checks on the angle-of-attack relationships, and reverse-heading maneuvers\index{maneuver!reverse heading} (where the aircraft flies over the same drifting track in opposite directions) are also used to check for offsets in measurements of airspeed and sideslip. Finally, circle maneuvers\index{maneuver!circle} are used to check for errors in airspeed, sideslip offset, or heading offset, as discussed below (Sect.~\ref{sub:circle-summary}). 


\subsection{Finding the relative-wind angles}

\index{angle!airflow}
The angle of attack and sideslip angle are needed to determine the relative wind\index{wind!relative} (cf.~\ref{sub:The-Relative-Wind}). For the radome-based and gust-pod systems, these angles are not measured directly but are determined from empirical relationships\index{relationships!empirical}\index{sensitivity coefficients|see {relationships, empirical}} between the flow angles and pressure differences on the sensors. The procedures for determining these empirical relationships are discussed in Sect.~\ref{sec:Calibrations}. 

In the case of angle of attack\index{attack!angle of}, the procedure for determining the needed empirical relationship relies on assuming that the vertical wind is negligible over the region covered by the flight maneuver, which is normally a \textquotedbl{}speed run\textquotedbl{}\index{maneuver!speed run} where flight speed is changed gradually over the flight envelope of the aircraft. This assumption is checked by repeated calibrations, but the absence of an absolute standard for calibration leads to possible constant bias in the vertical wind that remains a key source of uncertainty. This is discussed in detail in Sect.~\ref{sub:radome-sensitivity} for the radome system and Sect.~\ref{sub:gust-pod-aoa} for the gust-pod system. 

For sideslip,\index{sideslip} the calibration uses the heading as a reference so the resulting empirical relationship relies on the heading being accurate. The fit procedure is discussed in Sect.~\ref{sub:calibration-SS}, but an adjustment to that procedure is then determined from additional flight maneuvers that permit separation of the offsets in sideslip and heading. This is discussed in Sect.~\ref{sub:circle-summary} below and in detail in Sect.~\ref{sub:Analysis-of-circle}. 

The empirical relationships used to determine angle of attack and sideslip angle are summarized in Sect.~\ref{sub:CalSummary}. 

\subsection{True airspeed}

\index{airspeed}
The measurement of airspeed for the radome-based system\index{system!standard} relies on the measurements of dynamic and ambient or static pressure\index{pressure!ambient}\index{pressure!dynamic} and so will be affected by any error in the static pressure. This has been removed by calibration using the single-beam version of the LAMS,\index{laser air-motion sensor} as discussed in detail by \citet{CooperEtAl2014}. The procedure is too involved to discuss in detail in this report, so that reference should be consulted for the determination of uncertainty in airspeed\index{airspeed!uncertainty} from the conventional system on the GV\@. In that reference, an empirical fit to the corrections determined by the measurements from the LAMS was found, and that fit is now applied to all projects including those on which the LAMS is not present. The result is an uncertainty in airspeed of about 0.1\,m/s when the single-beam LAMS is operational on the aircraft and about 0.3\,m/s otherwise. 

The gust-pod system\index{system!gust pod}\index{gust pod} can be used to determine a measurement of airspeed, but this requires an involved fit to obtain good results. This measurement is useful for two reasons. First if it may be desirable to obtain measurements of wind from the gust pod without reference to the usual radome-based system, for redundancy, backup, and quality control. Second, the gust pod provides high-frequency measurements\index{turbulence!measurements} that appear to be superior to those from the radome-based system because the pressure lines are much shorter in the gust-pod system. Determining airspeed from the gust pod is discussed in Sect.~\ref{sub:GP-TAS}, and there is a brief discussion of high-rate measurements and the usefulness of the gust pod for such measurements in Appendix B. 

\subsection{The circle maneuvers\label{sub:circle-summary}}

\index{maneuver!circle}
Flying constant-roll-angle turns while drifting with the wind provides additional \index{circle maneuver|see {maneuver, circle}} opportunities for checks and adjustment of the empirical relationships\index{relationships!empirical} and the airspeed measurement. The drift of the aircraft in such a maneuver provides a good reference measurement of the wind that is independent of all wind-sensing components on the aircraft except the GPS. In addition, a plot of measured wind speed as a function of the angle between the heading of the aircraft and the wind direction is a very useful analysis tool because any error in airspeed will produce a difference between wind measurements made while flying upwind vs\@. downwind while any error in the combination of heading and sideslip angle will produce a difference between the two portions of the circle that are crosswind. Furthermore, the sideslip angle should have opposite sign in right-turn circles vs.~left-turn circles, so this makes it possible to separate a bias in the measurement of heading from a bias in the measurement of sideslip angle. 

The analysis of circle maneuvers is discussed in detail in Sect.~\ref{sub:Analysis-of-circle}, and there the offset in sideslip angle is adjusted. The circles provide good evidence in support of the low uncertainty claimed for the airspeed measurement from the radome and for the quality of the measurements of heading and sideslip angle. 





\section{Elements of uncertainty\label{sec:Uncertainty-components}}

\subsection{General structure}

\index{uncertainty!analysis!format}
Here we follow a particular style for construction of an analysis of uncertainty, described in Appendix~A. Section~\ref{sec:Components} of this report describes each measurement contributing to the measurement of wind, and it documents what is known about specifications for uncertainty associated with those components. It also includes descriptions of the algorithms leading to components of the measured wind, for the three independent systems available for measuring wind on the GV.  
Sections \ref{sec:CalProcedures} and \ref{sec:Calibrations} provide key information on how calibration maneuvers are used to determine the sensitivity of some of the measurements to components of the wind. Section~\ref{sec:Calibrations} on calibration is key to the uncertainty analysis because to a large extent many of the potential errors from sensors are removed by the calibrations in this section, so the calibration becomes the central factor affecting the final uncertainty. Other intermediate sections discuss some specific tests applied to the measurements in order to check or reduce the uncertainty limits associated with these measurements. This report goes somewhat beyond a conventional analysis of uncertainty in that there are new developments discussed here and some unconventional ways of checking the measurements.  

Because several wind-measuring systems are characterized in this report, they will be discussed separately. However, the standard system is the radome-based system, so that will be treated in the most depth. The under-wing gust pod will be presented in similar detail, but these results are preliminary and subject to more investigation. For the LAMS, the discussion of uncertainty is not presented in a similar format, but there is more information regarding uncertainty in the cited references. 

% 
% 
% \subsection{Preliminary estimates of uncertainty\label{subsub:prelim}}
% 
% 
% \paragraph{Vertical wind.}
% 
% Because the calculation of wind from the contributing measurements involves coordinate transformations, evaluation of the uncertainty in wind components involves difficult error propagation through the transformation matrices and other equations of Sect.~\ref{sub:General-comments}. For application to straight-and-level flight (or flight where the intent is to remain level), simplified equations suffice for evaluation of the error terms. Evaluation of the more general case will not be considered here and will likely benefit from Monte Carlo approaches. 
% 
% For the vertical wind, Eq.~\ref{eq:Weq} provides an approximate relationship that leads to straightforward error propagation, esp.~if it is assumed that the angle of attack $\alpha$ and pitch $\theta$ are small angles so that\sindex[lis]{w\_p@$w_{p}$=upward velocity of the aircraft {[}m/s{]}} 
% 
% \begin{equation}
% w=V(\alpha-\theta)+w_{p}\label{eq:Weq-1} 
% \end{equation}
% and errors in $w$ ($\delta w$) can be related to the errors in the basic measurements ($\delta V$, $\delta\alpha$, $\delta\theta$, $\delta w_{p}$) by differentiating Eq.~\ref{eq:Weq-1}:  
% \begin{equation}
% \delta w=(\alpha-\theta)\delta V+V(\delta\alpha-\delta\theta)+\delta w_{p}\,\,\,.\label{eq:delta-w} 
% \end{equation}
% Correlations among these error terms are possible, so a full evaluation that does not assume independence among the errors leads to: 
% 
% \begin{eqnarray}
% \left\langle (\delta w)^{2}\right\rangle  & = & (\alpha-\theta)^{2}\left\langle (\delta V)^{2}\right\rangle +V^{2}\left(\left\langle (\delta\alpha)^{2}\right\rangle +\left\langle (\delta\theta)^{2}\right\rangle \right)+\left\langle (\delta w_{p})^{2}\right\rangle \nonumber \\  &  & +2\left((\alpha-\theta)\left(V(\left\langle \delta V\delta\alpha\right\rangle -\left\langle \delta V\delta\theta\right\rangle )+\left\langle \delta V\delta w_{p}\right\rangle \right)\right)\nonumber \\  &  & +2V\left(\left\langle \delta\alpha\delta w_{p}\right\rangle +\left\langle \delta\theta\delta w_{p}\right\rangle \right)-2V^{2}\left\langle \delta\alpha\delta\theta\right\rangle \label{eq:delta-w-sq} 
% \end{eqnarray}
% 
% 
% The approximate magnitudes of these terms, discussed in detail below, are: $\delta V$=0.1~m/s, $\delta\alpha=0.05^{\circ}\simeq1$~mrad, $\delta\theta\simeq1$~mrad, and $\delta w_{p}=0.03$~m/s. Other typical magnitudes are $V\simeq230$~m/s, $\alpha\simeq\theta\simeq2^{\circ}\simeq3.5$~mrad. For these typical magnitudes, the terms in \eqref{eq:delta-w-sq} that make the most significant contributions are: 
% 
% \begin{eqnarray}
% \left\langle (\delta w)^{2}\right\rangle  & = & V^{2}\left(\left\langle (\delta\alpha)^{2}\right\rangle -2\left\langle \delta\alpha\delta\theta\right\rangle +\left\langle (\delta\theta)^{2}\right\rangle \right)+\left\langle (\delta w_{p})^{2}\right\rangle\label{eq:delta-w-sq-simplified} 
% \end{eqnarray}
% 
% 
% The error in pitch arises from measurements from the IRU and is affected mostly by an initial offset during alignment and then further changes in this error arising from the Schuler oscillation and from accelerations that affect this error. The error in angle of attack, on the other hand, arises from a combination of measurement error from the pressure transducers and error in the formula used to deduce angle of attack from the pressure measurements. This error is not independent of the error in pitch, however, because the calibration as presented in Section \ref{sub:Calibration-AOA} relies on the measured difference between pitch and angle of attack being zero when the vertical wind and vertical aircraft motion are zero. Thus any bias in pitch is transferred to a bias in angle of attack, so this component of the error in \eqref{eq:delta-w-sq-simplified} should cancel. The remaining errors arise from sources that are independent and likely uncorrelated, so the term $\langle\delta\alpha\delta\theta\rangle$ in \eqref{eq:delta-w-sq-simplified} will be neglected here.
% 
% It is possible to estimate the magnitudes of these errors from measurements. Because the GV instrumentation includes two identical inertial systems, the difference in measurements of pitch from those two systems provides one lower-bound estimate of the uncertainty in pitch. Measurements discussed in Sect.~\ref{sub:Attitude-angles} suggest that, for periods when the roll of the aircraft was within 5$^{\circ}$ of zero, the difference between these redundant measurements was about 0.3~mrad. Section \ref{sub:Schuler} presents additional evidence from evaluation of the Schuler coupling between pitch or roll errors and ground-speed errors, also indicating that typical pitch errors are of about this magnitude. This is significantly smaller than the manufacturer's specified uncertainty for this instrument, $\pm0.05^{\circ}$ or about 0.9~mrad.
% 
% This uncertainty in pitch is comparable to the estimated random uncertainty in angle of attack, for which the variance spectra discussed in Sect.~\ref{sub:Variance-spectra-for-W-components} suggest a random error of about 0.35~mrad.\footnote{DEEPWAVE\index{DEEPWAVE!flight 15} flight 15, 3:40--3:55 UTC, spectrum for AKRD, compared to simulated spectrum with random-noise amplitude of 0.07. As generated, this has mean of half the amplitude, so it corresponds to a standard deviation of .07/$\sqrt{12}\simeq0.02^{\circ}\simeq0.35$~mrad.} The estimated uncertainties in angle of attack and pitch are thus comparable, and both influence the uncertainty in vertical wind. 
% 
% The other contribution to \eqref{eq:delta-w-sq-simplified}, $\langle(\delta w_p)^2\rangle$, can be estimated from error characteristics of the GPS unit providing this measurement, which suggest $\delta w_p\simeq0.03$\,m/s. 
% 
% The rough-estimate uncertainty in vertical wind (to be refined later) is then, for flight at about 230~m/s, about 0.1~m/s. Other factors, esp.~the radome calibration, need to be considered for a refined estimate, as presented in Section \ref{sub:vw-elements}, but this is the general magnitude of uncertainty expected to result from more refined analysis.\index{wind!uncertainty!preliminary estimate} In regard to absolute accuracy (vs.~fluctuations), the major uncertainty arises from the assumption, used when the sensitivity coefficients giving angle of attack in terms of the measured pressure differences on the radome, that the mean wind over the calibration flight segment is zero. This introduces an additional bias to the measurement of angle of attack and so to the vertical wind, estimated elsewhere in this report to be about 
% $pm$0.05~m/s on the basis of consistency among different calibrations.
% 
% 
% \paragraph{Horizontal wind.}
% 
% Errors in measurements affect the longitudinal and lateral components of the horizontal wind in different ways. For the longitudinal component (along the aircraft longitudinal axis), the relative-wind measurement (essentially the airspeed) has been calibrated by comparison to measurements of the single-beam LAMS, leading to an estimated standard uncertainty of less than 0.3~m/s (Cooper et al., 2014). The LAMS measurement is based on measurement of the Doppler shift and thus has low limits for bias and precision, dependent primarily on the uncertainty associated with determining the peak in the returned Doppler spectrum in the presence of turbulence. The lateral component is measured using the sideslip angle, which is determined in a manner similar to that used to calibrate the measurement of angle of attack. However, the zero reference angle for attack is determined well by assuming that, on average in quiescent air, the vertical wind should be zero. No similar reference angle exists for sideslip, and trim adjustments to the aircraft can change the mean sideslip angle, so a different procedure with additional sources of uncertainty must be used. 
% 
% Two maneuvers are particularly effective for determining the zero reference for sideslip angle (at which angle the lateral horizontal component of the relative wind would be zero): (i) Reverse-heading maneuvers,\index{maneuver!reverse heading} where a straight leg is flown for a short time (typically 2 min), then the aircraft reverses heading and flies back along the reverse heading, with the result that the wind component perpendicular to the longitudinal axis of the aircraft should reverse sign; or (ii) constant-bank circles\index{maneuver!circle} flown drifting with the wind, for which the lateral component of the wind should exhibit a sinusoidal variation around the circle reflecting a possible heading and/or sideslip error. Both maneuvers can provide a reference for correcting a combination of heading and sideslip errors, and the circle maneuver provides a mechanism for determining the sideslip error alone, as discussed in Sect.~\ref{sub:Analysis-of-circle}. There the uncertainty associated with the bias in sideslip was indicated to be about 0.06$^{\circ}$ and the random uncertainty in heading was estimated to be less than 0.09$^{\circ}$, with a bias limit comparable to that in sideslip angle. 
% 
% As for vertical wind, the GPS-measured components of aircraft motion relative to the Earth have uncertainty\index{uncertainty!ground speed} significantly less than that of the relative wind,\index{wind!relative} so errors are dominated by those arising from the relative-wind components and from the transformation to Earth coordinates.\index{coordinate system!Earth} The first-order equation for the lateral component\sindex[lis]{vy@$v_{y}$=component of the horizontal wind lateral to the aircraft axis} of the relative wind ($v_{y}$), analogous to Eq.~\ref{eq:Weq-1}, is $v_{y}=V\beta$ where $\beta$ is the sideslip angle. $V$ is known to typically 0.05\% so the error is dominated by that in sideslip angle and in heading. For the random error, one limit is obtained as for angle of attack by examining the variance spectrum in calm conditions. However, BDIFR and SSLIP\sindex[var]{SSLIP=sideslip variable selected for standard wind processing, usually SSRD}\sindex[var]{SSRD=sideslip measurement from the standard radome-based system {[}deg{]}} do not exhibit such pure noise spectra at high frequency as did ADIFR and AKRD.\sindex[var]{AKRD=angle of attack from the standard radome-based system {[}deg{]}}\sindex[var]{ATTACK=angle of attack selected for standard wind processing, usually AKRD} The QCF variance spectrum\index{variance spectrum!noise} has characteristics of noise for amplitudes of random errors of about 0.15~hPa, slightly higher than estimated for ADIFR. For BDIFR, an example is shown in Fig.~\ref{fig:bdifrSpectrum}.  
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=0.9\textwidth]{19_home_cooperw_RStudio_DEEPWAVE_WindUncertainty_BDIFRspectrum.png}  
% \par\end{centering}
% 
% \protect\caption{\label{fig:bdifrSpectrum}Variance spectrum for BDIFR for DEEPWAVE\index{DEEPWAVE!flight 15} flight 15, 3:40--3:55 UTC. The dashed orange lines indicate expected white-noise spectra for respective standard deviations of 0.1 and 0.05~hPa. Units for $fP(f)$ are hPa$^{2}$ per logarithmic interval in frequency.} 
% \end{figure}
% 
% 
% The slope in the high-frequency region does not match that expected for a white-noise signal, for which the variance would be constant and in these plots, where the spectral density is multiplied by the frequency, the plotted line should increase linearly with frequency parallel to the orange dashed lines. Instead, the spectrum for BDIFR has smaller slope than this, looking perhaps as if the spectrum starts out at a point where a white-noise spectrum with standard deviation 0.1~hPa would be appropriate, but then is filtered or otherwise smoothed\footnote{Perhaps by the response in the lines connecting the ports to the pressure sensors} so that at the high-frequency limit the equivalent white-noise standard deviation would be 0.05~hPa. The spectrum for SSLIP looks similarly filtered, with an equivalent white-noise spectrum somewhere in the range of 0.02$^{\circ}$, similar to that characterizing AKRD. However, the estimated uncertainty in the bias for the combined effects of sideslip angle and heading was, from the circle analysis, 0.02$\pm0.09^{\circ}$, and these lead to contributions to the uncertainty in bias of the lateral wind of about 0.3~m/s. The horizontal wind thus has an asymmetrical estimated uncertainty, about three times as large for the lateral component as for the longitudinal component. 
% 
% Like vertical wind, this uncertainty estimate for the horizontal wind needs to be refined for application to the Earth-relative wind by consideration of the uncertainty in the determination of sensitivity coefficients for sideslip angle and other contributions to the net uncertainty in wind. 
% 

\subsection{Elemental sources, vertical wind\label{sub:vw-elements}}

% Next, we tabulate the elemental sources of uncertainty\index{uncertainty!elemental  sources!table} in the measurement of vertical wind.\index{wind!vertical!uncertainty} 

\subsubsection{Radome-based system}

Table~\ref{tab:Elemental-w} summarizes the results for the radome-based wind system. The individual elements in that table are standard uncertainties where possible, and each is discussed in the numbered list that follows. 


\begin{table}
\protect\caption[Elemental contributions to the uncertainty in measurement of vertical wind provided by the radome-based system.]{Elemental contributions to the uncertainty in measurement of vertical
wind provided by the radome-based system. Separate estimates of systematic error (bias) and random error (which is reduced by averaging measurements) are listed, and Type-A uncertainty estimates are accompanied by an estimate of the degrees of freedom (DOF)\sindex[var]{DOF=degrees of freedom} when it is smaller than 50. The last two columns represent how the tabulated uncertainties propagate to estimates of bias and random error in the measurement of vertical wind ($w$). All entries pertain to 1-Hz measurements. Entries '--' indicate negligible
contribution to uncertainty. See Appendix A for discussion of the meaning of 'Type A' and 'Type B' evaluations of uncertainty.\label{tab:Elemental-w}}
\vskip0.1truein
\begin{minipage}[t]{1\columnwidth}%
\begin{tabular}{ccccccc}
\toprule 
\textbf{element}  &
\textbf{uncertainty source}  &
\textbf{bias}  &
\textbf{random}  &
\textbf{DOF} &
\textbf{$\delta w$ bias}  &
\textbf{$\delta w$ random }\tabularnewline
 &
 &
[type] &
[type] &
 &
{[}m/s{]}  &
{[}m/s{]} \tabularnewline
\midrule
\midrule 
1  &
ADIFR\sindex[var]{ADIFR>@ADIFR} transducer  &
0.1~hPa  &
0.1~hPa  &
$\gg$50 & 
--  &
0.05\tabularnewline
 & & [B] &[A]\tabularnewline
\midrule 
2  &
AKRD\sindex[var]{AKRD>@AKRD} coefficients  &
0.01$^{\circ}$  &
0.001$^{\circ}$  &
10 / $\gg$50\footnote{The two entries represent the degrees of freedom for the Type-A evaluations for bias and random uncertainty, respectively.}&
0.04  &
0.004\tabularnewline
 & & [A]/[B]&[A]\tabularnewline
\midrule 
3  &
BDIFR\sindex[var]{BDIFR>@BDIFR} transducer  &
0.1~hPa  &
0.1~hPa  &
$\gg$50 &
--  &
--\tabularnewline
 & & [B] &[A]\tabularnewline
\midrule 
4  &
QCF\sindex[var]{QCF>@QCF} transducer  &
0.3~hPa  &
0.1~hPa  &
$\gg$50 & 
<0.02  &
0.001\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\midrule 
5  &
pitch\footnote{for measurement periods short compared to $T_{Sch}/4$}  &
0.01$^{\circ}$  &
0.007$^{\circ}$  &
 $>50$&
0.08  &
0.03\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\midrule 
6  &
GV vertical velocity  &
0.03~m/s  &
<0.03~m/s  &
 --&
0.03  &
<0.03\tabularnewline
 & &[B]&[B]\tabularnewline
\midrule 
7  &
PSF\sindex[var]{PSF>@PSF} transducer  &
0.1\,hPa  &
0.1\,hPa  &
 $\approx$5&
--  &
--\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\midrule 
8  &
ATX\sindex[var]{ATX>@ATX}  &
0.3$^{\circ}$  &
0.1$^{\circ}$C  &
 $\gg$50&
--  &
--\tabularnewline
& &[A]&[A]&(both)\tabularnewline
\bottomrule
\end{tabular}
\end{minipage}
\end{table}

\begin{enumerate}
\item \textbf{ADIFR (pressure difference, vertical ports on radome): }\index{angle!airflow}See Sect.~\ref{sub:Airflow-angles} and Table~\ref{tab:Radome-system-measurements}.\sindex[var]{ADIFR>@ADIFR} The uncertainty from instrument specifications is 0.07\,hPa ("typical") with a maximum value of 0.14\,hPa. Evidence from the variance spectra (e.g., Fig.~\ref{fig:WIXHR1}\sindex[var]{WIC>@WIC}\sindex[var]{WIX>@WIX} and the discussion on p.~\pageref{page:ADIFRnoise}) suggests that there is random noise\index{noise!ADIFR} corresponding to a standard deviation of 0.1\,hPa in this measurement, so that is the value used here. The bias arising from errors in calibration of this sensor is listed with the same value. The resolution and stability are much smaller than this bias, so this estimate should represent a generous upper limit. However, a calibration bias in this measurement does not affect the final wind measurement because the procedure in Sect.~\ref{sub:radome-sensitivity} determines the angle of attack from flight data in a way that can be considered a calibration of the measurement of angle of attack, and a bias in ADIFR would be reflected in a change in sensitivity coefficients determined in that section that would compensate for that bias. Only random errors in ADIFR or changes in the calibration would propagate to the final measurement $w$, and such errors are thought to be negligible, so the propagated error for bias in ADIFR is listed as negligible. The next item considers the determination of sensitivity coefficient for angle of attack and is the dominant contribution to uncertainty in $w$ arising from the measurement of angle of attack.  
\item \textbf{AKRD coefficients} (coefficients for determining angle of attack from the radome measurements of pressure): \sindex[var]{AKRD=angle of attack measured using the\\radome-based system}\index{relationship!empirical!angle of attack}The calibration procedure of Sect.~\ref{sub:radome-sensitivity} effectively removes the effects of possible biases in ADIFR\sindex[var]{ADIFR>@ADIFR} and QCF\sindex[var]{QCF>@QCF} and instead replaces them with uncertainties arising from the coefficients \{$c_{0},\,c_{1}$\} in (\ref{eq:AOArecommended}).\sindex[lis]{c0@$c_{0},\thinspace c_{1}$=coefficients used to calculate angle of attack} The estimated bias and random error are those obtained and discussed in that section using the estimated uncertainties in the coefficients in (\ref{eq:AOArecommended}). For propagation to vertical wind $w$, (\ref{eq:VWind}) indicates that the result is approximately $\delta w=V\delta\alpha$ where $V$ is airspeed,\index{true airspeed|see airspeed}\index{airspeed}\index{speed of aircraft!airspeed!see airspeed} with additional contributions from correlated errors involving $V$ that are small in comparison to that listed. A typical value for V is about 240\,m\,s$^{-1}$, leading to the listed elemental uncertainties in $w$ arising from uncertainty in AKRD.\sindex[var]{AKRD>@AKRD} It is important, though, that the calibration is dependent on the assumption that the mean vertical wind where the calibration data were collected be zero. This is discussed in Sect.~\ref{sub:radome-sensitivity}. There is no independent way to check this except by comparing results from different regions as done in this report. That remains a major weakness in calibration and is the major contributor to uncertainty in angle of attack, but it introduces a bias arising from a possible calibration error. The type listed for the uncertainty estimate in the first sensitivity coefficient, or the bias, is listed as Type-A because this estimate was obtained from considering a set of different fits from different regions and finding the associated standard deviation. There is still a component of Type-B evaluation entering this estimate because it is not known if the true average vertical wind over these regions averages to zero with this uncertainty. Fluctuations from the mean value are measured with uncertainty a factor of ten smaller than this bias. The assumed mean value of the vertical wind leading to this bias was $\pm$0.03\,m/s, which could well be an over-estimate for the large datasets used in Section~\ref{sub:radome-sensitivity}.  
\item \textbf{BDIFR}\sindex[var]{BDIFR>@BDIFR} (pressure difference between horizontally separated ports on the radome):\index{relationship!empirical!sideslip}The sideslip angle has negligible effect on the vertical wind as long as the roll angle is small, so for measurements made during straight-and-level flight this contribution to uncertainty in vertical wind is negligible. The table entries duplicate those for ADIFR because the same transducer is used.
\item \textbf{QCF}\sindex[var]{QCF>@QCF} (dynamic pressure measured by the pitot tube):\index{pressure!dynamic!uncertainty}The values listed in Table~\ref{tab:Radome-system-measurements} are the characteristics of the transducer. Application of the calibration procedure based on comparison to the \index{laser air-motion sensor}laser air-motion sensor (\citet{CooperEtAl2014}) led to an alternate uncertainty estimate of 0.3\,hPa, best interpreted as a bias but evaluated there as a Type-A uncertainty. As in the case of ADIFR,\sindex[var]{ADIFR>@ADIFR} the procedure to determine sensitivity coefficients removes any effect on AKRD\sindex[var]{AKRD>@AKRD} resulting from bias in QCF\sindex[var]{QCF>@QCF} by calibration in terms of the coefficients \{$c_{0},\,c_{1}$\}, so the effect on bias in $w$ is replaced by possible bias in those coefficients, as discussed for element 2. The random error in QCF\sindex[var]{QCF>@QCF} is estimated from the noise\index{noise!QCF} limit of typical variance spectra, as for ADIFR, to be about 0.1\,Hz for 1-Hz measurements. The effect of this random error in QCF\sindex[var]{QCF>@QCF} is, from (\ref{eq:AOArecommended}), to introduce an uncertainty in angle of attack of about 0.002$^{\circ}$ or a contribution to uncertainty in $w$ of less than 0.01\,m\,s$^{-1}$. QCF\sindex[var]{QCF>@QCF} is also used to determine the airspeed, which affects $w$, but the effect is negligible for the estimated uncertainty in QCF\sindex[var]{QCF>@QCF} (<0.2\% of the measured value of $w$, or <0.02\,m\,s$^{-1}$ for 10\,m\,s$^{-1}$ vertical wind).  
\item \textbf{PITCH}\sindex[var]{PITCH>@PITCH} (pitch as measured by the Honeywell IRU):\index{pitch!uncertainty}The estimates listed for uncertainty in measured pitch are those that apply without the pitch-correction procedure of Sect.~\ref{sub:Schuler}. In that section, it was estimated that the standard error in pitch is 0.02$^{\circ}$ and that this is primarily in the form of a slowly varying error that, over measurement periods short compared to the Schuler oscillation period of 84.4~min, will appear as a bias. The correction procedure represented by Eq.~\DIFdelbegin \DIFdel{\ref{eq:pitch-error-wo-approx} }\DIFdelend \DIFaddbegin \DIFadd{\ref{eq:final-answer} }\DIFaddend corrects for this error well enough to leave the residual bias negligible, so the bias entry in Table~\ref{tab:Elemental-w} can be eliminated by application of that algorithm. The partitioning between bias and random uncertainty depends on the interval considered, because Schuler precession will cause sinusoidal variation in this error with the Schuler-oscillation period of about 84 min. For periods long compared to this the error will have the character of a random-error component, so using 0.08\,m/s would be appropriate for random uncertainty of such long-term measurements while the bias would be reduced substantially, perhaps to 0.02\,m/s. For periods small compared to the Schuler period, the pitch error appears as a varying bias and there is a much smaller random error, evaluated in Sect.~\ref{sub:Attitude-angles} to be about 0.007$^{\circ}$ in pitch or about 0.03\,m/s in vertical wind. This is the usual case for measurements of interest, so the bias and random errors are partitioned as appropriate for this case in the table. The uncertainty in pitch is the leading contributor to the standard uncertainty in vertical wind and is also the leading contributor to the overall estimate of bias. The correction technique of Sect.~\ref{sub:Schuler} is not incorporated in routine processing so needs special calculation.  
\item \textbf{GV Vertical Velocity:} \index{speed!vertical!aircraft}The measurement used for vertical motion of the aircraft is discussed in Sect.~\ref{sec:VerticalVelocity}. The values listed here are those specified for the instrument.
%for measurements when ``OmniSTAR'' corrections\index{OmniSTAR} are available; if not, the values should be increased to about 0.1\,m\,s$^{-1}$ and so will make a contributor to uncertainty in vertical wind that is comparable to the contributions from pitch and angle of attack. 
The error in aircraft vertical speed is likely a mixture of bias and random error, because the primary source is uncertainty in ionospheric corrections which will be persistent for important parts of flights but likely to change at least from flight to flight. Because of the likely persistence of the error, it is assigned here primarily to bias.  
\item \textbf{PSF}\sindex[var]{PSF>@PSF} (ambient pressure): \index{pressure!ambient!uncertainty}The uncertainty limits for bias and random error listed for the transducer used to measure ambient pressure (PSF) are the specifications for the instrument. These are verified by calibrations performed several times per year so are listed as Type-A estimates. In addition, corrections are applied for the "static defect" or difference between the pressure delivered to the transducer and the true ambient pressure. The latter has been evaluated by \citet{CooperEtAl2014}, with uncertainty limits of about this same magnitude. The measured ambient pressure affects the measurement of vertical wind only through the dependence of airspeed on static pressure, as described in the document on \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{RAF processing algorithms}, Section 4.7.1. Evaluation at typical values shows that the dependence of measured vertical wind on uncertainty in this variable is negligible. For example, the airspeed for PSF=300\,hPa,\sindex[var]{PSF=ambient or static pressure measured at the fuselage static buttons {[}hPa{]}} QCF=80\,hPa, and ATX=$-40^{\circ}$C differs from that for PSF=300.1 by 0.03\,m\,s$^{-1}$ or about 0.01\%, so this would also be the percentage change in vertical wind.  
\item \textbf{ATX}\sindex[var]{ATX>@ATX} (air temperature): The listed uncertainty for temperature (ATX) is that determined by \citet{CooperEtAl2014}, where a large set of climbs and descents were used with the hydrostatic equation to develop these Type-A estimates. Temperature is needed to calculate the airspeed, but as for ambient pressure the effect of uncertainty in temperature is very small. This was tested as for PSF by evaluating at representative points. A representative result was that the listed bias in temperature would lead to a bias in airspeed of about 0.05\%, leading to a similar percentage change in the value of the vertical wind. This is negligible in comparison to other sources of uncertainty.  
\end{enumerate}

The result of adding the elemental sources of uncertainty\index{uncertainty!vertical wind}\DIFdelbegin %DIFDELCMD < \index{wind!vertical!net uncertainty} %%%
\DIFdelend \DIFaddbegin \index{wind!vertical!uncertainty} \DIFaddend in quadrature is an estimated bias uncertainty of %0.10
0.10~m\,s$^{-1}$ and an estimated random uncertainty of %0.07
0.07~m\,s$^{-1}$. This estimate applies to measurements without pitch correction,\index{pitch!correction} and for such measurements the contribution from uncertainty in pitch is the dominant source of uncertainty. With the correction, the bias estimate decreases to 0.06\,m\,s$^{-1}$, so the pitch correction reduces the uncertainty significantly. 

An additional bias in pitch, possible arising from alignment errors during installation, is not included here, because the calibration of angle of attack is relative to the measurement of pitch, and only the difference between pitch angle and angle of attack enters calculation of the vertical wind. The result is that this calibration compensates for any fixed offset.

Possible correlations among these elemental sources of error should also be discussed in an analysis of uncertainty. In this case, correlations are not expected among the dominant sources of error. The measurements of pitch, ADIFR,\sindex[var]{ADIFR>@ADIFR} and vertical motion of the aircraft all are provided by independent instruments. The angle-of-attack coefficients will be affected by errors in pitch or the pressure difference AKRD\sindex[var]{AKRD>@AKRD} used in the calculation, but the fit that determines those coefficients largely removes any effect of errors in the components entering the fit by matching the results to measured vertical motion of the aircraft. One can imagine sources of correlation, such as acceleration or power variations affecting multiple transducers , but we have no evidence for any such effects. We have therefore added the elemental contributions in quadrature, as appropriate for uncorrelated errors. Alternatively, complete positive correlation would lead to an upper limit to net bias in vertical wind of 0.17\,m/s and an upper limit to random error of 0.12\,m/s. 

\fbox{\begin{minipage}[t]{.95\textwidth}
\textbf{Summary, radome-based vertical wind:}

The net uncertainty, combining in quadrature (because all the important random contributions have associated degrees of freedom more than 50), is 0.12\,m\,s$^{-1}$, consisting of an estimated uncertainty arising from bias of 0.10\,m\,s$^{-1}$ and an estimated uncertainty arising from random error of 0.07\,m\,s$^{-1}$. Averaging such measurements, for example to measure the mean updraft over some region, will reduce the uncertainty arising from random error but will not affect the uncertainty arising from bias. These characteristics apply to individual 1-Hz measurements and are restricted to conditions where the absolute value of the aircraft roll is less than 5$^{\circ}$, the airspeed is greater than 130\,m\,s$^{-1}$, and the altitude is above 5000~m. There are known errors that enter at altitude below this and become important near the surface, so further characterization and reconsideration of the sensitivity coefficients will be needed for such applications.
\end{minipage}}

% The APPLANIX\index{IRU!APPLANIX} IRU should provide another route to improvement in the measurement of pitch, because it offers significantly lower specified uncertainty. It achieves this through use of a full Kalman-filter\index{filter!Kalman} correction to the measurements, which would remove the need for the pitch correction\index{pitch!correction} proposed in this document. 

\subsubsection{Gust-pod system}

For the gust pod\index{gust pod}\index{system!gust pod} system, many of the uncertainties associated with measurement components are known less well than for the radome system, but some similar estimates can be made. This section will duplicate the structure of the radome-based system, but will be less definitive and more sketchy in some of the components while emphasizing the differences that apply to the gust pod. 

Table~\ref{tab:GP-Elemental-w} lists the elemental contributions to uncertainty\index{uncertainty!elemental sources!table}\index{wind!vertical!uncertainty} in the measurement of vertical wind from the gust-pod system. The following is a discussion of the individual elements in that table.\sindex[var]{AK_GP@AK\_GP=angle of attack determined using the gust pod {[}deg{]}} 

\begin{table}
\protect\caption[Elemental contributions to the uncertainty in measurement of vertical
wind using the gust pod.]{Elemental contributions to the uncertainty in measurement of vertical
wind using the gust pod. See Table~\ref{tab:Elemental-w} for explanation of entries.\label{tab:GP-Elemental-w}}
\vskip0.1truein
\begin{tabular}{ccccccc}
\toprule 
\textbf{element}  &
\textbf{uncertainty source}  &
\textbf{bias}  &
\textbf{random}  &
\textbf{DOF} &
\textbf{$\delta w$ bias}  &
\textbf{$\delta w$ random }\tabularnewline
 &
 &
 [type] &
 [type] &
 &
{[}m/s{]}  &
{[}m/s{]} \tabularnewline
\midrule
\midrule 
1  &
ADIF\_GP\sindex[var]{ADIF_GP>@ADIF\_GP} transducer  &
0.1~hPa  &
0.1~hPa  &
$\gg$50 &
--  &
0.05\tabularnewline
 & & [B] &[A]\tabularnewline
\midrule 
2  &
AK\_GP\sindex[var]{AK_GP>@AK\_GP} coefficients  &
0.01$^{\circ}$  &
0.001$^{\circ}$  &
$\gg$50 &
0.04  &
0.004\tabularnewline
 & & [A]/[B]& [A]\tabularnewline
\midrule 
3  &
BDIF\_GP\sindex[var]{BDIF_GP>@BDIF\_GP} transducer  &
0.1~hPa  &
0.1~hPa  &
 $\gg$50 &
 --  &
--\tabularnewline
\midrule 
4  &
QCF/QC\_GP\sindex[var]{QCF>@QCF}\sindex[var]{QC_GP>@QC\_GP} transducer  &
0.34~hPa  &
0.1~hPa  &
$\gg$50 &
0.02  &
0.001\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\midrule 
5  &
pitch  &
0.04$^{\circ}$  &
0.02$^{\circ}$  &
$\gg$50 &
0.17  &
0.08\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\midrule 
6  &
GV vertical velocity  &
--  &
0.07~m/s  &
-- &
--  &
0.07\tabularnewline
 & &[B]&[B]\tabularnewline
\midrule 
7  &
PS\_GP transducer  &
0.10\,hPa  &
0.1\,hPa  &
$\approx$3 &
--  &
--\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\midrule 
8  &
ATX\sindex[var]{ATX>@ATX}  &
0.3$^{\circ}$  &
0.1$^{\circ}$C  &
$\gg$50 &
--  &
--\tabularnewline
 & &[A]&[A]&(both)\tabularnewline
\bottomrule
\end{tabular}
\end{table}

\begin{enumerate}
\item \textbf{ADIF\_GP: }\sindex[var]{ADIF_GP>@ADIF\_GP}See Sect.~\ref{sub:Airflow-angles} and Table~\ref{tab:Radome-system-measurements} and the discussion related to the radome. The same transducers are used for the pressure measurements on the gust pod, although the configuration of ports is different. The next item considers the determination of sensitivity coefficient for angle of attack and is the dominant contribution to uncertainty in $w$ arising from the measurement of angle of attack.  
\item \textbf{AK\_GP coefficients:}\sindex[var]{AK_GP>@AK\_GP} The calibration procedure of Sect.~\ref{sub:gust-pod-aoa}
effectively removes the effects of possible biases in ADIFR\sindex[var]{ADIFR>@ADIFR} and QCF\sindex[var]{QCF>@QCF} and instead replaces them with uncertainties arising from the fit coefficients \{$b_0$\dots$b_3$\} in (\ref{eq:AOAGfunction}).\sindex[lis]{b0@$b_{0},\thinspace b_{1},\thinspace b_{2}\thinspace,b_{3}$=empirical coefficients relating angle of attack to pressure measurements from the gust pod {[}deg{]}} It was necessary to use additional terms to obtain a good fit in this case, but the final result provided a very good representation of the data, as good as in the radome case. We have therefore used the same uncertainty estimate as for the radome, although with less justification and study. As for the radome, the dominant source of bias is again the uncertainty in vertical wind in the calibration region, which is the same for this data set as for that used to determine the radome sensitivity coefficients, so this estimate remains the same as for the radome. The uncertainties also propagate to the vertical wind in the same way. However, the restriction to small roll angle (less than 5$^{\circ}$ from horizontal) is still more important in the case of the gust pod because the C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} IRU used with the gust pod is not aligned with the aircraft longitudinal axis but rather is mounted in an under-wing pod that was designed to point into the airflow and therefore slightly inward relative to the longitudinal axis. That causes significant problems in turns because the IRU rotates in ways that mix the attitude angles. 

\item \textbf{BDIF\_GP:}\sindex[var]{BDIF_GP>@BDIF\_GP} The sideslip\index{sideslip} angle has negligible effect on the vertical wind as long as the roll\index{roll} angle is small, so for measurements made during straight-and-level flight this contribution to uncertainty in vertical wind is negligible.  
\item \textbf{QCF and QC\_GP:}\sindex[var]{QCF>@QCF}\sindex[var]{QC_GP>@QC\_GP} \index{pressure!dynamic!uncertainty}Two measurements are listed because both are used in the calculation of vertical wind. QC\_GP is used with ADIF\_GP\sindex[var]{ADIF_GP>@ADIF\_GP} to determine the angle of attack, and the calibration described with item 2 effectively replaces uncertainty in this measurement with uncertainty in the sensitivity coefficients. However, airspeed is determined using QCF\sindex[var]{QCF>@QCF} because the conventional airspeed is thought to be superior to the new value determined solely from the gust pod (Section~\ref{sub:GP-TAS}). Therefore, the effect of uncertainty in QCF on vertical wind is the same as that for the radome because the same calculated airspeed is used for both.  
\item \textbf{pitch (CPITCH\_GP):} \sindex[var]{CPITCH_GP>@CPITCH\_GP}As was the case for the cabin-mounted inertial systems, there were two nearly identical inertial systems used in the wing pods, one for the gust pod\index{gust pod} and the other for the LAMS,\index{laser air-motion sensor} so it is again possible to compare the measurements and obtain estimates of the random errors in their measurements. For both units (LAMS and gust pod), the inertial systems use GPS measurements with a Kalman filter\index{filter!Kalman} to apply corrections, but they align independently and so have different errors and Schuler\index{Schuler oscillation|see {oscillation, Schuler}} oscillations. There were many flights in DEEPWAVE\index{DEEPWAVE!missing data} where one of these was not operational: 1--4, 6--7, 15, 17, 19. For the other flights, the standard deviation in the difference in pitch\index{pitch!inter-comparison} between these two units was 0.06$^{\circ}$, so this is a reasonable estimate of the random error that characterizes these measurements.\footnote{The standard deviation in the difference between two variables is actually $sqrt(2)\times\delta$ where $\delta$ is the standard deviation in each variable, so a better estimate is 0.04; this correction has not been made throughout this document.}As for the radome, a true bias in this measurement (e.g., from misalignment at installation) has been subsumed by the calibration of item 2 so does not enter in this item. However, the remaining error on most flights has a slowly varying component (consistent with the long time period of the Schuler oscillation) and so appears as a bias for any measurement made over a period short compared to the Schuler oscillation, so it appears appropriate to assign the observed standard deviation primarily to a bias because it will appear steady in normal applications that look at vertical wind over periods short compared to the Schuler oscillation. We have therefore partitioned the standard deviation into estimated components of 0.04$^{\circ}$ bias and $0.02^{\circ}$ random error. The uncertainty in pitch is the leading contributor to the standard uncertainty in vertical wind and is also the leading contributor to the overall estimate of bias. 

\item \textbf{Aircraft Vertical Velocity:} \index{speed of aircraft!vertical}For the gust pod, the measurement of vertical motion of the aircraft must be that from the IRU mounted in the under-wing pod because the wing can flex and vibrate and the aircraft can roll in ways that cause that vertical motion to differ from that sensed in the cabin. Again, comparing the two units mounted in side-by-side wing pods provides the best indication of the random component of uncertainty in this measurement, because both units experience almost identical vertical motion. These two units measure project-mean vertical aircraft motions that differ by 0.04\,m/s, with standard deviation in that difference of 0.07\,m/s. It seems reasonable then to estimate the random component of uncertainty as 0.07\,m/s, but the bias is more uncertain. Good flights usually produced mean vertical aircraft motion from takeoff to landing of less than 0.005\,m/s, so it is reasonable to neglect the possible bias in this measurement (which is updated for stability in the IRU using pressure altitude as a reference). 

\item \textbf{PSF:}\sindex[var]{PSF>@PSF} \index{pressure!ambient!uncertainty}The measured ambient pressure affects vertical wind only through the dependence of airspeed  on PSF, as described in the document on \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{RAF processing algorithms}, Section 4.7.1. The effect is the same as for the radome, and is negligible; see the discussion above for the radome system.  
\item \textbf{ATX:}\sindex[var]{ATX>@ATX} Temperature\index{temperature!uncertainty}\index{uncertainty!temperature} is needed to calculate airspeed, but as for ambient pressure the effect is negligible. See the radome discussion above.  
\end{enumerate}

The result of adding the elemental sources of uncertainty\index{uncertainty!wind!vertical}\DIFdelbegin %DIFDELCMD < \index{wind!vertical!net uncertainty} %%%
\DIFdelend \DIFaddbegin \index{wind!vertical!uncertainty} \DIFaddend in quadrature is an uncertainty estimate for bias of 0.18\,m\,s and a estimate of random uncertainty of 0.12\,m\,s$^{-1}$. The dominant contribution in both cases is that from measured pitch, although the uncertainty in vertical motion of the aircraft also makes a significant contribution to the random component of uncertainty. \index{gust pod!limitations}It is important that these estimates only apply to cases where the roll is within 5$^{\circ}$ of level.\footnote{At this time, no evaluation has been made of the potential for improving the measurement of pitch using the correction procedure of Sect.~\ref{sub:Schuler}. A built-in Kalman filter makes a similar correction, so it is not clear if further improvement is possible.} 

\fbox{\begin{minipage}[t]{.95\textwidth}
\textbf{Summary, gust-pod vertical wind:}

The net uncertainty, combining in quadrature (because all the important random contributions have associated degrees of freedom more than 50), is 0.21\,m\,s$^{-1}$, consisting of an estimated uncertainty arising from bias of 0.18\,m\,s$^{-1}$ and an estimated uncertainty arising from random error of 0.12\,m\,s$^{-1}$. Averaging such measurements, for example to measure the mean updraft over some region, will reduce the uncertainty arising from random error but will not affect the uncertainty arising from bias. These characteristics apply to individual 1-Hz measurements and are restricted to conditions where the absolute value of the aircraft roll is less than 5$^{\circ}$, the airspeed is greater than 130\,m\,s$^{-1}$, and the altitude is above 5000~m. There are known errors that enter for flight below this altitude and become especially important near the surface, so further characterization and reconsideration of the sensitivity coefficients will be needed for such applications.
\end{minipage}}

\subsection{Elemental sources, horizontal wind\label{sub:hw-elements}}

\subsubsection{Radome-based system}

\global\long\def\myparallel{{\mkern3mu\vphantom{\perp}\vrule depth 0pt\mkern3mu\vrule depth 0pt\mkern3mu}}
Table \ref{tab:Elemental-h} lists the elemental contributions to uncertainty\index{uncertainty!elemental sources} in the measurement of horizontal\index{wind!horizontal!uncertainty} wind\index{wind!horizontal} from the radome-based system and the items that follow discuss each element. The elemental uncertainties are listed separately for the lateral (denoted $\perp$) and longitudinal (denoted $\myparallel$) components of the horizontal wind because these depend differently on the fundamental measurements.


 
\begin{table}
\protect\caption[Elemental contributions to the uncertainty in measurement of horizontal
wind by the radome-based system.]{Elemental contributions to the uncertainty in measurement of horizontal
wind by the radome-based system. Entries '--' indicate negligible
contribution to uncertainty. Entries with subscript $\perp$ refer
to the lateral component of the horizontal wind, and those with subscript
% indicating parallel 
$\myparallel$ refer to the longitudinal component (along the
axis of the aircraft). See Table~\ref{tab:Elemental-w} for further information on the elements in this table. All entries apply to 1-Hz measurements.\label{tab:Elemental-h}}
\vskip0.1truein
\begin{tabular}{ccccccc}
\toprule 
\textbf{element}  &
\textbf{uncertainty}  &
\textbf{bias}  &
\textbf{random}  &
\textbf{DOF} &
$\delta u_{\perp,\,\myparallel}$ \textbf{bias}  &
$\delta u_{\perp,\,\myparallel}$ \textbf{random }\tabularnewline
 &
\textbf{source} &
 [type&
 [type]&
  &
{[}m/s{]}  &
{[}m/s{]} \tabularnewline
\midrule
\midrule 
1  &
BDIFR\sindex[var]{BDIFR>@BDIFR}  &
0.1~hPa  &
0.1~hPa  &
$\gg$50 &
--  &
(0.05, --)\tabularnewline
 &transducer &[B]&[A]\tabularnewline
\midrule 
2  &
SSRD\sindex[var]{SSRD=sideslip angle, radome [deg.]}  &
0.03$^{\circ}$  &
0.002$^{\circ}$  &
$\gg$50&
(0.12, --)  &
(0.01, --)\tabularnewline
&coefficients&[B]&[A]\tabularnewline
\midrule 
3  &
ADIFR\sindex[var]{ADIFR>@ADIFR} &
0.1~hPa  &
0.1~hPa  &
$\gg$50&
--  &
--\tabularnewline
&transducer&[B]&[A]\tabularnewline
\midrule 
4  &
QCF\sindex[var]{QCF>@QCF}  &
0.3~hPa  &
0.1~hPa  &
$\gg$50&
(see item 10)  &
(--, 0.15)\tabularnewline
 & transducer &[A] &[A]&(both) \tabularnewline
\midrule 
5  &
heading  &
0.09$^{\circ}$  &
0.04$^{\circ}$  &
5/$\gg$50&
(~0.38, --)  &
(0.17, --)\tabularnewline
&&[A]&[A]&\tabularnewline
\midrule 
6  &
pitch  &
0.02$^{\circ}$  &
0.007$^{\circ}$  &
$>50$&
--  &
--\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\midrule 
7  &
GV horiz.&
0.03~m/s  &
<0.03~m/s  &
--&
0.03  &
0.03\tabularnewline
&velocity&[B]&[B]&\tabularnewline
\midrule 
8  &
PSF\sindex[var]{PSF>@PSF}  &
0.1\,hPa  &
0.1\,hPa  &
$\approx$5&
--  &
--\tabularnewline
&transducer &[A]&[A]&(both)\tabularnewline
\midrule 
9  &
ATX\sindex[var]{ATX>@ATX}  &
0.3$^{\circ}$  &
0.1$^{\circ}$C  &
$>$50&
(--, 0.16)  &
(--, 0.05)\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\midrule 
10  &
$\delta q$  &
0.2\,hPa  &
0.1\,hPa  &
$\gg$50&
(--,~0.3)  &
(--,~0.15)\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\bottomrule
\end{tabular}
\end{table}

\begin{enumerate}
\item \textbf{BDIFR:} \sindex[var]{BDIFR>@BDIFR}
The primary uncertainty in BDIFR is assigned to bias because it is likely a calibration uncertainty and the resolution and stability are much smaller than this bias. However, a calibration bias in this measurement does not affect the final wind measurement because the procedure in Sect.~\ref{sub:radome-sensitivity} determines the sideslip angle from flight data in a way that can be considered a calibration of the measurement of sideslip angle, and a bias in BDIFR would be reflected in a change in sensitivity coefficients determined in that section that would compensate for that bias. Only random errors in BDIFR propagate to the final measurement of horizontal wind, and the effect of the listed random error is typically less than 0.0001 m/s in lateral wind, with even smaller contribution to the longitudinal wind. These contributions therefore are listed as negligible in the table. The next item considers the determination of sensitivity coefficient for sideslip angle and is the dominant contribution to uncertainty in horizontal wind arising from the measurement of sideslip angle.  
\item \textbf{SSRD coefficients:} \sindex[var]{SSRD>@SSRD}
The calibration procedure of Sect.~\ref{sub:radome-sensitivity} effectively removes the effects of possible biases in BDIFR\sindex[var]{BDIFR>@BDIFR} and QCF\sindex[var]{QCF>@QCF} and instead replaces them with uncertainties arising from the \sindex[lis]{e0@$e_{0},\thinspace e_{1}$=empirical coefficients used to obtain the sideslip angle}coefficients \{$e_{0},\,e_{1}$\} in (\ref{eq:betaFunctionForm}) and the ability of the selected formula to represent the calibration data. The uncertainty in the first coefficient, the main contributor to sideslip bias, is obtained from Eq.~\eqref{eq:predicted-error-in-sideslip}, as summarized in Sect.~\ref{sub:HWsummary}.  For propagation to lateral wind, (\ref{eq:horizWindeqs}) indicates that the result is approximately $\delta u_{lateral}=V\delta\beta$ where $V$ is airspeed, with additional contributions from correlated errors involving $V$ that are small in comparison to that listed. A typical value for V is about 240\,m\,s$^{-1}$, leading to the listed elemental uncertainties in horizontal wind arising from uncertainty in SSRD.\sindex[var]{SSRD>@SSRD} It is important, though, that the circle maneuvers of Sect.~\ref{sub:Analysis-of-circle} determine the combined uncertainty in the sum of heading and sideslip to about 0.09$^{\circ}$. In Table~\ref{tab:Elemental-h}, this uncertainty is assigned to heading, element 5.  
\item \textbf{ADIFR: }\sindex[var]{ADIFR>@ADIFR}
See Sect.~\ref{sub:Airflow-angles} and Table~\ref{tab:Radome-system-measurements}. The angle of attack has negligible effect on the horizontal wind as long as the roll angle is small, so for measurements made during straight-and-level flight this contribution to uncertainty in horizontal wind is negligible.  
\item \textbf{QCF:} \sindex[var]{QCF>@QCF}\index{pressure!dynamic!uncertainty}
The values listed are the characteristics of the transducer. They are supported by calibrations performed several times per year, so the appropriate degrees of freedom associated with these calibrations would be about $\approx$5. However, the additional calibration procedure based on comparison to the laser air-motion sensor (\citet{CooperEtAl2014}) led to application of a correction for the deduced static defect, so the resulting uncertainty in bias for wind is addressed in table item 10 below. The estimated random error, based on spectral characteristics, leads to expected random fluctuations in measured longitudinal wind of about 0.15\,m\,s$^{-1}$.
%an estimated standard uncertainty of 0.1~m/s for steady flight conditions and 0.3~m/s for fluctuating conditions, so this is used for the table entry pertaining to the wind component in the direction of the longitudinal axis of the aircraft. 
For the lateral component, QCF\sindex[var]{QCF} affects the calculated sideslip angle SSRD,\sindex[var]{SSRD>@SSRD} but as in the case of AKRD\sindex[var]{AKRD>@AKRD} the procedure to determine sensitivity coefficients removes any effect of bias in QCF by calibration in terms of the coefficients \{$c_{0},\,c_{1}$\} so a potential bias in QCF does not enter the lateral component of the horizontal wind but instead is replaced by possible bias in those coefficients, as discussed for element 2. The effect of a random error in QCF of 0.01~hPa for a typical value of QCF$\approx$100\,hPa is, from (\ref{eq:betaFunctionForm}), to introduce an uncertainty in sideslip angle of about 0.01\% or, because typical values of sideslip angle are smaller in magnitude than 1$^{\circ}$, an error propagated to horizontal wind smaller than 0.001~m/s. This contribution is therefore neglected.  
\item \textbf{THDG} (heading from the Honeywell IRU):\sindex[var]{THDG>@THDG}\index{heading!uncertainty}\index{uncertainty!heading}
The random error in heading can be evaluated by comparing two duplicate IRUs, as was done for pitch. The two systems on the GV for DEEPWAVE differed in mean heading by about 0.45$^{\circ}$, evidently a result of an alignment error on installation. However, the standard deviation of the difference between the two measurements was only 0.04$^{\circ}$, a value that indicates the systems may perform better than the manufacturer's specification (0.2$^{\circ}$). The uncertainty in the bias evaluated from the circle-maneuver study of Sect.~\ref{sub:Analysis-of-circle} is 0.09$^{\circ}$, based on six circles, so the degrees of freedom associated with this estimate is 5. This is used as the estimated uncertainty in heading bias, while 0.04$^{\circ}$ is considered the random component of uncertainty in heading.  
\item \textbf{PITCH:}\sindex[var]{PITCH>@PITCH}\index{pitch!uncertainty}
The contribution to uncertainty from the measurement of pitch was discussed above in connection with measurement of the vertical wind. However, in the case of horizontal wind, for level flight with negligible roll an uncertainty in pitch makes negligible contribution to uncertainty in either component of the horizontal wind.  
\item \textbf{Horizontal Velocity Components of the Aircraft:} \index{speed of aircraft!ground speed!uncertainty}
The measurement of horizontal wind is the sum of the relative wind\index{wind!relative} and the horizontal motion of the aircraft relative to the Earth, so uncertainty in this component enters directly into uncertainty in the measured wind components.  
\item \textbf{PSF:} \sindex[var]{PSF>@PSF}\index{pressure!ambient!uncertainty}
The measured ambient pressure affects horizontal wind only through the dependence of airspeed on ambient pressure, as described in the document on \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{RAF processing algorithms}, Section 4.7.1. Evaluation at typical values shows that the dependence of the measured lateral component of the horizontal wind on uncertainty in this variable is negligible. For example, TASF\sindex[var]{TASF>@TASF} for PSF=300\,hPa, QCF=80\,hPa, and ATX=$-40^{\circ}$C differs from that for PSF=300.1 by 0.03\,m\,s$^{-1}$ or about 0.01\%, so this would also be the percentage change in the lateral component of the relative wind.  
\item \textbf{ATX:} \sindex[var]{ATX>@ATX}\index{temperature!uncertainty}\index{uncertainty!temperature}
Temperature is needed to calculate airspeed. Other studies (\citet{CooperEtAl2014}) indicate that the temperature uncertainty is about 0.3$^{\circ}$C, and this error will propagate to uncertainty in both components of the horizontal wind. Typical values of Mach\index{Mach number} number for the DEEPWAVE\index{DEEPWAVE!typical Mach number} project were 0.8, for which a temperature change of $+0.3^{\circ}$C led to an increase in airspeed of about 0.16\,m/s. The temperature error is likely a bias, so this difference also should be treated as a bias. The result is that the longitudinal component of the horizontal wind has an elemental contribution from temperature of 0.16\,m/s, while the lateral component (being small and having an error proportional to the error in airspeed of about 0.16/240 or smaller than 0.1\%) has negligible error from this source.  
\item \textbf{$\delta q$=PCOR:} \index{pressure!correction}\index{PCOR|see {pressure, correction}}\sindex[var]{PCOR=correction applied to measured ambient and dynamic pressures}
The dynamic and static pressure\index{pressure!dynamic}\index{pressure!static} measurements are corrected for the static defect at the pressure ports using the formulas developed in (\citet{CooperEtAl2014}). The uncertainty in the determination of the correction was estimated in that source as less than 0.3\,m/s. Here we use similar estimates of 0.2 (bias) and 0.1\,hPa (random error). Corrections to static and dynamic pressure are correlated such that the error in static pressure is the negative of the error in dynamic pressure. For DEEPWAVE\index{DEEPWAVE} research flights these errors propagate to 0.3\,m/s bias and 0.15\,m/s random uncertainty.They have negligible effect on the lateral component of the horizontal wind.
\end{enumerate}

For the lateral\DIFdelbegin %DIFDELCMD < \index{wind!uncertainty!lateral}%%%
\DIFdelend \index{uncertainty!wind!lateral}\index{wind!lateral component} component of the wind, adding the elemental contributions to uncertainty in quadrature leads to a net bias estimate of 0.4\,m/s and a random uncertainty of 0.2\,m/s. The measurement of heading\index{heading!uncertainty} makes a dominating contribution to each. For the longitudinal\index{uncertainty!wind!longitudinal} component, the corresponding results are 0.34 and 0.2\,m/s. For the longitudinal component, the dominant contribution arises from the corrections applied to dynamic pressure to address the measured static defect as determined from calibrations. Measurements of the longitudinal wind provided by the LAMS have uncertainty of only about 0.1\,m/s, so when this instrument is available the uncertainty could be reduced; the tabulated uncertainty includes an estimate of how well the parameterized function used to correct pressure in the absence of LAMS actually represents those measurements adequately. Some of the uncertainty entering this assessment arises because the LAMS and the radome gust-sensing system measure at locations displaced from each other and so may encounter slightly different wind conditions. 

\fbox{\begin{minipage}[t]{.95\textwidth}
\textbf{Summary, radome-based horizontal wind:}

The net uncertainty in the lateral (longitudinal) component of the horizontal wind, combining in quadrature (because all the important random contributions have associated degrees of freedom more than 50), is 0.44\,m\,s$^{-1}$ (0.41\,m\,s$^{-1}$), consisting of an estimated uncertainty arising from bias of 0.4\,m\,s$^{-1}$ (0.34\,m\,s$^{-1}$) and an estimated uncertainty arising from random error of 0.2\,m\,s$^{-1}$ (for both components). Averaging such measurements, for example to measure the mean wind over some region, will reduce the uncertainty arising from random error but will not affect the uncertainty arising from bias. These characteristics apply to individual 1-Hz measurements and are restricted to conditions where the absolute value of the aircraft roll is less than 5$^{\circ}$ and the airspeed is greater than 130\,m\,s$^{-1}$. 
\end{minipage}}



\subsubsection{Gust-pod system}

\index{uncertainty!elemental sources}\index{gust pod}
\begin{table}
\protect\caption[Elemental contributions to the uncertainty in measurement of horizontal
wind from the gust pod.]{Elemental contributions to the uncertainty in measurement of horizontal
wind from the gust pod. Entries '--' indicate negligible contribution
to uncertainty. Entries with subscript $\perp$ refer to the lateral
component of the horizontal wind, and those with subscript 
%indicating parallel
$\myparallel$ refer to the longitudinal component (along the axis of the
aircraft). See Table~\ref{tab:Elemental-h} for further information on the entries in this table. All entries pertain to 1-Hz measurements.\label{tab:GP-Elemental-h}}
\vskip0.1truein
\begin{tabular}{ccccccc}
\toprule 
\textbf{element}  &
\textbf{uncertainty}  &
\textbf{bias}  &
\textbf{random}  &
\textbf{DOF} &
$\delta u_{\perp,\,\myparallel}$ \textbf{bias}  &
$\delta u_{\perp,\,\myparallel}$ \textbf{random }\tabularnewline
 &
\textbf{source} &
 [type&
 [type]&
  &
{[}m/s{]}  &
{[}m/s{]} \tabularnewline
\midrule
\midrule 
1  &
BDIF\_GP\sindex[var]{BDIF_GP>@BDIF\_GP}  &
0.1~hPa  &
0.1~hPa  &
$\gg$50 &
--  &
(0.05, --)\tabularnewline
 &transducer &[B]&[A]\tabularnewline
\midrule 
2  &
SS\_GP\sindex[var]{SS\_GP=sideslip angle, gust-pod measurement}  &
0.03$^{\circ}$  &
0.3$^{\circ}$  &
$\gg$50&
(0.12, --)  &
(1.25, --)\tabularnewline
&coefficients&[B]&[A]\tabularnewline
\midrule 
3  &
ADIFR\sindex[var]{ADIFR>@ADIFR} &
0.1~hPa  &
0.1~hPa  &
$\gg$50&
--  &
--\tabularnewline
&transducer&[B]&[A]\tabularnewline
\midrule 
4  &
QC\_GP/QCF\sindex[var]{QC_GP>@QC\_GP}\sindex[var]{QCF}  &
0.3~hPa  &
0.1~hPa  &
$\gg$50&
(see item 10)  &
(--, 0.15)\tabularnewline
 & transducers &[A] &[A]&(both) \tabularnewline
\midrule 
5  &
CTHDG\_GP\sindex[var]{CTHDG_GP>@CTHDG\_GP}  &
0.17$^{\circ}$  &
0.3$^{\circ}$  &
$\gg$50&
(0.7, --)  &
(1.2, --)\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\midrule 
6  &
PITCH\_GP  &
0.02$^{\circ}$  &
0.007$^{\circ}$  &
$>50$&
--  &
--\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\midrule 
7  &
GV horiz.&
0.05~m/s  &
<0.05~m/s  &
--&
0.05  &
0.05\tabularnewline
&velocity&[B]&[B]&\tabularnewline
\midrule 
8  &
PSF\sindex[var]{PSF>@PSF}  &
0.1\,hPa  &
0.1\,hPa  &
$\approx$5&
--  &
--\tabularnewline
&transducer &[A]&[A]&(both)\tabularnewline
\midrule 
9  &
ATX\sindex[var]{ATX>@ATX}  &
0.3$^{\circ}$  &
0.1$^{\circ}$C  &
$>$50&
(--, 0.16)  &
(--, 0.05)\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\midrule 
10  &
$\delta q$  &
0.2\,hPa  &
0.1\,hPa  &
$\gg$50&
(--,~0.3)  &
(--,~0.15)\tabularnewline
&&[A]&[A]&(both)\tabularnewline
\bottomrule
\end{tabular}
\end{table}
% \begin{table}
% \begin{tabular}{cccccc}
% \toprule 
% \textbf{element}  &
% \textbf{uncertainty source}  &
% \textbf{bias}  &
% \textbf{random}  &
% $\delta u_{\perp,\,\myparallel}$ \textbf{bias}  &
% $\delta u_{\perp,\,\myparallel}$ \textbf{random }\tabularnewline
%  &
%  &
%  &
%  &
% {[}m/s{]}  &
% {[}m/s{]} \tabularnewline
% \midrule
% \midrule 
% 1  &
% BDIF\_GP transducer  &
% 0.07~hPa  &
% 0.002~hPa  &
% --  &
% --\tabularnewline
% \midrule 
% 2  &
% SS\_GP coefficients  &
% 0.03$^{\circ}$  &
% 0.3$^{\circ}$  &
% (0.12,~--)  &
% (1.25,~--)\tabularnewline
% \midrule 
% 3  &
% ADIF\_GP transducer\sindex[var]{ADIF_GP>}  &
% 0.07~hPa  &
% 0.002~hPa  &
% --  &
% --\tabularnewline
% \midrule 
% 4  &
% QCF/QC\_GP\sindex[var]{QC_GP>@QC\_GP} transducers  &
% 0.34~hPa  &
% 0.01~hPa  &
% (see item 9)  &
% \tabularnewline
% \midrule 
% 5  &
% heading  &
% 0.17$^{\circ}$  &
% 0.3$^{\circ}$  &
% (~0.7, --)  &
% (1.2,~--)\tabularnewline
% \midrule 
% 6  &
% pitch  &
% 0.02$^{\circ}$  &
% 0.02$^{\circ}$  &
% --  &
% --\tabularnewline
% \midrule 
% 7  &
% horiz. velocity of GV  &
% 0.05~m/s  &
% 0.05~m/s  &
% 0.05  &
% 0.05\tabularnewline
% \midrule 
% 8  &
% PSF transducer  &
% 0.10\,hPa  &
% 0.001\,hPa  &
% --  &
% --\tabularnewline
% \midrule 
% 9  &
% ATX\sindex[var]{ATX>@ATX}  &
% 0.3$^{\circ}$  &
% 0.1$^{\circ}$C  &
% (--,~0.16)  &
% (--,~0.05)\tabularnewline
% \midrule 
% 10  &
% $\delta q$  &
% 0.2\,hPa  &
% 0.1\,hPa  &
% (--,~0.3)  &
% (--,~0.15)\tabularnewline
% \bottomrule
% \end{tabular}
% 
% \protect\caption{Elemental contributions to the uncertainty in measurement of horizontal
% wind from the gust pod.. Entries '--' indicate negligible contribution
% to uncertainty. Entries with subscript $\perp$ refer to the lateral
% component of the horizontal wind, and those with subscript indicating
% parallel refer to the longitudinal component (along the axis of the
% aircraft). \label{tab:GP-Elemental-h}}
% \end{table}


\begin{enumerate}
\item \textbf{BDIF\_GP:} \sindex[var]{BDIF_GP>@BDIF\_GP}
The primary uncertainty in BDIF\_GP is assigned to bias because it is likely a calibration uncertainty and the resolution and stability are much smaller than this bias. However, a calibration bias in this measurement does not affect the final wind measurement because the procedure in Sect.~\ref{sub:radome-and-gust-pod-beta} determines the sideslip angle from flight data in a way that can be considered a calibration of the measurement of sideslip angle, and a bias in BDIF\_GP would be reflected in a change in sensitivity coefficients determined in that section that would compensate for that bias. Only random errors in BDIF\_GP propagate to the final measurement of horizontal wind, and the effect of the listed random error is typically less than 0.0001 m/s in lateral wind, with even smaller contribution to the longitudinal wind. These contributions therefore are listed as negligible in the table. The next item considers the more uncertain determination of sensitivity coefficient for sideslip angle.  
\item \textbf{SS\_GP coefficients:}\sindex[var]{SS_GP>@SS\_GP} \index{relationship!empirical!gust pod}\index{sideslip!gust pod}
The calibration procedure of Sect.~\ref{sub:radome-and-gust-pod-beta} effectively removes the effects of possible biases in BDIF\_GP\sindex[var]{BDIF_GP>@BDIF\_GP} and QC\_GP\sindex[var]{QC_GP>@QC\_GP} and instead replaces them with uncertainties arising from the coefficients \{$e_{0},\,e_{1}$\} in (\ref{eq:betaFunctionForm}) and the ability of the selected formula to represent the calibration data. For sideslip angle, the fit procedure used values of heading and ground speed\index{speed of aircraft!ground speed} components determined from the gust-pod IRU, but wind components determined from the radome system. This allowed better determination of sensitivity coefficients than would have been possible from \textquotedbl{}bootstrapping\textquotedbl{} gust-pod measurements using repeated iterations, because the wind measurements from the radome system have lower uncertainty than those from the gust-pod system. However, this means for example that the offset in sideslip angle or heading will be dependent on the values from the radome system. Adjustment using the circle maneuvers of Sect.~\ref{WS-var-circles} is not possible for the gust pod because the wind measurements are compromised at the high bank angles required for the circle maneuver, so other adjustment is necessary. Values of SS\_GP\sindex[var]{SS_GP>@SS\_GP} are at least as uncertain as those from SSRD because the SS\_GP calibration uses wind measurements determined from SSRD\sindex[var]{SSRD>@SSRD}, so the values in Table~\ref{tab:Elemental-h}, 0.03 and 0.002$^{\circ}$, are lower limits for the uncertainty in calibration coefficients from the gust pod. However, the standard deviation between sideslip angle measured by the radome (SSRD) and that measured by the gust pod (SS\_GP) is typically about 0.3$^{\circ}$, an indication that the uncertainty in SS\_GP\sindex[var]{SS_GP>@SS\_GP} may be much larger.\footnote{For comparison, the standard deviation in the difference between AKRD\sindex[var]{AKRD>@AKRD} and AK\_GP\sindex[var]{AK_GP>@AK\_GP} is only 0.09$^{\circ}$.} This large standard deviation might arise partly from different turbulent components being measured at the radome and at the gust pod, but this seems unreasonably high for that explanation because the standard deviation corresponds to a standard deviation in the difference in lateral wind at the two locations of 1.25\,m/s. Instead, it appears that there is some source of error affecting SS\_GP\sindex[var]{SS_GP>@SS\_GP} and that the elemental uncertainty assigned to the random error arising from application of the SS\_GP calibration must be increased to 0.3$^{\circ}$ until this discrepancy between SSRD\sindex[var]{SSRD>@SSRD} and SS\_GP can be resolved.  
\item \textbf{ADIF\_GP: }\sindex[var]{ADIF_GP>@ADIF\_GP}
See Sect.~\ref{sub:Airflow-angles} and Table~\ref{tab:Radome-system-measurements}. The angle of attack has negligible effect on the horizontal wind as long as the roll angle is small, so for measurements made during straight-and-level flight this contribution to uncertainty in horizontal wind is negligible.  
\item \textbf{QCF and QC\_GP:}\sindex[var]{QCF>@QCF}\sindex[var]{QC_GP>@QC\_GP} \index{pressure!dynamic!uncertainty}
The values listed are the characteristics of the transducers. Application of the calibration procedure based on comparison to the laser air-motion sensor (\citet{CooperEtAl2014}) led to an estimated standard uncertainty of 0.1~m/s for steady flight conditions and 0.3~m/s for fluctuating conditions, so this is used for the table entry pertaining to the wind component in the direction of the longitudinal axis of the aircraft. For the lateral component, QC\_GP\sindex[var]{QC_GP>@QC\_GP} affects the calculated sideslip angle SS\_GP,\sindex[var]{SS_GP>@SS\_GP} but the procedure to determine sensitivity coefficients removes any effect of bias in QC\_GP by calibration in terms of the coefficients \{$c_{0},\,c_{1}$\} so a potential bias in QC\_GP does not enter the lateral component of the horizontal wind but instead is replaced by possible bias in those coefficients, as discussed for element 2. The effect of a random error in QCF\sindex[var]{QCF>@QCF} of 0.01~hPa for a typical value of QCF$\approx$100\,hPa is, from (\ref{eq:betaFunctionForm}), to introduce an uncertainty in sideslip angle\index{sideslip!uncertainty} of about 0.01\% or, because typical values of sideslip angle are smaller in magnitude than 1$^{\circ}$, an error propagated to horizontal wind smaller than 0.001~m/s. This contribution is therefore neglected.  
\item \textbf{CTHDG\_GP} (heading from the C-MIGITS IRU):\sindex[var]{C-MIGITS>@C-MIGITS} \sindex[var]{CTHDG_GP>@CTHDG\_GP}\index{heading!uncertainty}
The random error in heading can be evaluated by comparing the two similar IRUs for the gust pod and the LAMS, as was done for pitch. In DEEPWAVE\index{DEEPWAVE}, these two systems differed in mean heading by about 1.3$^{\circ}$, evidently a result of being installed at different angles relative to the aircraft longitudinal axis. The standard deviation in the difference in heading measurements from the two systems, after excluding some additional flights (18, 22, 25) where there appeared to be problems with the measurement, was 0.3$^{\circ}$, so the uncertainty associated with this measurement is much higher than that for the radome-based system. The mean difference between the two measurements of heading, averaged over flights, had a standard deviation of 0.17$^{\circ}$, so this may be a reasonable estimate of bias, as entered into the table.\footnote{Special processing, using a hybrid heading obtained by complementary filtering (cf.~Sect.~\ref{sub:comp-filter}) with CTHDG\_GP\sindex[var]{CTDHG_GP>@CTHDG\_GP} considered the \textquotedbl{}fast\textquotedbl{} signal and THDG\sindex[var]{THDG>@THDG} the \textquotedbl{}slow\textquotedbl{} signal, with appropriate adjustment for the discontinuity at 360$^{\circ}$ and with exclusion of data during and for 1 min after turns, reduced the standard deviation of the difference in heading to less than 0.10$^{\circ}$ with a similar reduction in estimated bias. The resulting heading variable retains the high-frequency response of the gust-pod IRU, needed to address issues like wing flex or vibration of the pod, but used the higher-quality measurement of heading from the fuselage IRU for long-term updating. This can improve the measurement of horizontal wind from the gust pod significantly, at the expense of having the measurements use a reference measurement outside the instrument. If improvement in the measurement of horizontal wind from the gust pod becomes important, such processing can be used for special cases.}  
\item \textbf{PITCH:}\sindex[var]{PITCH>@PITCH} \index{pitch!uncertainty!gust pod}
The contribution to uncertainty from the measurement of pitch was discussed above in connection with measurement of the vertical wind. However, in the case of horizontal wind, for level flight with negligible roll an uncertainty in pitch makes negligible contribution to uncertainty in either component of the horizontal wind.  
\item \textbf{Horizontal Velocity Components of the Aircraft:}
The measurement of horizontal wind is the sum of the relative wind and the horizontal motion of the aircraft relative to the Earth, so uncertainty in this component enters directly into uncertainty in the measured wind components. Comparison among the different measurements of velocity components of the aircraft (\{GGVEW,\sindex[var]{GGVEW>@GGVEW} CVEW\_GP,\sindex[var]{CVEW_GP>@CVEW\_GP} CVEW\_LAMS\sindex[var]{CVEW_LAMS>@CVEW\_LAMS}\} and \{GGVNS,\sindex[var]{GGVNS>@GGVNS} CVNS\_GP,\sindex[var]{CVNS_GP>@CVNS\_GP} CVNS\_LAMS\}) indicate that, for DEEPWAVE\index{DEEPWAVE!flights with good C-MIGITS operation} flights with good IRU\index{inertial reference unit} operation (flights 5, 8--14, 16, 20--21, 23--24, 26) the standard deviations among these measurements are consistent with an uncertainty of 0.05\,m/s. This characterizes some combination of bias and random error, so to be conservative this value has been assigned to each in the table.  
\item \textbf{PSF:}\sindex[var]{PSF>@PSF} \index{pressure!ambient!uncertainty}
This measurement has the same effect on the wind measurement from the gust pod that it has on the measurement from the radome-based system because the same airspeed measurement is used for both. See the discussion for the radome system that follows Table~\ref{tab:Elemental-h}.  
\item \textbf{ATX:}\sindex[var]{ATX>@ATX}
Temperature affects wind measured by the gust pod in the same way as that measured by the radome-based system. See the discussion for the radome system that follows Table~\ref{tab:Elemental-h}.  
\item \textbf{$\delta q=$PCOR:} \index{pressure!correction}
When the airspeed from
the standard radome-based system is used for calculating the relative
wind using the angle measurements from the gust-pod, the same correction
to airspeed is applied in this case as when calculating wind
from the standard radome-based system. See the discussion for the
radome system that follows Table~\ref{tab:Elemental-h}. If instead
TAS\_GP as parameterized by \eqref{eq:TASfit} and \eqref{eq:TASformula} in Sect.~\ref{sub:GP-TAS} is used, no correction is applied because the
fit was determined by fitting to TASF\sindex[var]{TASF=measurement of airspeed from the fuselage-mounted pitot tube} values that were already corrected
using the pressure-correction equations.
\end{enumerate}

For the gust-pod system\index{system!gust pod}\index{gust pod!uncertainty}\index{wind!horizontal!uncertainty}, the uncertainties in the two components of the horizontal wind (lateral\index{wind!horizontal!lateral}  and longitudinal\index{wind!horizontal!longitudinal} relative to the aircraft) are quite different. For the lateral component of the wind, adding the elemental contributions to uncertainty in quadrature leads to a net uncertainty in bias of 0.7\,m/s and a random uncertainty of 1.7\,m/s. The measurement of heading makes a large contribution to each, and the values used for these estimates are the result of inter-comparisons between units and are much higher than the best specifications for the unit listed in Table \ref{tab:Gust-pod-measurements}, but as noted there the error can increase fairly significantly if not updated with frequent course changes. There is also a large contribution to random uncertainty in the lateral wind from uncertainty in the sideslip, based on comparisons to the radome system. For the longitudinal component, the corresponding results are 0.3 and 0.2\,m/s. Here the dominant contribution arises from the corrections applied to dynamic pressure to address the measured static defect as determined from calibrations, just as for the radome-based system, because the measurements of the longitudinal component of the wind are the same for both systems. 

\fbox{\begin{minipage}[t]{.95\textwidth}
\textbf{Summary, gust-pod horizontal wind:}

The net uncertainty in the lateral (longitudinal) component of the horizontal wind, combining in quadrature (because all the important random contributions have associated degrees of freedom more than 50), is 1.9\,m\,s$^{-1}$ (0.4\,m\,s$^{-1}$), consisting of an estimated uncertainty arising from bias of 0.7\,m\,s$^{-1}$ (0.34\,m\,s$^{-1}$) and an estimated uncertainty arising from random error of 1.7\,m\,s$^{-1}$ (0.4\,m\,s$^{-1}$). Averaging such measurements, for example to measure the mean wind over some region, will reduce the uncertainty arising from random error but will not affect the uncertainty arising from bias. These characteristics apply to individual 1-Hz measurements and are restricted to conditions where the absolute value of the aircraft roll is less than 5$^{\circ}$ and the airspeed is greater than 130\,m\,s$^{-1}$. 
\end{minipage}}

\subsection{Uncertainties associated with the LAMS\label{sub:LAMS-uncertainty}}

Because the LAMS is still under development, a different format will be used here to record some preliminary information on contributions to its uncertainty.  
The following uncertainty analysis treats unknown biases in pointing as random variables with standard deviations or variances. These figures represent uncertainty, not stochastic processes. The resultant variances provide bounds on the uncertainty in the wind vector measured by the LAMS, but they are based strictly on the instrument characterization, independent of other factors such as signal fidelity. 

The uncertainty limit to which the LAMS relative beam pointing angles are known directly impacts estimates of uncertainty in airspeed and wind. A sequence of line-of-sight velocity measurements is given by the equation:  
\begin{equation}
\vec{m}=\mathbf{U}\vec{v}_{L},\label{Vmeas}
\end{equation}
where $\vec{m}$ is the set of measurements (3 or 4 elements corresponding to the number of beams in use), $\vec{v}_{L}$ is the air velocity vector in the LAMS beam coordinate basis and $\mathbf{U}$ is the matrix describing each beam's pointing angle given by  
\begin{equation}
\mathbf{U}=\left[\begin{array}{cccc} \hat{u}_{1} & \hat{u}_{2} & \hat{u}_{3} & \hat{u}_{4}\end{array}\right]^{T},\label{Umatrix}
\end{equation}
where $\hat{u}_{i}$ is the $ith$ beam pointing direction. The exact vector entries for $\mathbf{U}$ are dependent on which beams are used for LAMS operation. For example, $\hat{u}_{4}$ would not be included for HCR-TEST (post-DEEPWAVE configuration) where the down-inboard beam was not used in that three beam configuration. For this analysis the beam and air velocity vectors are defined in the LAMS relative coordinate frame. Though this is not inherently required, it allows the analysis presented in this section to flow directly into further uncertainty analysis described in Section \ref{sub:Absolute}. 

The covariance matrix of a beam pointing vector is given by  
\begin{equation}
\Sigma_{\hat{u}_{i}}^{2}=\left(\frac{\partial\hat{u}_{i}}{\partial\phi}\right)\sigma_{\phi}^{2}\left(\frac{\partial\hat{u}_{i}}{\partial\phi}\right)^{T}+\left(\frac{\partial\hat{u}_{i}}{\partial\theta}\right)\sigma_{\theta}^{2}\left(\frac{\partial\hat{u}_{i}}{\partial\theta}\right)^{T},\label{CovUvec} 
\end{equation}
where $\sigma_{\phi}$ and $\sigma_{\theta}$ are the standard deviation of the beam pointing angles. The uncertainty in these angles may be different for each beam, but this analysis will treat them as identical. 

The variance in a measurement due to beam pointing uncertainty is given by  
\begin{equation}
\sigma_{m_{ii}}^{2}=\vec{v}_{L}^{T}\Sigma_{\hat{u}_{i}}^{2}\vec{v}_{L}.\label{measUncert} 
\end{equation}
The uncertainty in the relative pointing angles are assumed to be independent for each beam (common uncertainty in the instrument pointing will be addressed in section \ref{sub:Absolute}). Thus the total measurement covariance matrix is diagonal and given by  
\begin{equation}
\Sigma_{\vec{m}}^2=\left[\begin{array}{cccc} \sigma_{m_{11}}^2 & 0 & 0 & 0 \\                                                  0 & \sigma_{m_{22}}^2 & 0 & 0 \\                                                 0 & 0 & \sigma_{m_{33}}^2 & 0 \\                                                 0 & 0 & 0 & \sigma_{m_{44}^2} \end{array} \right].\label{measCov} 
\end{equation}

The total velocity uncertainty in the LAMS coordinate frame is ultimately bounded by its covariance matrix  
\begin{equation}
\Sigma_{\vec{v}_{L}}^{2}=\mathbf{U}_{inv}\left(\Sigma_{\vec{m}}^{2}+\Sigma_{f}^{2}+\mathbf{U}\Sigma_{\vec{v}}^{2}\mathbf{U}^{T}\right)\mathbf{U}_{inv},\label{VlamsError} 
\end{equation}
where the velocity uncertainty resulting from beam pointing uncertainty is given by the covariance matrix $\Sigma_{\vec{m}}^{2}$ from Eq.  \eqref{measCov}, the uncertainty arising from Fast Fourier Transform (FFT) Doppler peak estimation is described by the covariance matrix $\Sigma_{f}^{2}$ and is defined in section \ref{sub:FreqPrec}, the covariance matrix $\Sigma_{\vec{v}}^{2}$ is the result of velocity variability between the three or four beam sample volumes with $\mathbf{U}$ being the beam projection matrix from Eq. \eqref{Umatrix} and $\mathbf{U}_{inv}$ is the inversion matrix for finding the total velocity vector from the three or four line-of-sight measurements. In the case of the three beam LAMS, $\mathbf{U}_{inv}=\mathbf{U}^{-1}$.  However, because the four beam system is overdefined, a pseudo-inverse may be used, or if the uncertainty in measurements are well known, 
\begin{equation}
\mathbf{U}_{inv}=\left[\mathbf{U}^{T}\left(\Sigma_{L}^{2}\right)^{-1}\mathbf{U}\right]^{-1}\mathbf{U}^{T}\left(\Sigma_{L}^{2}\right)^{-1},\label{OptInv}
\end{equation}
where  
\begin{equation}
\Sigma_{L}^{2}=\Sigma_{\vec{m}}^{2}+\Sigma_{f}^{2}+\mathbf{U}\Sigma_{\vec{v}}^{2}\mathbf{U}^{T}.\label{TotalMeasUncert} 
\end{equation}

Assuming the angle uncertainty of all four beams is approximately $0.02^{\circ}$ and an aircraft velocity of 200 m/s along the LAMS pointing direction, the total velocity uncertainty resulting from beam pointing uncertainty is approximately 0.06 m/s in the horizontal and vertical directions with the four beam configuration, 0.09 m/s in the horizontal and vertical directions with the three beam configuration used in HCR-TEST. To first order approximation, the forward velocity is insensitive to small perturbations in beam pointing. 


It is a significant weakness of the SDN500 IRU, and therefore of the ability of the LAMS to function as an independent system, that the IRU cannot provide reliable heading information without moving. Heading adjustments had to be added to the fit of the two measurements in this preliminary study.

\subsubsection{SDN500 IRU Absolute Beam Pointing\label{sub:Absolute}}

With the relative pointing angles of the beams, an air velocity vector can be retrieved reliably in the predefined LAMS coordinate frame. However, the exact transformation between the LAMS beams and the SDN500 IRU coordinate frame (defined by the unit's principal axes) is unknown. We typically assume that one SDN500 IRU axis is exactly aligned to the forward pointing beam and one is directed along the angle beam 1. However, it stands to reason that there will be some slight differences between the LAMS beam coordinate frame and the principal axes of the SDN500 IRU. At present, the only method we have for determining this transformation relies on making small angle adjustments based on flight maneuvers. 

Let the transformation matrix between the LAMS relative coordinate frame and the SDN500 IRU principal axes be $\mathbf{T_{L}}$. The velocity from LAMS is converted to the SDN500 IRU coordinate frame using  
\begin{equation}
\vec{v}_{c}=\mathbf{T_{L}}\vec{v}_{L},\label{velL2C}
\end{equation}
where $\vec{v}_{c}$ is the air velocity vector in the SDN500 IRU coordinate frame and $\vec{v}_{L}$ the air velocity vector in the LAMS relative beam coordinate frame. To propagate error in the transformation matrix we reframe the problem by vectorizing the matrix such that Eq. \eqref{velL2C} becomes  
\begin{equation}
\vec{v}_{c}=\mathbf{V_{L}}\vec{t}_{L},\label{velL2Cvect}
\end{equation}
where the matrix $\mathbf{T_{L}}$ has been converted to the vector $\vec{t}_{L}$ given by  
\begin{equation}
\vec{t}_{L}=\left[\begin{array}{cccc} T_{11} & T_{12} & \cdots & T_{33}\end{array}\right]^{T},\label{T2vec}
\end{equation}
where $T_{ij}$ is the element of $\mathbf{T_{L}}$ from the $ith$ row and $jth$ column. The matrix $\mathbf{V_{L}}$ is constructed from the LAMS coordinate frame velocity vector $\vec{v}_{L}$ and is given by  
\begin{equation}
\mathbf{V_{L}}=\left[\begin{array}{ccccccccc}
v_{1} & v_{2} & v_{3} & 0 & 0 & 0 & 0 & 0 & 0\\ 0 & 0 & 0 & v_{1} & v_{2} & v_{3} & 0 & 0 & 0\\ 0 & 0 & 0 & 0 & 0 & 0 & v_{1} & v_{2} & v_{3} 
\end{array}\right],\label{v2mat}
\end{equation}
where $v_{i}$ is the $ith$ element of $\vec{v}_{L}$. 

The covariance matrix of $\vec{t}_{L}$ can be estimated from the uncertainties in the roll, pitch and yaw transformation angles denoted here as $\gamma$, $\beta$ and $\alpha$ respectively using partial derivatives  
\begin{equation}
\Sigma_{\vec{t}_{L}}^{2}=\left(\frac{\partial\vec{t}_{L}}{\partial\gamma}\right)\sigma_{\gamma}^{2}\left(\frac{\partial\vec{t}_{L}}{\partial\gamma}\right)^{T}+\left(\frac{\partial\vec{t}_{L}}{\partial\beta}\right)\sigma_{\beta}^{2}\left(\frac{\partial\vec{t}_{L}}{\partial\beta}\right)^{T}+\left(\frac{\partial\vec{t}_{L}}{\partial\alpha}\right)\sigma_{\alpha}^{2}\left(\frac{\partial\vec{t}_{L}}{\partial\alpha}\right)^{T}.\label{tCov} 
\end{equation}

Thus the velocity covariance matrix in the SDN500 IRU coordinate frame is given by  
\begin{equation}
\Sigma_{\vec{v}_{c}}^{2}=\mathbf{V_{L}}\Sigma_{\vec{t}_{L}}^{2}\mathbf{V_{L}}^{T}+\mathbf{T_{L}}\Sigma_{\vec{v}_{L}}^{2}\mathbf{T_{L}}^{T},\label{CMvelError} 
\end{equation}
where $\Sigma_{\vec{v}_{L}}$ is obtained from Eq. \eqref{VlamsError}. 

It should be noted that a similar analysis can be performed for the transformation between SDN500 IRU and a Global or aircraft coordinate frame where uncertainties in SDN500 IRU roll, pitch and heading are better known. 

%ADD DETAILS ON DETERMINING THIS TRANSFORMATION MATRIX FROM FLIGHT DATA. 

With the SDN500 IRU INS, the air velocity measurements can be transformed into a global coordinate frame. The transformation matrix is determined using $\mathbf{T_{1}}$, $\mathbf{T_{2}}$ and $\mathbf{T_{3}}$ from the roll, pitch and yaw reported by SDN500 IRU. The analysis needed for this step is covered in Section \ref{sub:EarthRef}. 



\subsubsection{Frequency Precision\label{sub:FreqPrec}}

The LAMS A/D samples each beam detection channel at 200 MHz and performs a 1024 point FFT. The frequency resolution of the FFT is thus given by the sample rate divided by the number of data points  
\begin{equation}
\Delta f=\dfrac{f_{s}}{N_{s}}=195\mathrm{kHz}. 
\end{equation}
The Doppler shift measured on a particular beam is  
\begin{equation}
f_{D}=\frac{2}{\lambda}\hat{u}\cdot\vec{v},\label{DopplerShift} 
\end{equation}
where $\lambda$\sindex[lis]{lambda@$\lambda$=laser wavelength, LAMS} is the laser wavelength (1560 nm), $\hat{u}$ is the beam direction and $\vec{v}$ is the velocity vector of the air relative to the instrument. A factor of two is included because the Doppler shift is imposed twice, first when the beam is absorbed by the aerosol and second when it is re-emitted. Along the beam line-of-sight, each FFT bin corresponds to a velocity resolution of $\Delta v_{LOS}=0.15\mathrm{m/s}$. 
%With post processing the backscatter Doppler peak can be determined at sub-bin resolution.  %This is accomplished using linear interpolation on the derivative of the backscatter peak to find the derivative zero crossing. 
However, the peak in the detected Doppler spectrum can be determined with resolution of about 0.3~bin by using a fit to the derivative of the spectrum. 
%For the purposes of this analysis, we assume a sub-sample resolution of about 0.3, 
%giving 
This gives a line-of-sight velocity resolution of about $\Delta v_{LOS}=0.05\mathrm{m/s}$. 

The resulting covariance matrix for each line-of-sight velocity measurement (only accounting for frequency accuracy) is diagonal with identically distributed variances  
\begin{equation}
\Sigma_{f}^{2}=\left[\begin{array}{cccc} 
\sigma_{v_{LOS}}^{2} & 0 & 0 & 0\\ 0 & \sigma_{v_{LOS}}^{2} & 0 & 0\\ 0 & 0 & \sigma_{v_{LOS}}^{2} & 0\\ 0 & 0 & 0 & \sigma_{v_{LOS}}^{2} \end{array}\right],\label{CovFreq} 
\end{equation}
where, for our purposes, we assume $\sigma_{v_{LOS}}=\Delta v_{LOS}$. 

The analysis presented here assumes variance in the sample rate to be small compared to other error sources. 

At GV speeds, the Doppler shift will exceed the Nyquist frequency at the present sample rate. Therefore, the conventional measurement of airspeed is used
to determine which frequency fold contains the Doppler peak. The line-of-sight airspeed
at which the LAMS data system folds is

\begin{equation}
V{fold} = \frac{F_s~\lambda_L}{4}; % speed in m/s where data system changes or folds
\end{equation}
where the sample frequency ($F_s$) is 200 MHz and the laser wavelength ($\lambda$) is 1560.0 nm.  
Therefore the LAMS line-of-sight measurements will fold at airspeeds of 78,
156, and 234\,m/s. For beams at 35$^{\circ}$ from the longitudinal axis, these 
folds correspond to approximate longitudinal airspeeds of 95.2, 190.4, and 
285.7 m/s.
The ambiguity that occurs near fold points makes it more difficult to 
determine the LAMS line-of-sight speeds,
so the uncertainty increases within a few m/s of the fold points.

\subsubsection{Flow Distortion}

Initial operation of the three beam \index{LAMS!airflow distortion} LAMS on IDEAS-4-GV revealed that the aircraft can influence flow fields in the LAMS sample volume. This issue became recognizable when data processing showed the down-inboard beam registered significantly slower velocities than the other two beams. An analysis using Gulfstream's computational fluid dynamics analysis confirmed that all three beams could be expected to observe some flow distortion. The expected flow distortion depends on the aircraft flight parameters. The down-inboard beam is expected to experience the largest effect, typically observing a line-of-sight flow effect between -0.5 and -2.0 m/s when the beam is focused at 20 m. The upward beam may see flow effects on the order of $\pm0.5$ m/s and the down-outboard may see flow effects between 0 and -0.5 m/s. 

On the GV, LAMS no longer uses the down-inboard beam due to the substantial flow effects in its sample volume. The flow effects around the C-130 will be better determined after the ARISTO flight campaign in Fall 2015. 

\subsubsection{Uncertainty arising from separation of measurement volumes}


In turbulent conditions \index{LAMS!separation of measurement volumes} the three sensitive volumes can be characterized by slightly different values of the wind vector\sindex[lis]{v@$\mathbf{v}$=wind vector} $\mathbf{v}=\{u,v,w\}.$ \sindex[lis]{u@$u$=component of wind along the x-axis}\sindex[lis]{v@$v$=component of wind along the y-axis}\sindex[lis]{w@$w$=component of wind along the z-axis; also, vertical wind}The single forward beam measures $u$ directly while the 3-beam system must solve for $u$ using the relative wind measurements at three locations displaced from each other. If there are variations in the wind vector at these three locations, that will introduce an error that can be significantly larger than the measurement errors for a single-beam-forward system. 

If for simplicity it is assumed that the 3-beam system is aligned so that the longitudinal axis matches the $u$ axis and the vertical axis matches the $w$ axis, then the unique solution (for a 35$^{\circ}$ diverging-beam angle) for the airspeed ($u$) is 

\begin{equation}
u=\frac{(a_{1}+a_{2}+a_{3})}{3\cos(35^{\circ})}\label{eq:TAS3beam} 
\end{equation}


where $a_{i}$ is the relative airspeed measured by the ith beam. % 
%\footnote{The direction cosines for the three beams are given by the following matrix $\sigma$:
% 
% \[
% \sigma=\left(\begin{array}{ccc}
% \cos\Theta & \sin\Theta\sin\Phi & \sin\Theta\cos\Phi\\
% \cos\Theta & -\sin\Theta\sin\Phi & \sin\Theta\cos\Phi\\
% \cos\Theta & 0 & \sin\Theta
% \end{array}\right)
% \]
% where $\Theta=35^{\circ}$ and $\Phi=120^{\circ}$. The direction
% cosine matrix relates the wind components to the 3-beam measured components
% ($a_{i}$\} via 
% 
% \[
% \begin{pmatrix}a_{1}\\
% a_{2}\\
% a_{3}
% \end{pmatrix}=\mbox{\textbf{\ensuremath{\sigma}}}\begin{pmatrix}u\\
% v\\
% w
% \end{pmatrix}
% \]
% 
% 
% Inverting $\sigma$ then gives the wind components in terms of the
% measured components:
% 
% \[
% \begin{pmatrix}u\\
% v\\
% w
% \end{pmatrix}=\sigma^{-1}\begin{pmatrix}a_{1}\\
% a_{2}\\
% a_{3}
% \end{pmatrix}
% \]
% 
% 
% For the above angles, application of the inverse below to the component
% $u$ leads to (\ref{eq:TAS3beam}): 
% 
% \[
% \sigma^{-1}=\begin{pmatrix}0.4069249 & 0.4069249 & 0.4069249\\
% 1.006579 & -1.006579 & 0\\
% -0.5811489 & -0.5811489 & 0.9166754
% \end{pmatrix}
% \]
% }
If each beam measures relative airspeed in its direction of alignment to an uncertainty $\delta$,\sindex[lis]{delta@$\delta$=measurement uncertainty} then a one-beam system aligned along the airflow measures with uncertainty $\delta$ while a three-beam system measures to uncertainty $\sqrt{3}\delta/(3\cos(35^{\circ})=0.7\delta$, so if each beam is an independent measurement the 3-beam system measures TAS more accurately than a single-beam system. However, the unique solution for the wind vector obtained from the 3-beam system relies on the assumption that all three beams are viewing air that has the same wind vector $\mathbf{v}$. If there is variation in the wind vector at the three viewed locations, that variation is not necessarily just variation in $u$ (that it might be desirable to average) but can also result from other variations because the beams are not aligned along the $u$ axis. 

Because the uncertainty $\delta$ is less than 0.1 m/s, variations of this magnitude would introduce errors comparable to the measurement error. The spatial separation between any two sensitive volumes in the 3-beam system is about 1.5($\sqrt{2}L\sin(35^{\circ})\simeq18$\,m for focal distance L=15 m. The variance in the wind for points separated by 18 m can be estimated as follows:\sindex[lis]{epsilon@$\epsilon$=eddy dissipation rate}\sindex[lis]{k@$k$=wave number} 

\begin{equation}
(u^{\prime})^{2}=\int_{k_{0}}^{\infty}C\epsilon^{2/3}k^{-5/3}dk=C\epsilon^{2/3}\frac{3}{2}k_{0}^{-2/3}\label{eq:Uvariance} 
\end{equation}


where $k_{0}=2\pi/\Delta$ with $\Delta=18$ m. For modest eddy dissipation rates in the range $\epsilon=0.001$ to 0.01 m$^{2}$s$^{-3}$, and for $C=0.5$, (\ref{eq:Uvariance}) results in estimates of the velocity standard deviations of about 0.1 to 0.3 m/s. These fluctuations, entering (\ref{eq:TAS3beam}), will cause errors in the estimate of $u$ that are not negligible in comparison to the measurement errors in \{$a_{1},\,a_{2},\,a_{3}$\}. 


\subsection{Conclusions\label{sub:Conclusions}}

\index{uncertainty!summary table}Table~\ref{tab:Summary-of-uncertainty} restates the key results from this section. \index{uncertainty!conclusion}
This subsection omits discussion of the three-beam LAMS because its evaluation is still underway and the available data are sparse. The general approach and good estimates of
the uncertainty in the relative wind were provided in Sect.~\ref{sub:LAMS-uncertainty},
but the system shares some weaknesses with the gust-pod system because of weaknesses
in the measurements from the associated IRU. Therefore, this summary only reviews the
results for the radome-based and gust-pod systems.

The first three lines of Table~\ref{tab:Summary-of-uncertainty} claim that wind can be measured with low uncertainty from a high-speed aircraft such as the NCAR/NSF GV. This is particularly challenging at high speed because the aircraft introduces flow distortions and pressure variations over and near the fuselage that affect many of the sensors used to measure wind. Calibration by comparison to a laser air-motion sensor has led to improvement in the measurement of horizontal wind and is the basis for achieving these tolerances. Calibration maneuvers, especially those involving flying circles, have provided evidence for the claimed limits to uncertainty and have refined some of the calibrations used to achieve these limits. The fourth line in the table indicates disappointing performance for the gust-pod measurement of the component of horizontal wind lateral to the aircraft, so in general this measurement should not be used for research without further improvement. However, the measurement of vertical wind from the gust pod provides a useful back-up to the conventional measurement. 

\begin{table}
\noindent \centering{}%
\begin{minipage}[t]{1\columnwidth}%
\protect\caption[Summary of uncertainty for measurements of wind from the GV.]{Summary of uncertainty for measurements of wind from the GV. Where there are two
entries horizontal wind components, the first is the component lateral
to the axis of the aircraft and the second the component parallel to the
axis of the aircraft. All entries pertain to 1-Hz measurements. Units for all entries are m\,s$^{-1}$.\label{tab:Summary-of-uncertainty}}


\noindent \begin{center}
\begin{tabular}{>{\centering}p{3cm}ccc>{\centering}p{2.5cm}}
\toprule 
\textbf{Measurement}  &
\textbf{bias}  &
\textbf{random uncertainty}  &
\textbf{net uncertainty}  &
\textbf{notes}\tabularnewline
\midrule
\midrule 
vertical wind, radome  &
0.10\,m/s  &
0.07  &
0.12  &
Flight altitudes greater than 5000 m, and without pitch correction\footnote{With application of the pitch-correction algorithm of Sect.~\ref{sub:Schuler},
Eq.~\DIFdelbeginFL \DIFdelFL{\ref{eq:pitch-error-wo-approx}}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{\ref{eq:final-answer}}\DIFaddendFL , the bias estimate is 0.05\,m\,s$^{-1}$
and the net uncertainty is 0.06\,m/s.}\tabularnewline
\midrule 
horizontal wind components, radome  &
0.4 , 0.3  &
0.2  &
0.4  &
roll < 5$^{\circ}$ \footnote{Expect minor degradation in turns.}\tabularnewline
\midrule 
vertical wind, gust pod  &
0.18  &
0.11  &
0.2  &
roll < 5$^{\circ}$\footnote{Errors may be much larger in turns.}\tabularnewline
\midrule 
horizontal wind components, gust pod  &
0.7, 0.3  &
1.7, 0.4  &
1.9, 0.4  &
best conditions\footnote{Selected flights in DEEPWAVE; can be factor-of-2 more uncertain for
worst flights. Must qualify heading measurement by comparison to another
measurement to get the listed performance. Not valid in turns.}\tabularnewline
\bottomrule
\end{tabular}
\par\end{center}%
\end{minipage}
\end{table}



\subsubsection{The radome-based system.\DIFaddbegin \label{sub:conclusions-radome}\DIFaddend }

The standard wind measuring system\index{system!standard!uncertainty} on the GV is called the radome-based system and results in the basic wind measurements with variable names WDC,\sindex[var]{WDC>@WDC} WSC,\sindex[var]{WSC>@WSC} and WIC\sindex[var]{WIC>@WIC} respectively representing the horizontal wind direction (degrees relative to true north), horizontal wind speed (m/s) and vertical wind speed (m/s). For this system, the estimated bias limit, random component of standard uncertainty, and net uncertainty are listed in Table~\ref{tab:Summary-of-uncertainty}. These are estimates intended to provide coverage of one standard deviation and should be doubled to obtain approximate estimates of 95\% confidence limits. The combined uncertainty is obtained by adding the estimate of bias and the estimate of random error in quadrature, but this characteristic can be questioned because the bias estimate does not have normal statistical characteristics. It is preferable to use the estimates of bias and of the random component of standard uncertainty separately when characterizing a measurement. As an approximation, it is reasonable to consider about 0.4\,m/s as the uncertainty in each component of the measurement of horizontal wind and 0.1\,m/s as the corresponding uncertainty in vertical wind. In any specific direction, the uncertainty in horizontal wind\index{uncertainty!wind speed} remains about 0.4\,m/s, so this is also the uncertainty in measured wind speed. Translation to uncertainty\index{uncertainty!wind direction} in wind direction depends on the magnitude of the wind speed: If the wind speed is $u$ and the uncertainty in the component of the wind transverse to the wind speed is $\delta_{u}$, the uncertainty in wind direction $\delta\lambda_w$ is about $\delta_{u}$/u. For example, for $u=20$\,m/s and $\delta_{u}=0.4$\,m/s, $\delta\lambda_w=0.02$ rad. or about 1\,$^{\circ}$.\sindex[lis]{lambdaw@$\lambda_w$=wind direction} 

There is some potential for improvement in the vertical wind\index{wind!vertical!potential for improvement} if the pitch-correction algorithm of Section{~}\ref{sub:Schuler} is applied. The improvement in effect removes the bias contribution from pitch, so it reduces the estimated bias to 0.05\,m/s and the standard uncertainty to about 0.06\,m/s. Further reduction would require independent evidence that the calibration maneuvers are flown where the average wind is smaller than the 0.05\,m/s value assumed when obtaining these results, because this then is the dominant remaining uncertainty. 

In the case of horizontal wind, the leading uncertainty is that associated with heading, which could be improved by implementation of a full Kalman filter\index{filter!Kalman} to adjust the heading or by replacement of the IRU with a higher-quality system with inherent Kalman filtering. There are systems available with much lower specified uncertainty that could reduce the uncertainty in lateral wind significantly. 

\DIFaddbegin \DIFadd{An unknown aspect of uncertainty arises from the use of sensitivity coefficients determined from slowly changing flight conditions. Such empirical relationships may fail to represent transient effects on the}\index{upwash}\index{sidewash} \DIFadd{upwash, sidewash, and other distortions in the airflow near the aircraft, and so might lead to transient errors. This problem, discussed further at the end of Sect.}\ \DIFadd{\ref{sub:LAMS-aoa-and-sideslip}, needs further study. Measurements from the LAMS such as those included in that section are now available and, with further study, may be able to set better limits on transient errors. 
}


\DIFaddend \subsubsection{The gust-pod system}

The vertical wind measured by the \index{gust pod}gust pod is surprisingly good, when it is considered that the measurements are made under the wing of the aircraft in a region of seriously distorted airflow. While of lesser quality than the measurements from the radome, the measurements based on the gust pod have estimated uncertainty\index{uncertainty!vertical wind!gust pod} only about twice that of the radome-based measurement. On the other hand, the measurements of horizontal wind from the gust pod have significantly greater uncertainty\index{uncertainty!horizontal wind!gust pod} than those from the radome. The uncertainty approaches 2\,m/s even in the selected best cases, and there are examples where the discrepancy between similar measurements of heading becomes much larger than the tabulated values and the associated uncertainty in horizontal wind becomes even larger. Vertical and horizontal winds from the gust pod are both problematic\index{gust pod!limitations} in turns and should not be used for roll angles exceeding about 5$^{\circ}$ in magnitude. The problem with measurements in turns arises because the gust-pod system is not aligned with the longitudinal axis of the aircraft so, in turns, the three attitude angles (pitch, roll, heading) become intermixed. It may be that the appropriate angle transformations can be found to handle this problem, but current processing leads to obvious errors in turns. 

The straightforward way to improve the measurements from the gust pod would be to improve the measurement of heading. It might be possible to calculate a surrogate heading from the fuselage IRU and the known installation offset of the gust-pod IRU, but this hasn't been investigated yet and would require continued study beyond that reported here.

\subsubsection{Comparison of vertical wind from the two systems}



\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}
\includegraphics[width=\maxwidth]{figure/WICWIGdiff-1} \caption[Histogram of the differences between the vertical wind measured by the radome-based system and that measured by the gust-pod system.]{Histogram of the differences between the vertical wind measured by the radome-based system (WIC) and that measured by the gust-pod system (WI\_GP) for all 1-Hz measurements from the DEEPWAVE project where the absolute value of the roll was less than 5$^{\circ}$, flight speed was above 130~m/s, and flight altitude was FL350 (35,000~ft) or above. The density shows the fraction of points per unit interval in the difference WIC-WI\_GP. There were a total of about 280,000 measurements used for this plot, but some flights and flight periods were excluded where it appeared, from comparison to other IRUs, that the pitch measurement from the gust-pod system was of degraded quality.}\label{fig:WICWIGdiff}
\end{figure}


\end{knitrout}

Some support for this value of uncertainty in vertical wind from the gust pod was provided by Fig.~\ref{fig:vw-gp-vs-wic}, where the two measurements of vertical wind were compared for all measurements from one flight. The standard deviation in the difference between the two measurements was 0.27\,m/s. For the complete DEEPWAVE project, excluding flights and periods with gust-pod data that were obviously bad, the standard deviation was the same. The 1-Hz measurements from the entire DEEPWAVE project are shown as a histogram in Fig.~\ref{fig:WICWIGdiff}.\sindex[var]{WIC>@WIC}\sindex[var]{WIG>@WIG} The uncertainties in Table~\ref{tab:Summary-of-uncertainty} would suggest an expected uncertainty in the difference of 0.22\,m/s,\footnote{Biases are included in this estimate of the expected standard deviation because the dominant bias originates from bias in pitch, which varies from flight to flight and even during flights because of Schuler oscillation but appears as a bias for measurements made over periods small compared to the Schuler-oscillation period.} slightly lower than the measured difference. Some of that difference can arise from real differences in vertical wind at the two locations on the aircraft and from timing differences, so the measured standard deviation is in reasonable agreement with the expectations from the uncertainty analysis.\index{wind!vertical!inter-comparison} 

% Using measurements of horizontal wind from the \index{gust pod!recommendation}gust pod is not recommended. That system was designed to provide a back-up measurement that could be anti-iced to remain operational in heavy cloud. In the case of vertical wind, it appears that the system fills this back-up roll well. However, the horizontal wind from the gust pod is much inferior to that from the radome-based system and probably should be used only with much caution. That would involve checking that the measurement of heading from the gust-pod IRU (excluding turns) provides measurements in reasonable agreement with other units, with adjustment for  installation differences in orientation. An additional restriction arises from the fit restrictions used to determine the coefficients in the equation representing angle of attack. Those restrictions were: airspeed (TASF) greater than 130\,m/s, absolute value of roll less than 5$^{\circ}$, and altitude greater than 5000~m. Outside these limits, extrapolation errors can lead to additional errors in the measurements from the gust pod. 










\section{Empirical coefficients\label{sec:Calibrations}}

This section reviews the determination of empirical or ''sensitivity'' coefficients that provide parameterized measurements of the angles of the relative wind\index{wind!relative} (angle of attack\index{attack!angle of} and sideslip\index{sideslip} angle) in terms of measured quantities like pressure differences between ports on the radome. These sensitivity coefficients are essential for measurement of the relative wind, as described in Sect.~\ref{sub:The-Relative-Wind}, Eq. (\ref{eq:relative wind}). DEEPWAVE\index{DEEPWAVE!flight 15} flight 15 on 3 July 2014 was devoted to calibration maneuvers\index{maneuvers!calibration}, and measurements from that flight, combined with similar calibration maneuvers flown on flight 11\index{DEEPWAVE!flight 11} at 40,000 ft, are used in this section to determine sensitivity coefficients for measurements of angle of attack (AKRD\sindex[var]{AKRD>@AKRD} and AK\_GP)\sindex[var]{AK_GP>@AK\_GP} and of sideslip angle (SSRD\sindex[var]{SSRD>@SSRD} and SS\_GP\sindex[var]{SS_GP>@SS\_GP}). A larger data set, described below, is also used to study the representativeness and uncertainty of the resulting sensitivity coefficients.

% For reference: The data files used were those produced in the field% during the DEEPWAVE project using nimbus code on the ground station% at that time. Files used were those from RF15, RF11, RF14, and RF16.% These data files have been transferred to EOL storage as /scr/rafdata/DEEPWAVE/DEEPWAVErfxx.nc% where xx is the flight number. For backup purposes, there is also% a zip file of these data files saved as DWCal.zip.





\subsection{Angle of Attack\label{sub:Calibration-AOA}}


\subsubsection{Equations underlying the calibration}

The first-order expression for the vertical wind $w$ is 

\begin{equation}
w=V\sin(\alpha-\theta)+w_{p}\label{eq:VWind} 
\end{equation}


where $V$ is the airspeed, $\alpha$ the angle of attack, $\theta$ the pitch, and $w_{p}$ the vertical motion or rate-of-climb of the aircraft. The solution for the angle of attack\index{attack!angle of!calibration equation} is 

\begin{equation}
\alpha=\theta+\arcsin\frac{w-w_{p}}{V}\label{eq:SolvedForAOA} 
\end{equation}


If it is reasonable to assume for some period of flight that $w$ is zero, or that it averages to zero, then 

\begin{equation}
\alpha^{*}=\theta-\arcsin\frac{w_{p}}{V}\label{eq:alphaWithwZero} 
\end{equation}


can be used as a reference angle of attack to which to fit a parameterized formula. Even in the presence of waves, fitting functions of the radome measurements and other flight characteristics to this reference should average any real effects of vertical wind as long as the vertical wind over the flight segments used averages to zero. 

The danger in this approach is that a particular data set may not have negligible average mean wind. For example, if a flight spent more time in the updraft regions in the ascending portion upwind of a barrier and less in the downdraft region downwind of the barrier, or more time in the subsidence regions surrounding active convection, the mean measurement of vertical wind may not be negligible. The functions used for representation of angle of attack always include an offset term along with functions of measurements, so it may be appropriate to adjust that offset if there is evidence that the mean vertical wind should not be zero. Other steps can be taken to check the offset coefficient, as discussed in subsequent sections. 

In the case of the standard radome-based system on the GV, the relevant variables are $\theta$=PITCH,\sindex[var]{PITCH>@PITCH} $w_{p}=$GGVSPD,\sindex[var]{GGVSPD>@GGVSPD} and $V=$TASF.\sindex[var]{TASF>@TASF} The system measures the pressure difference (ADIFR)\sindex[var]{ADIFR>@ADIFR} between top and bottom ports on the radome, and this pressure is then normalized by some measure of dynamic pressure like QCF\sindex[var]{QCF} or QCFC.\sindex[var]{QCFC=corrected dynamic pressure {[}hPa{]}} The former is preferable because the use of corrected QCFC requires the application of static-defect corrections that themselves depend on angle of attack, leading to circularity in the calculation. Other candidates QCR\sindex[var]{QCR>@QCR} and QCRC are not chosen because they can be affected by icing or freezing of accumulated water in pressure lines even when ADIFR\sindex[var]{ADIFR>@ADIFR} continues to function. 

For the gust pod, the relevant variables are $\theta$=CPITCH\_GP,\sindex[var]{CPITCH_GP>@CPITCH\_GP} $w_{p}$=CVSPD\_GP,\sindex[var]{CVSPD_GP>@CVSPD\_GP} and $V$=TASF. The gust-pod measurements differ from those measured relative to the fuselage; for example, the pitch of the gust pod is several degrees different from that of the fuselage because of the way in which the gust-pod IRU is installed. However, the airspeed $V$ in (\ref{eq:alphaWithwZero}) is measured better by the fuselage system, so TASF\sindex[var]{TASF>@TASF} will be used for $V$. The equation with the appropriate variables is then:  
\begin{equation}
\alpha^{*}=\mathrm{CPITCH\_GP}-\arcsin\frac{\mathrm{CVSPD\_GP}}{\mathrm{TASX}}\label{eq:AOAeq} 
\end{equation}


''Calibration'' of the angle of attack (i.e., fitting to find the empirical relationship) then requires determining a \sindex[lis]{alphafit@$\alpha_{fit}$=empirical function representing angle of attack}\sindex[lis]{alphastar@$\alpha^{*}$=reference angle of attack for calibration}function $\alpha_{fit}(\{m_{i}\})=\alpha^{*}$ of \sindex[lis]{mi@$m_{i}$=measured quantities used in empirical functions}measured quantities \{$m_{i}\}$ that approximates the values of $\alpha^{*}$ determined from (\ref{eq:AOAeq}). Possible terms $m_{i}$ in that function may include pressure measurements from the radome (esp.~ADIFR),\sindex[var]{ADIFR>@ADIFR} dynamic pressure, and Mach number, as well as powers and products of these terms. For the Rosemount 858 sensor used with the gust pod, it is expected from theory that one element of $\{m_{i}\}$ will be ADIF\_GP/QC\_GP\@.\sindex[var]{ADIF_GP>@ADIF\_GP}\sindex[var]{QC_GP>@QC\_GP} Wind tunnel and theoretical studies predict how the pressure will vary on a hemispheric surface with changing angles, but those predictions apparently do not provide good guidance in this case because there is considerable flow distortion at the under-wing location of the pod and that flow distortion affects the pressure response to changes in flow angles. Therefore the above fit procedure is used for the 858 sensor also and determines a separate functional representation of the calibration data for the gust pod. 


\subsubsection{Application to the radome\label{sub:radome-sensitivity}}

The sensitivity coefficients for the radome are determined\index{attack!angle of!empirical representation} through the use of speed runs.\index{maneuver!speed run} In these maneuvers, the aircraft is slowed to a speed near the lower range of its operating range, then accelerated to near the upper limit, and then slowed again to normal cruise. If this is done while flying a level track, the angle of attack will vary through its normal range and the pitch will vary similarly. If there is no vertical wind or if a fluctuating vertical wind averages to zero, (\ref{eq:alphaWithwZero}) provides a reference angle $\alpha^{*}$ \sindex[lis]{alphastar@$\alpha^{*}$=reference angle of attack for calibration}that serves as reference for the parameterized fit. 

There were three speed runs during DEEPWAVE flight 15,\index{DEEPWAVE!calibration maneuvers} at the times 3:21--3:29, 4:15--4:23, and 5:01--5:11 UTC and at approximate altitudes of 3830\,m, 5770\,m, and 8800\,m. On flight 11 of that project, there was a similar speed run flown from 10:30--10:40 UTC at an altitude of approximately 12,250\,m. For the purpose of this first determination of sensitivity coefficients for angle of attack, only those periods were used. In addition, because some of the measurements at minimum speed deviated from the otherwise simple fits, only measurements with airspeed in excess of 130 m/s were used; this eliminated some of the slowest parts of the speed runs, but that is a flight speed not used in normal operation. 

%In the code being used (cf.\ WindUncertainty.Rnw), the line  
%\begin{lyxcode}
%AOAREF~<-~PITCH~-~asin(GGVSPD/TASF)~/~Cradeg 
%\end{lyxcode}
%represents Eq.~(\ref{eq:alphaWithwZero}), where Cradeg=$\pi$/180, where Cradeg=$\pi$/180.

The sensitivity to the pressure difference between vertically separated ports is the most important part of the calibration of angle of attack. Secondary terms are sometimes needed to adjust the value to maintain a correct zero. Therefore, the fit was done in two stages. First, the four speed runs alone were used to determine the sensitivity to the pressure ratio, and then a larger dataset was used to incorporate a wider range of flight conditions to check that the fit determined from the speed runs remained representative of the larger data set.. The first fit was to the following simplified equation: 

\begin{equation}
\alpha^{*}=c_{0}^{*}+c_{1}^{*}\frac{\Delta p_{\alpha}}{q}\label{eq:AOAsens1term} 
\end{equation}
where $c_{0}^{*}$ and $c_{1}^{*}$ are sensitivity coefficients determined
by the fit. \sindex[lis]{cstar@$c_{0}^{*},\,c_{1}^{*}$=empirical coefficients for angle of
attack, alternates to \{$c_{0},\,c_{1}$\}}Once sensitivity coefficients are found, the angle of attack can then
be calculated using $\alpha$ as produced by the right side of this
same equation.

Figure~\ref{fig:AOA-fit-and-plot} compares $\alpha$ obtained in
this way to the reference value $\alpha^{*}$ for the data used in the fit. The fit results
are tabulated in the following summary, which was produced by the
``R'' call at the top of the listing. AQR is $\Delta p_{\alpha}/q$ and AOAREFC\sindex[var]{AOAREFC=reference angle of attack with pitch correction} is $\alpha^{*}$ with
correction to pitch as described later in this report (Sect.~\ref{sub:Schuler}). 



\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = AOAREFC ~ AQR, data = Data2)
## [1] "Coefficients:"
##             Estimate Std. Error t value Pr(>|t|)
## (Intercept)    4.394   0.005672   774.6        0
## AQR           20.986   0.068937   304.4        0
## [1] "Residual standard deviation: 0.121, dof=1977"
## [1] "R-squared 0.979"
\end{verbatim}
\end{kframe}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-AOA-fit-and-plot-1} 

}

\caption{The angle of attack determined from the fit to pressure measurements from the radome, as a function of the reference angle provided by Equation (\ref{eq:AOAsens1term}), for the combination of data from all four speed runs as listed in the text.}\label{fig:AOA-fit-and-plot}
\end{figure}


\end{knitrout}

This fit gave coefficients $c_{0}^{*}$ and $c_{1}^{*}$ equal to  
4.394$^{\circ}$ and 20.986$^{\circ}$,  
accounted for 97.9\% of the variance and had a residual standard deviation\footnote{The R routine 'lm' produces a quantity labeled "residual standard error" that represents the standard deviation between the fit results and the measurements, but this will be described here as the residual standard deviation to clarify that this is the standard deviation of individual points, not of the mean.}\index{residual standard deviation} of 0.12$^{\circ}$, so it represents the speed-run data reasonably well.\footnote{A residual standard deviation of this magnitude corresponds to the measured fluctuations
in the vertical wind for this data set of about 0.3--0.4\,m/s.} 
%In Fig.~\ref{fig:AOA-fit-and-plot}, the thin gray line under the
%thick orange dashed line represents the uncertainty in the fit result
%and shows that the uncertainty in representing these data with this
%set of coefficients is negligible. 
The entries "Std. Error" in the tabulated results show that the fit coefficients are constrained with small uncertainty limits. 
The more significant uncertainty,
however, comes from the assumption that the vertical wind is zero
for these periods of the speed runs. Therefore, additional studies
will be used below for further evaluation of the uncertainty introduced
by this assumption.

This calibration would be affected by a time difference between the IRU measurement of pitch and the data-system sampling of the pressures involved, especially that from the radome. The IRU outputs measurements with a time delay that can be variable and unknown but is expected to be <0.1~s, and normal processing uses an adjustment of 60~ms to compensate for this delay. To guard against this delay affecting the calibration, fits like that leading to the above formula and coefficients were repeated after shifting the measurement of pitch by various time intervals, both forward and backward. For shifts within about 0.5\,s, the results did not change significantly, although the fit with adjustment of pitch \emph{backward} by about 0.5\,s had the smallest residual standard deviation. Equivalently, a similar residual standard deviation was obtained when the measurement of the pressure ratio from the radome ($\delta p_{\alpha}$) was moved forward in time by a similar amount. Neither of these shifts seems likely at this magnitude, and the change in standard deviation was only about 0.002$^{\circ}$, so we interpret this as indicating insensitivity of the calibration to small shifts in time. That is likely a result of the calibration data being from speed runs where the flight speed is gradually increased and then decreased, so an effect of a lag partially cancels in such data segments. 

The calibration would also be affected by pitch errors such as are discussed in Sect.~\ref{sub:Schuler}. Therefore the correction procedure discussed in that section was applied to these data before finding the preceding fit.\footnote{The correction is based on detection of the errors in ground-speed measurements and use of the Schuler relationship between pitch error and acceleration error to correct the pitch. This is discussed in detail in the referenced section.} In comparison to the fit without this correction, the residual standard deviation was changed only negligibly and the two fit coefficients changed by -0.007 and -0.004, respectively, so this correction also had only minor effect on the fit, with changes comparable to or smaller than the standard errors in these coefficients. This insensitivity perhaps arises because the period of the calibration spanned a few hours and so included enough time for some averaging of the Schuler oscillation of errors in pitch.




Previous studies of the radome where low-altitude flight segments were included required an additional term in the calibration equation to match reference measurements ($\alpha^{*}$) in the boundary layer over the ocean as well as at high flight levels. The standard calibration\index{attack!angle of!standard coefficients}, determined from a large set of speed runs from past projects, is given in the RAF document on \href{https://drive.google.com/open?id=0B1kIUH45ca5Ab2Z6cld1M1cydjA&authuser=0}{Processing Algorithms}: 

\begin{equation}
\alpha=c_{0}^{\prime}+\frac{\Delta p_{\alpha}}{q}(c_{1}^{\prime}+c_{2}^{\prime}M)\label{eq:AOAstandard} 
\end{equation}
\sindex[lis]{Deltapa@$\Delta p_{\alpha}$=pressure difference between bottom and
top ports on the radome or gust pod {[}hPa{]}}\sindex[lis]{Deltapb@$\delta p_{\beta}$=pressure difference between starboard
and port sources on the radome or gust pod {[}hPa{]}}\sindex[lis]{cprime@$c^{\prime}$=standard coefficients for calculating
the angle of attack}with coefficients \{$c^{\prime}$\} = \{4.604$^{\circ}$, 18.67$^{\circ}$,
6.49$^{\circ}$\}. The last term provides some adjustment dependent
on Mach number\index{Mach number}\sindex[lis]{M@$M$=Mach number} $M$ and corrects an offset often
seen in vertical wind at low airspeed.


Figure~\ref{fig:plot-comparison-to-standard}\sindex[var]{AKRD>@AKRD} shows the angle of attack\index{attack!angle of!alternate fit} determined from this fit vs.\ that from the standard formula. The plotted shapes show the distribution in values for centered intervals in the predicted angle of attack, where the blue shapes and orange line are the results from the fit to the speed-run measurements and the green shapes are the distributions that would result from using the standard calibration. The standard calibration is close to that determined from the speed runs, but the standard deviation of the difference between predicted values and fit values increases from 0.12$^{\circ}$ for the speed-run fit to 0.15$^{\circ}$ for the standard fit. The difference is most evident for measurements at large angle of attack, where the standard coefficients produce increasingly higher values as the angle of attack increases. 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-plot-comparison-to-standard-1} 

}

\caption[Angle of attack determined from the simple fit to the pressure ratio from the radome.]{The angle of attack determined from the simple fit to the pressure ratio from the radome, as a function of the angle of attack predicted for zero vertical wind from the formula in the text (blue shapes), and the corresponding distribution that would result from using the standard calibration (green shapes). The shapes show the distributions for measurements in centered bins at (1/3)-degree increments in the predicted angle of attack. The dashed orange line is the best fit to the speed-run measurements.}\label{fig:plot-comparison-to-standard}
\end{figure}


\end{knitrout}

% For% comparison, the next figure (Fig.\ 2) shows the angle of attack determined% from this fit vs.\ that from the standard processing being used for% preliminary field processing and onboard display during DEEPWAVE.% There is a clear discrepancy, which arises from flight at between% 8,000 and 9,000 m. This also causes a significant offset in WIC at% these altitudes. This is simply an error in the calibration in use,% which traces back to much earlier projects and does not match the% algorithm documents or other recommendations for this calibration.% It will be important to use the new calibration for processing to% eliminate the offset arising from this old calibration.% % \begin{figure}% {\centering \includegraphics{figure/GP-AOA-vs-old-AOA}% % }% % \protect\caption[The angle of attack determined from the simple fit to the pressure% ratio from the radome, compared to the standard variable AKRD used% for preliminary processing]{The angle of attack determined from the simple fit to the pressure% ratio from the radome, compared to the standard variable AKRD used% for preliminary processing. The points plotted in red are those measured% at altitudes between 8 and 9 km GPS altitude; all others are plotted% as blue symbols.\label{fig:AOA-vs-old-AOA}}% \end{figure}

Because the standard fit in use for the GV includes an additional term representing dependence on Mach number, the benefit of using such a fit for DEEPWAVE is worth considering. The primary reason for that fit has been that otherwise the measurements of vertical wind at low level tend to be biased, but most of the useful flight data from DEEPWAVE was at intermediate or high levels so this may not be a concern for this project. 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = AOAREF ~ AQR + AQRM, data = Data2)
## [1] "Coefficients:"
##             Estimate Std. Error t value
## (Intercept)    4.387   0.005402  812.09
## AQR           17.924   0.216747   82.70
## AQRM           4.295   0.288585   14.88
##              Pr(>|t|)
## (Intercept) 0.000e+00
## AQR         0.000e+00
## AQRM        1.445e-47
## [1] "Residual standard deviation: 0.115, dof=1976"
## [1] "R-squared 0.981"
\end{verbatim}
\end{kframe}
\end{knitrout}

Fitting (\ref{eq:AOAstandard}) to the speed-run data gave the results listed above, with a residual standard deviation that is reduced by <0.006$^{\circ}$ relative to the fit without the term dependent on Mach number, so for those measurements this small improvement does not seem to justify adding another term to the fit. % This will be revisited later in this section with an expanded data set. 



The next step was to expand the data set to include flights from a range of altitudes including up to FL450,\footnote{FL450 denotes flight level 450 or flight at the pressure corresponding to 45,000~ft in the ICAO\sindex[var]{ICAO=International Civil Aviation Authority} standard atmosphere.} to check if it is necessary to refine the fit to include additional terms like that in Eq.~\ref{eq:AOAstandard} to constrain the zero of the angle of attack while preserving the measured sensitivity as in (\ref{eq:AOAsens1term}). This expanded dataset included DEEPWAVE flight 14, with a FL450 leg from 11:30 to 12:20 UTC; flight 16, with a FL430 leg from 9:30 to 11:00 UTC; flight 3, all measurements at and above FL350 (to incorporate a long flight where fuel burn-off changed the angle of attack); and an expanded section from flight 11 (in addition to the speed runs) from 7:00 to 10:00 UTC, to include a long leg at FL400. 

Various fit equations were explored involving terms including the Mach number, the air density, the measured pressures, and various products and powers of these terms including terms multiplied by the basic pressure ratio already included in (\ref{eq:AOAsens1term}). None of these produced enough improvement over the single-term fit to warrant their inclusion; the best improvement in the residual standard deviation was about 2\%.\footnote{Additional terms that did improve the fit significantly were those correlated with the terms in Eq.~\ref{eq:alphaWithwZero}, esp.~pitch, but including such terms is not consistent with finding a fit that would represent the angle of attack in conditions with non-zero vertical wind. For example, including \textquotedbl{}PITCH\textquotedbl{} as a term in the fit resulted in a coefficient for this term of about 0.4, and such a large correlation between resulting measurements of angle of attack and pitch would bias the response to a true vertical wind. As an extreme example, inclusion of a term based on the right side of Eq.~\ref{eq:alphaWithwZero} leads to a perfect fit, but use of such a fit would ensure that all measurements of vertical wind would be zero. For this reason, pitch and vertical aircraft motion were excluded from the candidate terms in the fit.} 



The two-coefficient fit\index{attack!angle of!fit with expanded data set} to the expanded data set, using\\ 
\begin{equation}
\alpha=c_{0}+c_{1}\frac{\Delta p_{\alpha}}{q}\,\,\,,\label{eq:AOArecommended} 
\end{equation}
gave best-fit coefficients\index{attack!angle of!recommended coefficients} 
\{$c_{0},\, c_{1}$\} = \{4.468$^{\circ}$, 21.481$^{\circ}$\}\sindex[lis]{c0@$c_{0},\thinspace c_{1}$=coefficients used to calculate angle of attack}  
and a residual standard deviation of 0.12$^{\circ}$  
for 17,715 measurements. The small increase in residual standard deviation in comparison to the speed-run measurements is expected because this expanded data set includes regions more likely to have non-zero vertical wind, which would contribute to this residual error. Expanding this fit to include a third coefficient as in (\ref{eq:AOAstandard}) resulted in negligible improvement (0.001$^{\circ}$) in the residual standard deviation, and introduction of a set of eight possible dependencies while exploring for better fits only led to reduction in the standard deviation by 0.003$^{\circ}$, so more complicated equations than (\ref{eq:AOArecommended}) do not appear to be needed.\footnote{This simpler representation applies to the normal research flight levels of the DEEPWAVE project, levels above about 10,000 ft. Because expanded representations were needed in other projects to represent low-level flight data, and low levels are not included in this expended data set, it may be necessary to revisit this calibration with more terms if lower-level flight segments are to be analyzed.} Another fit considered with this expanded data set was to set the slope parameter to the value obtained from the speed-run data, 20.986$^{\circ}$, and then fit using the expanded data set to determine a value of the offset coefficient that minimized the mean vertical wind. That gave a value for the first coefficient of 4.43$^{\circ}$ and a standard deviation negligibly different from that for the two-coefficient fit, so that is another indication that the speed-run dataset and the expanded dataset give consistent results.  

The recommended calibration for DEEPWAVE, determined with correction of the pitch errors as discussed in Sect.~\ref{sub:Schuler}, is (\ref{eq:AOArecommended}) with these values for the coefficients: \{$c_{0},\, c_{1}$\} = \{4.468$^{\circ}$, 21.481$^{\circ}$\}.\label{page:aoarec} 
However, for other projects and general use the coefficients and standard fit
(\ref{eq:AOAstandard}) are better initial choices for processing.

Evaluation of all the points in the expanded DEEPWAVE dataset using three fits, that from the expanded dataset, from the speed runs alone, and using the \textquotedbl{}standard\textquotedbl{} fit discussed above, gave only very small differences in the results. In Fig.~\ref{fig:second-violin-plot} the values of angle of attack obtained using the fit to data from the expanded dataset are compared to those obtained using the fit to the speed-run dataset. 
The angle of attack evaluated from the expanded-dataset coefficients resulted in values  
0.036$\pm$0.007$^{\circ}$  
larger than those from the speed-run coefficients and  
0.037$\pm$0.036$^{\circ}$  
larger than those from the standard coefficients, so using any of these formulas would give about the same results. 

% Still another determination of the
% sensitivity coefficients was based on the full set of measurements from
% all flights in the DEEPWAVE project; 
% that led to coefficients \{4.437, 21.193\} and a difference
% in angle of attack relative to the reference data set above of 
% round(mean(Data$A4-Data$A3, na.rm=TRUE),3)%
% $\pmround(sd(Data$A4-Data$A3, na.rm=TRUE),3)^{\circ}$.
% One measure of uncertainty in the results from applying
% these fits is that the various fits differ by about 0.03$^{\circ}$
% in resulting angle of attack. 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-second-violin-plot-1} 

}

\caption[Distributions in the angle of attack determined from the two-coefficient fit to the expanded dataset, plotted with the distributions that would result from use of the equation based on the speed-runs only]{Distributions in the angle of attack determined from the two-coefficient fit to the expanded dataset, plotted with the distributions that would result from use of the equation based on the speed-runs only. The pink color denotes regions covered by both distributions.}\label{fig:second-violin-plot}
\end{figure}


\end{knitrout}

% The best fit to the expanded dataset, keeping $c_1^{*}$ fixed as given in (\ref{eq:AOAsens1term}), was% the following equation:% % \begin{equation}% \alpha=c_{0}+\frac{\Delta p_{\alpha}}{q}(c_{1}^{*}+c_{1}M+c_{2}M^{2}+c_{3}M^{3})+c_{4}M\label{eq:BestFitAOAradome}% \end{equation}% with coefficients \{$c_{i}$\}=\{4.1079717, 82.6157340, -135.8737038,% 77.4028078, 0.5531502\} and $c_1^*$ =21.872829. The results are shown in the following figure, and a summary of the fit is listed also. The residual error in angle of attack was 0.11$^\circ$ for the 17,168 points used in the fit, and all terms in (\ref{eq:BestFitAOAradome}) tested as having high significance. (The variables listed as AQRMx are $\frac{\Delta p_{\alpha}}{q}M^x$ where $M$ is the Mach number.)

The standard errors in the coefficients for the expanded dataset are respectively 0.0035$^{\circ}$ and 0.046$^{\circ}$, so the coefficients are tightly constrained by the fit.  The correlation between error terms was very high and positive, but the second coefficient is applied to a term ($\delta p_{\alpha}/q$) that is typically negative with representative magnitude of about -0.0037$^{\circ}$ so the correlated uncertainties partially cancel, leaving a net uncertainty in angle of attack of 0.0007$^{\circ}$ (for 0.99 correlation between the uncertainty terms) as a result of uncertainty in the fit. 

The expanded dataset provided results consistent with those from the speed runs alone but contained 17,721 measurements vs.~only 2,019 for the speed-run dataset, so this larger set provides an opportunity to examine the consistency of results from subsets of the measurements. For this purpose, randomly selected but exclusive subsets of the data were selected repeatedly and the fit coefficients were determined from each of these subsets. In one example, the dataset was divided randomly into 100 exclusive subsets and the fit coefficients were calculated for each of those subsets, and then this process was repeated 50 times. The resulting standard deviations in the fit coefficients were 0.070$^{\circ}$ and 0.88$^{\circ}$. With resampling, the independent samples entering these averages are fewer than 5000 but more than 100, suggesting that the means for the coefficients are known with uncertainties of between 0.007 -- 0.001$^{\circ}$ for the first coefficient and 0.09--0.012$^{\circ}$ for the second. The estimates from the fit (0.004$^{\circ}$, 0.053$^{\circ}$) are midway in these ranges, so the fit results are consistent when the data are partitioned into various subsets. The fit results thus appear reasonably characterized by the estimated standard errors from the fit.\index{representation!empirical!re-randomization tests} 

Repeating this for different subset sizes $N$ indicated that the standard deviations in the coefficients scaled in a manner consistent with $\sqrt{N}$ behavior, suggesting that the results are not biased by isolated outlier measurements such as would occur from regions of extended non-zero vertical wind. The sub-setting also produced resulting values for the individual coefficients that were highly correlated, with correlation coefficient around 0.99. This also supports the partial cancellation of uncertainty as evaluated for the fits. 

These estimates of uncertainty characterize how well the sensitivity coefficients characterize the data, but the validity of the result is dependent on the mean vertical wind being zero, as discussed in connection with Eq.~(\ref{eq:SolvedForAOA}). A non-zero mean vertical wind of 0.1~m/s will introduce bias into the first sensitivity coefficient of magnitude 0.02$^{\circ}$, a value much larger than the estimated uncertainty in angle of attack resulting from the fit. This then is the major uncertainty affecting angle of attack and hence vertical wind, and it is difficult to quantify except by estimates of how large the vertical wind might be. For all 1-s measurements of vertical wind in the DEEPWAVE project, the mean vertical wind was 0.03\,m/s without correction for pitch errors and <0.01\,m/s with such correction, in both cases with a standard deviation of about 0.5\,m/s. When measurements are partitioned into groups within 1-5$^{\circ}$ longitude upwind and downwind of the island crest, using a slanted dividing line approximately matching the orientation of the island, the two groups had respective mean vertical wind measurements of -0.026 and +0.032\,m/s, so even over the South Island of New Zealand there was no significant mean vertical wind at the altitude of research flights. It therefore seems reasonable to use a limit of about 0.04\,m/s as applicable to the calibration process, leading to an estimated bias limit on the first sensitivity coefficient of magnitude 0.01$^{\circ}$. This is then the dominant uncertainty component affecting the measurement of angle of attack.\index{attack!angle of!effect of mean vertical wind in calibration data} 

One additional test was used to check the consistency of the measurements and to ensure that the project-mean vertical wind would be near zero for research-flight conditions. All DEEPWAVE\index{DEEPWAVE!flights with bad measurements} flights that appeared to provide good data for the calibration procedure were combined into one dataset. The excluded flights were 6 and 7 (where there were problems with ice-blocked lines in the radome), and 15 (the calibration flight, mostly at lower than research flight altitude). Also, the period from 9:50 to 10:30 UTC on flight 23 was excluded because the radome measurements looked suspicious and might have been affected by blockage. Pitch corrections as discussed in the preceding section were applied to these flights, and then the following tests were used to exclude periods not significant for the calibration: a) measurements where the airspeed was less than 130 m/s, to exclude periods of anomalously high angle of attack, esp. during takeoff and landing when flaps and/or landing gear might be deployed; (b) periods when the roll angle was less than -5 or more than +5$^{\circ}$, to exclude turns; and (c) periods of flight below 35,000 ft pressure altitude, to emphasize the altitudes most used during research flights. More than 400,000 measurements were available for the fit after these exclusions.\index{attack!angle of!fit coefficients, all DEEPWAVE flights} The resulting fit is summarized in the table below:



\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = AOAREF ~ AR, data = DataC)
## [1] "Coefficients:"
##             Estimate Std. Error t value Pr(>|t|)
## (Intercept)    4.435   0.001014    4373        0
## AR            21.166   0.013268    1595        0
## [1] "Residual standard deviation: 0.115, dof=439552"
## [1] "R-squared 0.853"
\end{verbatim}
\end{kframe}
\end{knitrout}

The resulting coefficients were 4.435$^{\circ}$ and 21.166$^{\circ}$.\label{coefficients-aoa-all-flt} These coefficients are similar to those determined for the subset data used previously, but they could be used instead if the goal is to minimize the offsets in mean vertical wind for the project because, for the constraints used, they will force a project-mean vertical wind of zero. A test of these coefficients for the segment of flight 12 away from the influence of the topography of New Zealand indeed led to a mean wind very close to zero, and flight-by-flight averages also are reasonably small with these coefficients. 
This set of coefficients then is a possible alternative to those recommended above (cf.~p.~\pageref{page:aoarec}).



\subsubsection{Application to the gust pod\label{sub:gust-pod-aoa}}

A similar approach was taken for the gust pod, but with variables translated to apply to the gust-pod instead of the radome: $\Delta p_{\alpha}\rightarrow\Delta p_{\alpha,g}$=ADIF\_GP,\sindex[var]{ADIF_GP>@ADIF\_GP} $q\rightarrow q_{g}=$QC\_GP,\sindex[var]{QC_GP>@QC\_GP} $p\rightarrow p_{g}=$PS\_GP, and the Mach number $M\rightarrow M_{g}$ was that determined from the uncorrected measurements $p_{g}$ and $q_{g}$ from the gust pod. Apparently because of the under-wing location in disturbed airflow, a fit involving more terms was needed to represent the reference measurements from Eq.~\ref{eq:AOAeq}. After exploration of various possible terms, the fit selected to represent the gust-pod was the following:\sindex[lis]{Mg@$M_{g}$=Mach number calculated using gust-pod pressure measurements}\sindex[lis]{alphag@$\alpha_{g}$=angle of attack, gust pod} 

\begin{equation}
\alpha_{g}=b_{0}+\frac{\Delta p_{\alpha,g}}{q_{g}}(b_{1}+b_{2}M_{g})+b_{3}\frac{q_{g}}{p_{g}}\label{eq:AOAGfunction} 
\end{equation}


\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = AOAREF_GP ~ AQR_GP + AQRM_GP + RR2_GP, data = Data2)
## [1] "Coefficients:"
##             Estimate Std. Error t value
## (Intercept)  -0.9033   0.007859 -114.94
## AQR_GP        3.6025   0.068942   52.25
## AQRM_GP       4.2860   0.137571   31.16
## RR2_GP        1.3299   0.033658   39.51
##               Pr(>|t|)
## (Intercept)  0.000e+00
## AQR_GP       0.000e+00
## AQRM_GP     1.128e-173
## RR2_GP      4.153e-252
## [1] "Residual standard deviation: 0.099, dof=1975"
## [1] "R-squared 0.989"
\end{verbatim}
\end{kframe}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-AOA-gust-pod-1} 

}

\caption[For the gust pod, the angle of attack determined from the fit as a function of the reference angle, for the combined four speed runs.]{For the gust pod, the angle of attack determined from the fit as a function of the reference angle provided by (\ref{eq:AOAeq}), for the combined four speed runs. Compare to Fig.~\ref{fig:AOA-fit-and-plot}, the corresponding plot for the radome.}\label{fig:AOA-gust-pod}
\end{figure}


\end{knitrout}

The results of this formula are compared to the reference data in 
Fig.~\ref{fig:AOA-gust-pod}. The best-fit coefficients were \{$b_{i}$\}% 
= \{\ensuremath{-0.903}$^{\circ}$, 3.602$^{\circ}$, 4.286$^{\circ}$, 1.330$^{\circ}$\}  
and the square of the correlation was 0.989  
with residual scatter (residual standard deviation) of 0.099$^{\circ}$. % 
The fit was thus even better than that obtained for the radome for these same speed runs.\index{attack!angle of!gust pod!coefficients} 



As for the radome, an all-project fit was obtained for the gust pod. In this case, different flights were excluded: 2, 3, 4, 11, 15, 17, 18, 19, 23, 24, 25 and the flight period from 8:05--8:40UTC on flight 1. In most cases, this was because the C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} IRU providing gust-pod measurements of pitch seemed to have larger than normal deviations that appeared suspicious, so it was thought preferable to fit without those periods of suspicious measurements. The fit summary is as follows:\label{aoa-coefficients-GP-all-flt}  

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = AOAREF_GP ~ AQR_GP + AQRM_GP + RR_GP, data = DataC)
## [1] "Coefficients:"
##             Estimate Std. Error t value Pr(>|t|)
## (Intercept)  -0.8083   0.002366  -341.7        0
## AQR_GP        3.2478   0.030399   106.8        0
## AQRM_GP       5.3507   0.049025   109.1        0
## RR_GP         1.2820   0.007171   178.8        0
## [1] "Residual standard deviation: 0.163, dof=315554"
## [1] "R-squared 0.861"
\end{verbatim}
\end{kframe}
\end{knitrout}

These coefficients \{\ensuremath{-0.808}$^{\circ}$, 3.248$^{\circ}$, 5.351$^{\circ}$, 1.282$^{\circ}$\} provide an alternative to the coefficients obtained above that might be preferable if it is desirable to minimize the all-project mean vertical wind for the gust-pod measurements. 

\subsection{Sideslip Angle\label{sub:calibration-SS}}


\subsubsection{Equations underlying the calibration}

Calibration of the sideslip angle is more difficult, both because the equations are more complicated and because the maneuver is very hard to fly. Ideally, the yaw maneuver should only change sideslip angle and heading without change in roll, altitude, or angle of attack, but that is impossible to fly. It is practical, however, to minimize roll and change in altitude, and that was how these maneuvers were flown. The three sets of yaw maneuvers on DEEPWAVE\index{DEEPWAVE!flight 15} flight 15 were at these times: 3:32:00--3:35:30, 4:31:00--4:33:30, and 5:26:40--5:29:30 UTC.\footnote{Because the yaw maneuvers on DEEPWAVE flight 11 (10:25:00 to 10:30:00) were flown less well, they were not combined with these new measurements, but it does not appear that the sideslip calibration has any significant dependence on altitude.} In the case of yaw maneuvers,\index{maneuver!yaw} the calibration is based on the expectation that the horizontal wind remains constant. The first-order equations for the east and north components of the wind, $u$ and $v$, are: 

\begin{eqnarray}
u & = & -V\sin(\Psi+\beta)+u_{p}\nonumber \\ v & = & -V\cos(\Psi+\beta)+v_{p}\label{eq:horizWindeqs} 
\end{eqnarray}
where $V$ is the airspeed, $\Psi$ the heading, $\beta$ the sideslip angle, and $u_{p}$ and $v_{p}$ are the eastward and northward ground-speed components of the aircraft. These two equations lead to the following reference formula for $\beta$: 

\begin{equation}
\beta^{*}=-\Psi+\arctan\left(\frac{u_{p}-u}{v_{p}-v}\right)\label{eq:beta-equation} 
\end{equation}
where the second term represents a correction for the change in direction of motion of the aircraft, which is difficult to avoid in the yaw maneuver. The measurements thus provide $\beta^{*}$, an estimate of the sideslip angle during the yaw maneuvers. 

There is, however, a circular component in (\ref{eq:beta-equation}) because it involves the wind components and those require $\beta$ for their measurement when sideslip angle changes. To reduce the feedback from this term, the horizontal wind components $u$ and $v$ were low-pass-filtered with periods ranging from 5--60~s and the filtered values were used in (\ref{eq:beta-equation}). Filtering made small differences in the fit coefficients while increasing the residual error significantly, but 60-s filtering was still selected because that is a period long in comparison to the yaw maneuvers so it should reduce possible bias in the fit coefficients from use of the older sensitivity coefficients and any associated fluctuations in the wind measurements during maneuvers. 


\subsubsection{Application to the radome-based and gust-pod systems\label{sub:radome-and-gust-pod-beta}}

For both systems, a relatively simple fit having the following form was sufficient: 

\begin{equation}
\beta=e_{0}+e_{1}\frac{\Delta p_{\beta}}{q}\label{eq:betaFunctionForm} 
\end{equation}
where $\Delta p_{\beta}$ is the pressure difference between horizontally separated pressure ports on the radome and $q$ the dynamic pressure. For the radome, $q=$QCF\sindex[var]{QCF>@QCF} and $\Delta p_{\beta}=$BDIFR;\sindex[var]{BDIFR>@BDIFR} for the gust-pod, $q=$QC\_GP\sindex[var]{QC_GP>@QC\_GP} and $\Delta p_{\beta}=$BDIF\_GP.\sindex[var]{BDIF_GP>@BDIF\_GP} The resulting fit for the radome is listed below: 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = SSREF ~ BQR, data = DataV)
## [1] "Coefficients:"
##             Estimate Std. Error t value
## (Intercept)  0.09187   0.005428   16.92
## BQR         22.30224   0.170344  130.92
##              Pr(>|t|)
## (Intercept) 7.164e-50
## BQR         0.000e+00
## [1] "Residual standard deviation: 0.114, dof=441"
## [1] "R-squared 0.975"
\end{verbatim}
\end{kframe}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-sideslip-fits-1} 

}

\caption[Sideslip angle determined from the fit, for the combination of data from all three yaw maneuvers listed in the text.]{The sideslip angle determined from the fit, as a function of the reference angle provided by Equation (\ref{eq:beta-equation}), for the combination of data from all three yaw maneuvers listed in the text. The gray area underlying the dashed orange line denotes the standard-uncertainty range for the fit.}\label{fig:sideslip-fits}
\end{figure}


\end{knitrout}

The best-fit coefficients\index{sideslip!fit coefficients for DEEPWAVE}  
were \{e\} = \{0.092$^{\circ}$, 22.302$^{\circ}$\},  
the squared correlation was 0.97  
and the residual standard deviation was 0.11$^{\circ}$,  
as listed above. The plotted measurements and this fit are shown in Fig.~\ref{fig:sideslip-fits}. The sideslip-angle offset that is represented by the first term will be determined later by other means; cf. Sect.~\ref{sub:Offset-in-Sideslip}, where the suggested value is $e_0$=0.008$^{\circ}$.

The standard calibration\index{sideslip!standard coefficients} used prior to 2014 for the GV had coefficient $e_{1}$=21.155$^{\circ}$, a slope about 5\% smaller than the values found here. These maneuvers were flown with special care to minimize altitude and roll changes, so this value may be preferable to the older values. The residual standard deviation of the fit, about 0.1$^{\circ}$, is likely much larger than the error in representing the values of sideslip angle via \eqref{eq:betaFunctionForm} because much of the variability likely arises from real fluctuations in the horizontal wind, which would contribute this magnitude error for wind fluctuations of only about 0.4\,m/s. The respective uncertainties in the fit coefficients were about 0.005$^{\circ}$ and 0.17$^{\circ}$, the former leading to a possible bias error and the latter to an error of 0.17/22.3 or less than 1\% in the value of the sideslip angle. Measurements of sideslip angle are seldom larger than 0.2$^{\circ}$, so a fractional error of 1\% is not significant and will be neglected here. The bias in sideslip angle is intertwined with possible bias in heading, so further study of this offset will be deferred to Sect.~\ref{sub:Offset-in-Sideslip} where it will be determined by a better method that separates it from the offset in heading. 


% \begin{figure}% {\centering \includegraphics[width=300pt]{figure/GP-sideslip}% % }% % \protect\caption[The sideslip attack determined from the fit, as a function of the% reference angle provided by Equation (9), for the combination of data% from all three yaw maneuvers listed in the text]{The sideslip attack determined from the fit, as a function of the% reference angle provided by Equation (9), for the combination of data% from all three yaw maneuvers listed in the text.\label{fig:sideslip}}% \end{figure}

For the gust-pod, the same approach was followed, giving a fit with characteristics\index{sideslip!fit coefficients for gust pod} as listed below: 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = SSREF_GP ~ BQR_GP, data = DataV)
## [1] "Coefficients:"
##             Estimate Std. Error t value Pr(>|t|)
## (Intercept)   -3.621    0.02624  -138.0  0.0e+00
## BQR_GP        12.184    0.13287    91.7 2.5e-289
## [1] "Residual standard deviation: 0.164, dof=441"
## [1] "R-squared 0.950"
\end{verbatim}
\end{kframe}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-sideslip-gust-pod-1} 

}

\caption[As in the preceding figure but for the gust-pod system]{As in the preceding figure but for the gust-pod system.}\label{fig:sideslip-gust-pod}
\end{figure}


\end{knitrout}

The squared correlation of this fit was 0.95 and the residual standard deviation was 0.164$^{\circ}$. The best-fit coefficients were \{-3.621$^{\circ}$, 
12.184$^{\circ}$\}. The difference in first coefficient vs the radome is a result of the offset in heading between the aircraft longitudinal axis and the gust pod. The detailed report for the fit is listed above, and the result of applying these sensitivity coefficients to the measurements from the gust pod is shown in Fig.~\ref{fig:sideslip-gust-pod}. 

An additional study is needed to separate a possible offset in sideslip angle from a similar error in heading, because the approach used here assumes that the heading is accurate. In the data files used for this study, an offset in heading of -0.08$^{\circ}$ was imposed; without that offset, the offset in sideslip angle (coefficient $e_{0}$) would be reduced by 0.08$^{\circ}$. A method of determining these separate offsets is developed later in this report (Section \ref{sub:Analysis-of-circle}), where a set of circles flown with constant roll angle are used to obtain a better estimate of the sideslip-angle offset. That study results in a corrected value for $e_{0}$; cf.~Sect.~\ref{sub:Offset-in-Sideslip}, p.~\pageref{page:SSoffset}. 

\subsection{Independent calibrations using the LAMS\label{sub:LAMS-aoa-and-sideslip}}

The LAMS provides an independent measurement of the relative wind, so it provides
an alternative reference for the calibrations of the angles of attack and sideslip.
Some measurements from the three-beam LAMS were shown in Sect.~\ref{sub:LAMS-examples}.
Once relative-wind components are found from the measurements of line-of-sight speeds
along the three beams, the angle of attack is the arctangent of the ratio of the 
vertical to longitudinal component of the relative wind and the sideslip angle is
the arctangent of the ratio of the from-starboard component to the longitudinal
component. The components of the relative wind measured by LAMS thus provide 
independent measurements of these angles that can be used to check the coefficients
determined in the preceding sections. The LAMS system is mounted with significant
offsets in orientation compared to the aircraft centerline, however, so this only
checks the second coefficient in the fits and a difference in first coefficient
is expected.






\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-LAMS-attack-plot-1} 

}

\caption[Standard angle of attack vs. the angle of attack determined from the LAMS.]{Angle of attack determined by the standard system (AKRD) plotted vs. the angle of attack determined from the LAMS. The orange dashed line is the regression line for AKRD as a function of the LAMS angle-of-attack.}\label{fig:LAMS-attack-plot}
\end{figure}


\end{knitrout}

The flight shown previously included a speed run from 20:32--20:42 UTC. Figure~\ref{fig:LAMS-attack-plot}\sindex[var]{AKRD>@AKRD} shows the measurements of angle of attack determined from the standard calibration plotted vs.\ those determined using the LAMS. Using the LAMS-determined angle of attack as the reference $\alpha^{*}$ in a fit of the form \eqref{eq:AOAsens1term} gave a regression slope of 21.22$^{\circ}$, 
about 1\% smaller than the
coefficient recommended above. Because this difference represents a difference in
angle of attack and hence wind that is proportional to the error, the difference for
a vertical wind of 3~m/s would be only 0.03~m/s, so this is good support for the
recommended second sensitivity coefficient. The difference is outside the uncertainty
estimates used in Sect.~\ref{sec:Uncertainty-components}, but the LAMS-derived result is based
on only one set of measurements at an altitude much lower than that used for most
research in DEEPWAVE, so it appears best to regard this as a reasonable check on
those results not requiring any adjustment to them.



There was also a yaw maneuver with the three-beam LAMS, flown from 20:43--20:46 UTC
on that same flight (Nov 24 2014). As for angle of attack, the sideslip measurements
from the LAMS can be used as the reference for calibration of the radome-based 
measurements in \eqref{eq:betaFunctionForm}. The result was a second coefficient of 21.52$^{\circ}$, which differs by only about 4\% from the value of 22.32$^{\circ}$ obtained from the sideslip maneuvers. The sideslip angle in normal flight seldom exceeds 1$^{\circ}$, so
the change introduced by this difference would be typically less than 0.15~m/s. As for
angle of attack, it appears preferable to regard this as a check not requiring a change
in the coefficient determined from a larger data set and under typical conditions for
DEEPWAVE flights. This result does provide a useful check on the validity of the
procedure used to determine the sideslip sensitivity coefficients.

\DIFaddbegin \DIFadd{It is a significant weakness that the data for the calibrations are all collected under conditions where the flight conditions varied only slowly. It is known, however, that when conditions change abruptly there can be transient effects on the airflow around the aircraft that cause departures from the near-steady-state conditions on which the calibrations are based. Under steady conditions,}\index{upwash}\index{sidewash}\index{upwash!see also {sidewash}}\index{sidewash!see also {upwash}} \DIFadd{steady "upwash" or "sidewash" in the distorted airflow around the aircraft is incorporated into the calibrations that lead to sensitivity coefficients. Transient effects, however, can lead to upwash or sidewash that is not consistent with steady-state conditions, and such effects therefore can compromise the validity of the calibrations developed in this document. Transient effects only last a short time and therefore only affect high-frequency measurements, especially for vertical gusts, but this is nevertheless a source of uncertainty that is outside the studies of this technical note. The comparisons to LAMS discussed above are the best evidence available that these effects might be ignored, but further study of transient effects is still needed. See also the discussion of this point in Sect.}\ \DIFadd{\ref{sub:conclusions-radome}.
}

\DIFaddend \subsection{True Airspeed from the Gust Pod\label{sub:GP-TAS}}

% \subsection*{The Components of the Relative Wind}% % The gust pod is a new wind-sensing system so it is useful to document how the measurements are handled. The probe itself has five pressure-sensing holes located on a hemispheric cap pointed into the wind. The pressure difference between the two ports located upward and downward from centerline, measured as ADIF\_GP, is used in the calculation of angle of attack. The similar pressure difference between the two ports located toward starboard and toward port of centerline, measured as BDIF\_GP, are used in the calculation of sideslip. In addition, the probe has static ports located on the side of the cylinder carrying the hemispheric cap, and the difference between the pressure at the forward port and that at the static ports is measured as the dynamic pressure QC\_GP. The static pressure is also measured, as PS\_GP.% % In addition, there is an inertial reference unit mounted with the gust pod to measure its attitude angles (roll, pitch, heading) and to measure the three components of motion of the aircraft relative to the Earth. This unit receives GPS information and uses it to update its measurements via a Kalman filter.

The measurements ADIF\_GP\sindex[var]{ADIF_GP>@ADIF\_GP} and BDIF\_GP,\sindex[var]{BDIF_GP>@BDIF\_GP} normalized by QC\_GP,\sindex[var]{QC_GP>@QC\_GP} are used with the calibrations in the preceding section to find the angle of attack and sideslip angle using only measurements from the gust pod. In addition, to find the relative wind, \index{airspeed!gust pod}a measurement of airspeed is needed. For the gust-pod system to operate as a completely independent measuring system, it is therefore desirable to determine the  airspeed directly from the gust-pod measurements. Because the ratio of dynamic to ambient pressure provided by the standard system (QCFC/PSXC)\sindex[var]{QCFC>@QCFC} has been calibrated to low uncertainty by reference to the laser air-motion sensor, that ratio will be used as a reference for the purpose of calibrating the gust pod. With this calibration, the gust-pod system still will measure wind without further reference to the standard system, but the calibration process links the two systems to have a common reference to the calibration of \citet{CooperEtAl2014}. 

Therefore, the next step needed to make the gust pod wind-sensing system independent of the standard wind-sensing system is to determine a functional relationship between gust-pod measurements and the airspeed. The approach taken is to fit the basic pressure ratio $q/p$ as measured by the 858 probe to match the corresponding pressure ratio provided by the conventional measurements of dynamic and static pressure, which incorporate corrections for the static defect. That ratio then can be used in the normal equations for airspeed (cf. \href{https://drive.google.com/open?id=0B1kIUH45ca5Ab2Z6cld1M1cydjA&authuser=0}{this document}) to determine the airspeed measured by the gust pod. 

For this purpose, all the measurements from the DEEPWAVE calibration flight (flight 15) were used qualified only by requiring TASF>130 m/s, absolute value of roll smaller than 5$^{\circ}$, and altitude above 5000~m. These restrictions were selected because the DEEPWAVE\index{DEEPWAVE!restrictions on gust-pod airspeed measurements} project mostly needed only such measurements and low uncertainty could only be obtained with some restrictions on the measurements. This is the first use of the gust-pod measurements, so for future projects and different research objectives this approach should be repeated with different restrictions.\footnote{An example applicable to low-level flight in presented in Appendix B, where an application to characterization of turbulence is discussed.} 



The measurements entering the resulting fit are as follows: $q$=QCFC\sindex[var]{QCFC>@QCFC} is the reference dynamic pressure\index{pressure!dynamic!corrected}, $p=$PSFC\index{pressure!ambient!corrected}\sindex[var]{PSFC=corrected ambient pressure {[}hPa{]}} is the reference ambient pressure,\sindex[lis]{qg@$q_{g}$=dynamic pressure, gust pod}\sindex[lis]{pg@$p_{g}$=ambient pressure measurement, gust pod} $q_{g}=$QC\_GP\sindex[var]{QC_GP>@QC\_GP} is the gust-pod dynamic pressure\index{pressure!dynamic!gust pod}, $p_{g}$=PS\_GP is the gust-pod static pressure\index{pressure!ambient!gust pod}, $M$ is the Mach number\index{Mach number} determined from the reference measurements, $M_{g}$ the Mach number determined from the gust-pod static and dynamic pressure, and\sindex[lis]{DeltaP@$\Delta p_{\alpha,g}$=gust pod pressure difference, bottom vs top} $\Delta P_{\alpha,g}$=ADIF\_GP\sindex[var]{ADIF_GP>@ADIF\_GP} is the pressure difference between top and bottom pressure ports on the gust-pod sensor. The following equation was found to provide a useful representation of the reference ratio $q/p$ in terms of quantities measured only by the gust-probe system: 

\begin{equation}
\frac{q}{p}=d_{0}+d_{1}\frac{q_{g}}{p_{g}}+d_{2}M_{g}\frac{q_{g}}{p_{g}}+d{}_{3}\left(\frac{q_{g}}{p_{g}}\right)^{2}+d_{4}\frac{\Delta p_{\alpha,g}}{q_{g}}+d_{5}M_{g}+d_{6}\left(\frac{\Delta p_{\alpha,g}}{q_{g}}\right)^{2}+d_{7}\frac{\Delta p_{\alpha,g}}{q_{g}}M_{g}\label{eq:TASfit}
\end{equation}
\index{airspeed!gust pod!fit equation and coefficients}
This complexity was needed to obtain a good fit (with residual standard deviation translating to a typical standard deviation in airspeed of about 0.5\,m/s for typical DEEPWAVE research legs), and all terms were indicated to be significant in the fit. The fit details are listed below: 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## lm(formula = B1 ~ B2 + BxM + I(B2^2) + AQR_GP + MachG + I(AQR_GP^2) + 
##     I(MachG * AQR_GP), data = DataV)
## [1] "Coefficients:"
##                   Estimate Std. Error t value
## (Intercept)         1.1940   0.031653   37.72
## B2                 27.2893   0.844564   32.31
## BxM               -29.0483   0.965719  -30.08
## I(B2^2)            13.6231   0.411740   33.09
## AQR_GP             -0.5936   0.004224 -140.54
## MachG              -7.5812   0.226389  -33.49
## I(AQR_GP^2)         0.1554   0.002811   55.27
## I(MachG * AQR_GP)   1.2607   0.007205  174.97
##                     Pr(>|t|)
## (Intercept)       3.365e-305
## B2                1.114e-225
## BxM               3.094e-196
## I(B2^2)           2.311e-236
## AQR_GP             0.000e+00
## MachG             5.543e-242
## I(AQR_GP^2)        0.000e+00
## I(MachG * AQR_GP)  0.000e+00
## [1] "Residual standard deviation: 0.002, dof=34524"
## [1] "R-squared 0.998"
\end{verbatim}
\end{kframe}
\end{knitrout}

%\begin{lyxcode}


\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-plot-qp-fit-1} 

}

\caption[The estimate of $q/p$ obtained from the right side of (\ref{eq:TASfit}), determined entirely from measurements provided by the gust pod, plotted against the standard measurement obtained from QCXC/PSXC.]{The estimate of $q/p$ obtained from the right side of (\ref{eq:TASfit}), determined entirely from measurements provided by the gust pod, plotted against the standard measurement obtained from QCXC/PSXC. The coefficients are listed in the text.}\label{fig:plot-qp-fit}
\end{figure}


\end{knitrout}

%\end{lyxcode}

The resulting fit, with coefficients \{$d_{0},\cdots d_{7}$\} as listed above, is shown in Fig.~\ref{fig:plot-qp-fit}. With this result for $G^{*}$ from (\ref{eq:TASfit}) used for $q/p$, the airspeed can then be obtained using the usual formula:\sindex[lis]{di@$d_{i}$=coefficients for fit representing the gust-pod airspeed}\sindex[lis]{cp@$c_{p}$=specific heat of moist air at constant pressure}\sindex[lis]{cv@$c_{v}$=specific heat of moist air at constant volume}\sindex[lis]{Ra@$R_{a}$=gas constant for moist air}\sindex[lis]{Gstar@$G^{*}$=gust-pod fit for q/p} 

\begin{equation}
V=\sqrt{2\left(\frac{(c_{p}-R_{a}}{R_{a}}\right)\left(1+G^{*}\right)^{\frac{R_{a}}{c_{p}}-1}\left(\frac{c_{p}}{c_{v}}R_{a}T_{a}\right)}\label{eq:TASformula} 
\end{equation}
where $c_{p}$, $c_{v}$, and $R_{a}$ are respectively the specific heat of air at constant pressure, the specific heat of air at constant volume, and the gas constant for air. In this equation, $T_{a}$ is the absolute temperature.\sindex[lis]{Ta@$T_{a}$=temperature, absolute units} 

The resulting airspeed is compared to the conventional measurement TASF\sindex[var]{TASF=true airspeed from the fuselage-mounted pitot tube} in Fig.~\ref{fig:TAS-from-the-gust-pod-2}. The fit provides a reasonable representation of airspeed, with a residual standard deviation of about 0.4\,m/s. This is not much larger than the estimated uncertainty in the standard measurement of airspeed (about 0.3\,m/s), so wind calculations might be based on this value from the gust pod if necessary. However, there is serious danger of over-fitting with this many coefficients and variables, even though the fit was improved significantly with each addition; indeed, the residual standard deviation in the $q/p$ fit was reduced by 50\% with the addition of the last two variables in the fit. Because of the danger that this variable might not perform as well when  used outside the range of this fit (which was TASF > 130, |ROLL|\sindex[var]{ROLL>@ROLL} < 5, and GGALT\sindex[var]{GGALT>@GGALT} > 5000),  it still should be better to base wind measurements from the gust pod on the  conventional measurement of airspeed (TASF)\sindex[var]{TASF>@TASF} combined with the relative-wind angles from the gust pod. However, if it is desirable to have a wind measurement that is completely independent of the standard radome-based system, using airspeed measured with this fit might provide a useful alternative.\footnote{For two DEEPWAVE\index{DEEPWAVE!obstructed radome} flights (flights 6 and 7) where the standard vertical wind measurement was compromised by an obstruction in the pressure-sensor lines of the radome, the best vertical wind will be that calculated using (\ref{eq:AOAGfunction}) for the angle of attack but conventional TASF\sindex[var]{TASF>@TASF} for the airspeed, because the pressure ports used to determine TASF were not obstructed.\index{wind!gust pod!using TASF for airspeed}} 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-TAS-from-the-gust-pod-2-1} 

}

\caption[True airspeed obtained from the gust pod, plotted against corresponding measurements from the conventional measurement system (TASX)]{True airspeed obtained from the gust pod, plotted against corresponding measurements from the conventional measurement system (TASX)}\label{fig:TAS-from-the-gust-pod-2}
\end{figure}


\end{knitrout}



%\vfill\eject

\subsection{Summary of sensitivity coefficients\label{sub:CalSummary}}


\subsubsection{Angle of Attack}

Radome: Eq.~(\ref{eq:AOArecommended}), coefficients $c_{0,1}$ =\{4.468$^{\circ}$, 
21.481$^{\circ}$\}.\footnote{See also the alternative coefficients \{4.435$^{\circ}$, 21.166$^{\circ}$\} discussed on page \pageref{coefficients-aoa-all-flt}.}\\ Gust pod: Eq.~(\ref{eq:AOAGfunction}), coefficients\{$b_{i=0,3}$\} = \{\ensuremath{-0.903}$^{\circ}$, 3.602$^{\circ}$, 
4.286$^{\circ}$, 1.330$^{\circ}$\}\footnote{See also the alternative coefficients \{\ensuremath{-0.808}$^{\circ}$, 3.248$^{\circ}$, 5.351$^{\circ}$, 1.282$^{\circ}$\} discussed on page \pageref{aoa-coefficients-GP-all-flt}.}


\subsubsection{Sideslip Angle\label{CalSSsummary}}
\begin{hangparagraphs}
Radome and gust pod: Eq.~(\ref{eq:betaFunctionForm}), coefficients% 
\{$e_{0}$, $e_{1}$\} = \\% 
%% note the forward reference to dbm, which should be changed if it
%% changes in Sect. 7.
\qquad{} \{0.008$^{\circ}$, 22.302$^{\circ}$\} for the radome,% 
\footnote{This incorporates the revision of the first coefficient that follows in Section \ref{sub:HWsummary}.}\\% 
\qquad{} \{\ensuremath{-3.621}$^{\circ}$, 12.184$^{\circ}$\} for the gust pod.% 
\end{hangparagraphs}

\subsubsection{True Airspeed, Gust Pod}
\begin{hangparagraphs}
Equation (\ref{eq:TASformula}), with (\ref{eq:TASfit}) and dimensionless coefficients% 
\{$d_{i=0,7}$\} = \\% 
\qquad{} \{1.194, 27.2893, \ensuremath{-29.0483}, 13.6231, \ensuremath{-0.5936}, \ensuremath{-7.5812}, 0.1554, 1.2607\}.% 
\end{hangparagraphs}

% \end{document}



\section{Studies of the Vertical Wind\label{sec:vertical-wind}}

\subsection{Overview}

The preceding sections provided extensive information on how vertical wind is measured and how the radome-based system is calibrated. Here, three additional topics not covered well there are discussed to complement those earlier discussions. The sections here deal with the choice and quality of the variable characterizing the vertical motion of the aircraft,\index{rate of climb}\index{velocity!aircraft!vertical}\index{speed of aircraft!vertical} some issues related to the relative timing\index{timing of measurements} of the measurements entering the calculation of vertical wind, and a proposed method for using detection of the Schuler\index{Schuler oscillation|see {oscillation, Schuler}}\index{oscillation!Schuler} oscillation of the IRU\index{inertial reference unit} to correct the measurement of pitch.\index{pitch!correction} 


\subsection{The vertical velocity of the aircraft\label{sec:VerticalVelocity}}


\subsubsection{Available measurements}

There are several independent measurements of the vertical motion of the aircraft:\index{velocity!aircraft!available measurements}\sindex[var]{VSPD>@VSPD}\sindex[var]{VSPD_A=vertical motion of the aircraft as provided by the avionics  system@VSPD\_A=vertical motion of the aircraft as provided by the avionics system}\sindex[var]{GGVSPD}\sindex[var]{CVSPD_GP>@CVSPD\_GP}\sindex[var]{CVSPD_LAMS>@CVSPD\_LAMS}\sindex[var]{VSPD_G@VSPD\_G=alternate name used for VSPD\_A in some projects}\sindex[var]{WP3=obsolete vertical-motion variable calculated using baro-inertial updating}\index{baro-inertial updating} 

\noindent \begin{center}
\begin{tabular}{|c|c|}
\hline 
\textbf{Variable}  &
\textbf{Source}\tabularnewline
\hline 
\hline 
VSPD\sindex[var]{VSPD>@VSPD}  &
Honeywell IRU\tabularnewline
\hline 
VSPD\_A\sindex[var]{VSPD_A>@VSPD\_A}  &
Avionics system (Honeywell IRU)\tabularnewline
\hline 
GGVSPD\sindex[var]{GGVSPD>@GGVSPD}  &
GPS receiver, possibly with OmniSTAR corrections\tabularnewline
\hline 
CVSPD\_GP\sindex[var]{CVSPD_GP>@CVSPD\_GP}  &
C-MIGITS\sindex[var]{C-MIGITS>@C-MIGITS} IRU, gust pod\tabularnewline
\hline 
CVSPD\_LAMS\sindex[var]{CVSPD_LAMS>@CVSPD\_LAMS}  &
C-MIGITS IRU, LAMS pod\tabularnewline
\hline 
\end{tabular}
\par\end{center}

In standard processing, the nimbus subroutine ``gust''\index{nimbus!gust.c}\index{gust.c}
calculates wind via the algorithm described in Sect.~\ref{sub:General-comments}.
The standard vertical wind calculation depends on a measurement of
vertical motion of the aircraft. Past projects have used one of VSPD\sindex[var]{VSPD>@VSPD}
(from the IRU), VSPD\_A,\sindex[var]{VSPD_A>@VSPD\_A} VSPD\_G or GGVSPD\sindex[var]{GGVSPD>@GGVSPD} (from GPS, the first two
alternate names for the value provided by the avionics package) or,
much earlier, WP3 from a baro-inertial update loop using VSPD. Baro-inertial
updating is no longer used because the Honeywell IRU that now provides
VSPD\sindex[var]{VSPD>@VSPD} already incorporates such updating. For the systems based on
the gust pod or LAMS, additional vertical-velocity measurements are
provided by their pod-mounted IRUs, respectively CVSPD\_GP\sindex[var]{CVSPD_GP>@CVSPD\_GP} and CVSPD\_LAMS.\sindex[var]{CVSPD_LAMS>@CVSPD\_LAMS}
Changing roll of the aircraft can cause these measurements to differ
from the fuselage-based measurements.

Because the measurement VSPD\sindex[var]{VSPD>@VSPD} provided by the Honeywell IRU is controlled against the known instability of IRU measurements in the vertical by updating to a reference value provided by pressure altitude,\index{baro-inertial updating} it has some drawbacks. Pressure altitude (cf.~the RAF Technical Note on \href{https://drive.google.com/open?id=0B1kIUH45ca5Ab2Z6cld1M1cydjA&authuser=0}{Processing Algorithms}, Sect.~3.3) is not a measure of altitude but rather of pressure, so the reference altitude can be biased for flight legs where altitude changes on a constant-pressure surface. Also, the characteristics of the IRU-imposed baro-inertial loop are considered proprietary by the manufacturer and so have unknown response characteristics and uncertainty, and the value provided by the IRU\index{inertial reference unit!filter} has inherent filtering. The advantage of an IRU variable over a GPS\index{Global Positioning System} measurement has been, until recently, better response at high frequency at the expense of absolute accuracy. GPS measurements have now improved, esp.~with OmniSTAR,\index{OmniSTAR} so it is worth considering what variable or combination of variables should be used in the calculation of vertical wind. 

For horizontal wind, the standard solution in use since the early 1990s has been a complementary-filter solution\index{filter!complementary} (discussed in Sect.~\ref{sub:comp-filter}), where the difference between IRU and GPS measurements is low-pass filtered and the result is added to the IRU measurement. This preserves the high-frequency response of the IRU-provided measurement but causes the low-frequency components to match the GPS measurements, thus providing both absolute accuracy and valid high-frequency measurements. It seems worthwhile to explore a similar approach for the vertical wind, to see if there is an advantage to a variable that is provided by an analogous complementary filter.  \footnote{In the course of the study discussed here, an additional variable
GGVSPDB\sindex[var]{GGVSPDB=high-resolution version, GGVSPD} was
sometimes used. That variable is a higher-resolution version of GGVSPD,
but there appeared to be no advantage to using that variable, so GGVSPD
is used in the analysis presented here. It has sufficient resolution,
so there appears to be no advantage to using the higher-resolution
variable.}

In standard processing, two vertical-wind variables are produced from
the radome-based system, WI\sindex[var]{WI=vertical wind calculated using VSPD {[}m/s{]}}
and WIC\sindex[var]{WIC=vertical wind calculated using GGVSPD {[}m/s{]}}.
In archived data files, these have been called, respectively, ``Wind Vector, Vertical Gust Component''
and ``GPS-Corrected Wind Vector, Vertical Gust Component''.%
\footnote{The names are not really appropriate and may therefore be changed in the future, but they
appear in many past datasets. Neither is the gust component; both
are the full vertical wind including relative wind and aircraft motion.
Also, WIC is not GPS-corrected, it is completely based on the GPS
and does not use the IRU at all except for the attitude angles needed
to determine the relative wind (the same for both).}
They are calculated by adding the relative wind measured by the radome
system to the vertical motion of the aircraft, the latter from either VSPD\sindex[var]{VSPD>@VSPD} (WI) or
GGVSPD\sindex[var]{GGVSPD>@GGVSPD} (WIC). The former is directly from the Honeywell IRU; the latter
is produced by the GPS receiver and may benefit from OmniSTAR accuracy
(flagged by GGQUAL\sindex[var]{GGQUAL=variable indicating GPS quality of measurement; 5 if OmniSTAR} equal to 5).%
\footnote{In addition, the Honeywell\index{IRU!Honeywell} IRU provides a measurement of vertical acceleration. In a special calculation, this was integrated to get velocity and the result compared to VSPD.\sindex[var]{VSPD>@VSPD} It was hoped that some of the filtering imposed on VSPD could be avoided, but the results of that integration and the variance spectrum of that result were quite similar to VSPD, provided that a feedback loop was used to avoid exponentially growing errors from positive feedback, so there is no advantage to using that integrated acceleration in place of VSPD.\sindex[var]{VSPD>@VSPD}}%



\subsubsection{Variance spectra for components affecting the vertical wind\label{sub:Variance-spectra-for-W-components}}

\index{variance spectrum!vertical wind components}
For evaluation of these measurements of aircraft velocity, it is useful to compare the variance spectra to evaluate the contribution each makes to the vertical wind. For this purpose, one flight from DEEPWAVE\index{DEEPWAVE!flight 16}, RF16 (4 July 2014), was used because it provided a good example of relatively intense and prolonged vertical motion, with the core 6 h period of the flight from 6:30:00 -- 12:30:00~UTC having a standard deviation in vertical wind of 1.0\,m/s. Much of the variation in vertical wind was from waves, so the field was not fully developed turbulence, but the signals to be resolved had enough intensity that noise\index{noise!DEEPWAVE flights} floors on the measurements were not a problem. 

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=0.9\textwidth]{SpecialGraphics/VSPDspectraDW16.pdf}  
\par\end{centering}

\protect\caption[Variance spectra for various components entering vertical-wind calculations.]{\label{fig:Variance-spectra-VSPD}Variance spectra {[}units: m$^{2}$s$^{-2}$, density functions per logarithmic interval in frequency expressed in Hz{]} for various components entering vertical-wind calculations. Data are from DEEPWAVE flight 16, 6:30:00--12:30:00 UTC. The thick blue trace is that for the vertical wind variable WIC; others show either measurements of the aircraft vertical motion (VSPD, GGVSPD) or, as GUSTW, the relative-wind contribution to WIC. The green diagonal lines show the slope expected\index{inertial subrange} for an inertial subrange; the thicker green line labeled ``!0$^{-4}$'' corresponds to the spectrum expected for an eddy dissipation rate\index{eddy dissipation rate} of $1\times10^{-4}$\,m$^{2}$s$^{-3}$. Other green reference lines are displaced by an order of magnitude in eddy dissipation rate. The calculations are based on the all-poles or maximum-entropy method, with 100 poles; cf.~\citet{Press:1992:NRC:148286}. The resolution used was 0.0005, with results smoothed in 50 bins in the logarithm of frequency. Total variance in WIC is 1.36\,m$^{2}$s$^{-2}$.} 
\end{figure}
\sindex[var]{VSPD>@VSPD}\sindex[var]{GGVSPD>@GGVSPD}\sindex[var]{GUSTW>@GUSTW}

Figure \ref{fig:Variance-spectra-VSPD}\index{variance spectrum!vertical wind components} shows variance spectra calculated for the entire 6-h period, for a number of measurements entering the vertical-wind calculations.\footnote{This plot is an exception to the goals of \textquotedbl{}reproducible analysis\textquotedbl{} explained in the introduction and in Appendix C. The calculations used an external spectral-analysis program, not R code, and the specific data are not part of the data archive for the document. See Appendix B for more information on the method used to calculate these variance spectra.}The thick blue trace shows the spectrum for the standard vertical wind measurement WIC,\index{spectral variance@WIC} which has a pronounced broad peak near 10 km wavelength, a relatively small inertial subrange extending only to about 2 km, and (after smoothing in 50 logarithmic intervals across the range of the plot) uncertainty estimates that range from about 5\% at the lowest frequencies to <1\% at the highest frequencies. 

The two measures of vertical aircraft motion, GGVSPD\sindex[var]{GGVSPD>@GGVSPD} (from the GPS receiver) and VSPD\sindex[var]{VSPD>@VSPD} (from the inertial reference unit), have important differences in their properties. At high frequency, VSPD (orange line) decreases rapidly with increasing frequency, so it makes negligible contribution to the vertical wind (WI) at frequencies above 1 Hz. In contrast, GGVSPD (red line) does not show a similar steep drop in variance until after about 2 Hz, and it continues to make an important contribution to WIC over the frequency range from about 0.3 to 3\,Hz. The absence of spectral variance above about 0.3\,Hz in VSPD\sindex[var]{VSPD>@VSPD} appears to be the result of internal filtering of this signal in the inertial unit, and indeed some limited information on the properties of the signals does indicate filtering at about this frequency. Because the aircraft motion clearly has components in this frequency range (based on the feel of the ride in turbulence), it appears that WI\index{WI!recommendation against use} should not be used for frequencies above about 0.3\,Hz, because part of the high-frequency signal is missing from this variable. It may be removed from future data archives.

As discussed above, the inertial-system variable VSPD\sindex[var]{VSPD>@VSPD} is also subject to pressure damping, and this may account for the difference between GGVSPD\sindex[var]{GGVSPD>@GGVSPD} and VSPD at long wavelength. The aircraft normally flies with reference to pressure altitude, so in a region of varying altitude at a given pressure there are fluctuations in the aircraft geometric altitude (red line) not reflected in the pressure altitude (orange line). Both contribute in ways that result in essentially the same spectral variance for frequencies below 0.3 Hz, as shown by the near coincidence of the blue and cyan lines.

For these reasons, WIC\index{WIC!recommended variable}\sindex[var]{WIC>@WIC} is the preferable variable to use for vertical wind. This also answers the question posed earlier regarding the possibility of using a combination of measurements from inertial and GPS systems to obtain better frequency response. The IRU measurements have poorer frequency response and lead to apparent biases for frequencies around 1\,Hz, so this is not a useful combination. Instead, it appears best to use the GPS-provided measurement of vertical aircraft speed directly without further modification. 

There is still some reason for concern about the spectral response of GGVSPD\sindex[var]{GGVSPD>@GGVSPD} at frequencies around 0.5--1\,Hz, because there is no evidence that the GPS is providing valid response at this high rate.\index{variance spectrum!concern re GPS variable GGVSPD} The GPS unit provided measurements at 5\,Hz and these measurements were interpolated and filtered to higher frequency, so the cut-off apparent in Fig.~\ref{fig:Variance-spectra-VSPD} is a result of that sampling because GGVSPD as sampled cannot provide useful measurements above the Nyquist frequency of 2.5~Hz. This topic will be reconsidered in Appendix B, where variance spectra in more turbulent regions are examined. 

The black trace (labeled GUSTW) is the vertical component of the relative wind, calculated as in Sect.~\ref{sub:The-Relative-Wind}. The sum of GUSTW\sindex[var]{GUSTW=special-use variable representing the relative wind {[}m/s{]}} and GGVSPD\sindex[var]{GGVSPD>@GGVSPD} determines WIC, and the alternate measure of vertical wind WI is the sum of GUSTW and VSPD\sindex[var]{VSPD>@VSPD} from the inertial reference unit. GUSTW has higher spectral variance than WIC for frequencies below 0.3\,Hz, so at these frequencies the aircraft motion tends to counter the relative wind and reduce the measured variance. This results in close correspondence of the gust-component GUSTW and the vertical aircraft motion GGVSPD\sindex[var]{GGVSPD>@GGVSPD} from about 0.07--0.2~Hz, resulting in a vertical wind WIC that is much smaller than either of these contributing components. On the other hand, for frequencies around about 0.5\,Hz the spectral variance in the vertical wind exceeds that in the relative wind, showing that the aircraft responds to the vertical gusts only partially and about in phase at this frequency. 

The high-frequency variance spectrum has a slope differing a small amount from the expected -5/3 spectrum, and that is cause for some concern, but the turbulence in this region was not very well developed or consistent. Very good agreement with expectations has been seen in cases of boundary-layer measurements where inertial-subrange turbulence at small scales is expected, but in those cases the turbulence at small scales was also more intense. This and the absence of a valid measurement of aircraft response above 2.5\,Hz are reasons to continue to be suspicious of the response around 0.5--1\,Hz, but additional variance spectra presented in Appendix B appear to conform to the expected -5/3 slope  better than this example does. %The gust-pod spectrum actually looks better, closer to -5/3 and% lying a little lower in spectral variance. 
%The gust-pod spectrum actually looks better, closer to -5/3 and
% lying a little lower in spectral variance.

The key conclusions reached from this study of the vertical aircraft velocity are that WI, based on VSPD,\sindex[var]{VSPD>@VSPD} is an inferior measurement that should not be used and that GGVSPD\sindex[var]{GGVSPD>@GGVSPD} is the best available measure of aircraft vertical motion and should be the basis for wind calculations.

%Although some of the relative magnitudes shown in Fig.~\ref{fig:Variance-spectra-VSPD} may change for different intensities of turbulence, some tentative conclusions seem indicated by this figure and the discussion above:  
%\begin{enumerate}
%\item  
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=0.9\textwidth]{WIxpectra} 
% \par\end{centering}
% 
% \protect\caption{\label{fig:WIWICcomparison}Variance spectra for vertical-wind variables
% WI and WIC, from DEEPWAVE flight 16, 4 July 2014, 6:30:00--12:30:00. }
% \end{figure}
% 
%The variable WI\index{WI!recommendation against use}\sindex[var]{WI} should be excluded from future data archives. VSPD\index{VSPD!recommendation against use}, on which WI is based, has problems at both high and low frequency. Providing this variable could lead to the mistaken expectation that this is the uncorrected version of WIC, while the two variables actually use different and independent measurements of the vertical motion of the aircraft. The argument for using a variable based on VSPD has been that this formerly represented the high-frequency contribution better than a GPS variable. That is not the case any longer, because GPS measurements have improved greatly and the presently available IRU-provided measurements are obviously filtered at high frequency. 
% Fig.~XXX shows that, while
% the variance spectra of WI and WIC are reasonably similar, the WI
% spectrum is above that for WIC for frequencies from about 0.007--0.3
% Hz, with WI often 30\% higher, and then falls below the WIC spectrum
% above 0.3 Hz. The high-frequency decrease in WI is apparently attributable
% to the drop in VSPD at high frequency, thought to be from imposed
% filters in the IRU providing this variable. WIC is reasonably consistent
% with a -5/3 spectrum for frequencies above 0.1 Hz, while WI is not.
% The difference in magnitude between 0.01--0.1 Hz is not evident: The
% variance spectra from VSPD and GGVSPDB have the same magnitude, coherence
% near unity and phase near zero, through this range. This needs further
% investigation unless the variable WI is no longer produced. 

%\item VSPD does not have better frequency response than GGVSPD\sindex[var]{GGVSPD}  at high frequency, as might be expected; the reverse is the case, possibly because of filters imposed on VSPD in the inertial unit itself. This argues for direct use of GGVSPD in the vertical-wind calculation, at least when OmniSTAR\index{OmniSTAR} corrections are available.  
%\item The relative-wind variance spectrum shows higher variance than does that of the vertical wind, indicating that the contribution from aircraft motion counters the relative-wind contribution at all but the highest frequencies. The variable GGVSPD is close to 180$^{\circ}$ out-of-phase with the relative wind (GUSTW in Fig.~\ref{fig:Variance-spectra-VSPD}) for frequencies smaller than 0.2\,Hz. At low frequency, the aircraft is flown to maintain altitude and so to counter any vertical wind, so these altitude adjustments and any other adjustments made while maintaining altitude contribute to the relative-wind spectrum but not to the net measurement of vertical wind. 
%the motion of
%the aircraft probably produces more of the measured
%vertical component of the relative
%wind than does the real wind, while
% At intermediate frequency (near 0.1 Hz) the aircraft 
%perhaps
%responds to the vertical wind so as to move out-of-phase with it, exaggerating the measured vertical component of the relative wind. There is a transition in phase from being above 180$^{\circ}$ to being below 180$^{\circ}$ as the frequency increases through 0.05\,Hz, perhaps representing a transition from where the pilots or autopilot cause motions that produce the relative-wind vertical component to where the vertical wind causes the aircraft response.  
%\item At high frequency (>0.3 Hz), the gust component dominates over the aircraft response, the coherence between them falls to values between 0.1--0.5, and the phase relationship becomes variable before settling near zero at 0.5 Hz.  
%\end{enumerate}

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=0.9\textwidth]{SpecialGraphics/WIXHR1.png}  
\par\end{centering}

\protect\caption[Variance spectra for the vertical wind and for the contributions made by the relative wind and the aircraft motion.]{\label{fig:WIXHR1}Variance spectra for the vertical wind (here, WIX) and for the contributions to it made by the relative wind (GUSTW) and the aircraft motion (GGVSPDB, essentially the same as GGVSPD). Also shown for comparison is the spectrum for the IRU-provided aircraft motion (VSPD, dashed line). Data from DEEPWAVE flight 15, 3:40:00--3:55:00.} 
\end{figure}
\sindex[var]{VSPD>@VSPD}\sindex[var]{GGVSPD>@GGVSPD}\sindex[var]{WIX>@WIX}

An example\index{variance spectrum!low-turbulence case}\index{DEEPWAVE!flight 15} where there was very low turbulence is shown in Fig.~\ref{fig:WIXHR1}.\sindex[var]{WIX=vertical wind, special calculation (e.g., recalculated with pitch correction)} The intensity of vertical-wind fluctuations was quite small for this flight segment, with a standard deviation in vertical wind of only about 0.2 m/s. Some features of this plot, presented here because the noise\index{noise!low-intensity turbulence} characteristics reveal limits to some of the uncertainties entering calculation of the vertical wind, are explained below:  
\begin{enumerate}
\item The measured vertical wind at high frequency (>1\,Hz) is a white-noise spectrum\index{variance spectrum!white noise}\index{noise!white} with intensity that can be matched by generating a random-noise signal with peak amplitude of 0.15--0.2 m/s, which would lead to a random error of about (0.15--0.2)/$\sqrt{12}\simeq0.05$~m/s. The noise\index{variance spectrum!noise in} is dominated by the relative-wind contribution; there is essentially no contribution at these frequencies from the motion of the aircraft. The noise arises almost entirely from the angle-of-attack contribution to the relative wind, and specifically from the measurements ``ADIFR''\sindex[var]{ADIFR>@ADIFR} and ``QCF'',\sindex[var]{QCF>@QCF} which exhibit noise spectra\index{noise!ADIFR}\index{noise!QCF} for frequencies above 1~Hz. In ADIFR, the noise is at a level that would arise from a white-noise signal with peak amplitude of 0.4~hPa or a random error of about 0.1~hPa.\footnote{This was verified by simulation.} \label{page:ADIFRnoise}Similar noise\index{noise!QCR} is present in both QCR\sindex[var]{QCR>@QCR} and QCF\sindex[var]{QCF>@QCF}, but QCF has additional problems at high frequency as discussed in Appendix B that may arise from the long pressure lines used with the transducer for QCF. The specifications for the pressure transducer that measures ADIFR\sindex[var]{ADIFR>@ADIFR} assert a standard uncertainty of about 0.07 hPa. As sampled and digitized by the data system the resolution is about 0.002 hPa ($\pm70\,$hPa for $2^{16}$ range digital encoding), which is comparable to the specified sensor resolution, so noise\index{noise!digitization} arising from digitization would be much less intense than the measured noise distribution. Thus the white-noise spectrum is consistent with a random error of about the specified uncertainty for the sensor,\index{noise!ADIFR} but this is not the result of digital truncation. 

% \item GGVSPDB as plotted here was obtained by interpolating linearly between
% 1-Hz measurements and then applying a low-pass filter with cutoff
% frequency 1 Hz. Simple linear interpolation leads to a pronounced
% peak at 1~Hz and peaks also at 2, 4, ... Hz, so some better interpolation
% procedure is useful. Smoothing with Savitzky-Golay polynomials with
% a 25-point span might be best%
% \footnote{A test of this with 4th-order Savitzky-Golay polynomials spanning
% 25 points produced a signal without the phase shift that arises with
% a Butterworth filter near the cutoff frequency.%
% }, but that can't be done in the conventional processing chain of nimbus
% which necessarily handles data second-by-second. {[}XXX check what
% is actually done for filtering and if a higher-rate is available for
% GGVSPDB.{]} VSPD (from the IRU), on the other hand, is present in
% the 25-Hz data files at 25 Hz, but it either has already been filtered
% in the IRU or simply reflects, with GGVSPDB, the absence of contributions
% from aircraft motion at these frequencies. It falls below even filtered
% GGVSPDB, though, so it probably doesn't represent any real signal
% at frequency above about 1 Hz. 
\item The relative-wind contribution (GUSTW) and the aircraft-motion contribution (GGVSPD)\sindex[var]{GGVSPD>@GGVSPD} both have peaks at about 0.05\,Hz, with canceling contributions so that no peak occurs at that frequency in the resulting vertical wind. These peaks arise from a basic dynamical flight mode of an aircraft called a phugoid,\index{phugoid} in which altitude, airspeed, and pitch all undergo oscillations that are tracked by the flight management system (FMS)\sindex[var]{FMS=flight management system} of the aircraft \sindex[var]{FMS=flight management system} but are not completely removed by it. The angle of attack also oscillates but with smaller amplitude. A regular oscillation with this period is quite evident in Fig.~\ref{fig:phugoid-plot}\index{oscillation!in aircraft altitude}\sindex[var]{AKRD>@AKRD} and is especially visible in calm flight conditions where it also manifests itself in small oscillating adjustments to the throttle positions by the FMS. A properly operating wind sensing system should remove this motion from the measured vertical wind, and indeed that is the case for the example shown.

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-phugoid-plot-1} 

}

\caption[Coupled variations in pitch, altitude, and airspeed for a segment of flight in smooth air, illustrating normal variations in flight conditions.]{Coupled variations in pitch, altitude, and airspeed for a segment of flight in smooth air from DEEPWAVE flight 15, 3:40:00--3:45:00~UTC, an illustration of normal variations in flight conditions. GGALT = aircraft altitude; PITCH = pitch angle; AKRD = angle of attack; TAS = airspeed.}\label{fig:phugoid-plot}
\end{figure}


\end{knitrout}

%\begin{figure}
%\noindent \begin{centering}
%\includegraphics[width=0.8\textwidth]{30_home_cooperw_RStudio_DEEPWAVE_WindUncertainty_GGALTB.png}  
%\par\end{centering}
%
%\protect\caption{\label{fig:AltOscillationFMS}The GPS-measured altitude {[}m{]} during a flight segment in very smooth air. Data from DEEPWAVE flight 15, 3:40:00 to 3:45:00 UTC, variable GGALTB.} 
%\end{figure}

\item The disagreement between VSPD\sindex[var]{VSPD=vertical aircraft speed provided by the primary IRU} and GGVSPD\sindex[var]{GGVSPD>@GGVSPD} even at low frequency is another indication that the IRU-provided value (VSPD) should not be used, because the GPS-measured value at low frequency is surely a better measurement than is possible from the IRU. (OmniSTAR\index{OmniSTAR} corrections were present throughout this flight.)  
\item The difference between WIC and GUSTW near 0.3~Hz, seen also as a possible effect in Fig.~\ref{fig:Variance-spectra-VSPD}, indicates that both the relative wind and the aircraft motion are making contributions that add at these frequencies. The spectrum of vertical wind here may be suspect because it is not clear if the amplitude of this contribution from the GPS measurements should be trusted at these frequencies. 
\end{enumerate}

\subsection{Timing of measurements\label{sub:Timing}}

\index{timing of measurements}
The different measurements entering the calculation of vertical wind should be sampled at the same time. That is particularly difficult in the case of samples from the inertial reference unit and GPS because they produce sample streams according to their own timing and not in response to requests from the aircraft data system. The variables involved in calculating the vertical wind are:  
\begin{itemize}
\item Angle of attack (AKRD),\sindex[var]{AKRD>@AKRD} measured using transducers attached to small ports in the radome. No lag is used in processing.\index{attack!angle of!timing} The specifications for the transducer indicate that it will introduce a lag of about 21\,ms and has a response time of 50\,ms. However, the sensing ports are located about 4.4~m ahead of the primary IRU, which at typical flight speed of about 220 m\,s$^{-1}$ would lead to angle-of-attack measurements leading measurements from the IRU by about 20\,ms. 
An additional delay can be caused by the pressure line connecting the radome pressure ports to the transducer than measures the pressure difference, but
evaluations presented in Appendix B indicate that this delay is only a few ms. The best assumption should be to use zero lag for AKRD.\index{time lag!AKRD}\sindex[var]{AKRD>@AKRD}
\item Pitch\index{pitch!timing}\index{timing!pitch} (PITCH)\sindex[var]{PITCH>@PITCH} measured by the IRU and transferred to the aircraft data system after some delay that must be removed in processing. Standard processing has used a delay of $-60$~ms; i.e., the measurement is moved in time so as to apply to a time \emph{earlier} than when it was received. However, the IRU specifications indicate that this is a maximum delay and the actual delay may be much smaller.
\item Other attitude angles (heading and roll), which enter in minor ways if the aircraft is not flying a straight-and-level course. The timing of these can probably be neglected for calculations of vertical wind, but the standard variables are also given a time lag of $-60$~ms. As for pitch, this is a maximum value and actual delays may be much smaller.\index{timing!heading}\index{timing!roll}
\item Airspeed (TASF),\sindex[var]{TASF>@TASF} measured using the pitot-tube measurement of dynamic pressure and a measurement of temperature. While conventionally no lag is assumed for dynamic pressure,\index{timing!QCF} the sensor specifications indicate that a 21\,ms lag should be present. The pitot port is located about 3~m ahead of the IRU, so the resulting time difference of about 14\,ms partially compensates for this delay. In addition,
the analysis summarized in Appendix B suggests that the relatively long pressure lines involved in the measurement of dynamic pressure might introduce a
),lag that varies from 28~ms at total pressure of 1000~hPa to 38~ms at a total pressure of 100~hPa. Therefore an appropriate delay time for dynamic pressure is approximately $-40$~ms. The sensor used for measurement of total temperature (RTRL\sindex[var]{RTRL=recovery temperature, left-radome sensor} for DEEPWAVE)\index{DEEPWAVE!reference temperature} has a response time of about 1~s or more, but no delay is used in processing. Because airspeed affects the measurement of vertical wind only as a multiplicative factor (cf.~\eqref{eq:VWind}), changes of even a few percent in airspeed or temperature have only insignificant effects on the vertical wind, so these time lags are unimportant here.
\item The vertical speed of the aircraft, measured using the preferred vertical wind variable GGVSPD\sindex[var]{GGVSPD>@GGVSPD} produced by the Novatel GPS receiver employing OmniSTAR corrections when possible. This variable was only sampled at a rate of 5~Hz in the DEEPWAVE project, and no time lag is used in processing because these measurements are accompanied by a recorded time tag that allows for their correct placement relative to GPS-derived time. The aircraft shows little motion at high frequency, as discussed in Sect.~\ref{sub:Variance-spectra-for-W-components}, so small adjustments in GGVSPD are not needed.\index{timing!GGVSPD}

\end{itemize}
It is useful to try to determine appropriate lags from the data and from appropriate maneuvers. For example, in pitch maneuvers (in which the pitch is alternately increased and decreased with typically a 10-s period) if the timing of measurements of pitch and angle of attack are not matched or if the measurement of vertical speed of the aircraft is not timed correctly there will be a residual measured vertical wind, so these maneuvers are particularly stringent tests of the relative timing of the signals.





An approximate formula for the vertical wind\index{wind!vertical!first-order equation} $w$ (cf.~\eqref{eq:VWind}) is
\begin{equation}
w=V\sin(\alpha-\theta)+w_{p}\label{eq:Weq} 
\end{equation}
where $V$ is airspeed, $\alpha$ is angle of attack, $\theta$ is pitch and $w_{p}$ is the vertical velocity of the aircraft. This equation can be used to adjust relative timing among the signals to minimize the variance in vertical wind during the pitch maneuvers. A good example is that from DEEPWAVE\index{DEEPWAVE!flight 15} flight 15, 4:25:30--4:28:30 UTC. As initially processed using standard processing at the time of DEEPWAVE, the standard deviation in vertical wind through the pitch maneuvers was 0.4~m/s while the variance in vertical motion of the aircraft was 5.6~m/s. A long-standing criterion used by NCAR/RAF to check for acceptable pitch maneuvers is for less than 10\% of the imposed velocity to enter the vertical wind, so by this criterion the test was successful. However, a plot of the vertical wind shows a clear match to the imposed velocity, so it is worthwhile to see if better results are possible.\footnote{Speed runs have been used to determine the sensitivity coefficients for determining $\alpha$ from the measured pressure differences on the radome, so the sensitivity coefficients should not be adjusted on the basis of the pitch maneuvers.}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-plot-shifted-vertical-wind-1} 

}

\caption[Vertical wind measured during pitch maneuvers]{Vertical wind measured during pitch maneuvers. The variable GGVSPD is the vertical speed imposed on the aircraft during the pitch maneuver, shown here after division by 10, and WIX shows the resulting measurement of vertical wind after introducing the 40\,ms time shift discussed in the text. The dashed orange lines denote limits of $\pm$0.5\,m/s. Data from DEEPWAVE flight 15.}\label{fig:plot-shifted-vertical-wind}
\end{figure}


\end{knitrout}

The relative timing of the measurements entering \eqref{eq:Weq} can be adjusted to reduce the residual fluctuations in vertical wind. 
The timing of the measurement of pitch ($\theta$) relative to that of angle of attack ($\alpha$) is the most important. The lowest standard deviation in vertical wind resulted from shifting the measured pitch ($\theta$) forward in time by 40~ms; i.e., changing the assumed delay to be $-20$\,ms instead of $-60$~ms delay.\footnote{With this shift in pitch, 
the best shift in GGVSPD\sindex[var]{GGVSPD>@GGVSPD} ($w_p$) was about $-20$~ms, with little difference in standard deviation for shifts from 0 to $-40$~ms.}
Other changes in this delay by $\pm$40\,ms resulted in noticeable changes in the
standard deviation of the vertical wind, so 
the suggested recommendation is to change the delay in PITCH\sindex[var]{PITCH>@PITCH} from $-60$ to $-20$\,ms. 
%Therefore, because negative shifts are not physical and there is little high-frequency variation in $w_p$, it appears best not to impose any no time shifts on these measurements. The IRU specifications state that a delay of "up to" 60~ms should be expected, but this result suggests that either this is a upper limit not characteristic of measurements at the time being analyzed here or else there is a compensating delay in the measurements of angle-of-attack.
%The latter seems plausible because the known transducer characteristics lead to a delay of 21~ms, a response time of 50~ms, and some likely delay arising from the length of the pressure lines.

With this new time lag in PITCH\sindex[var]{PITCH>@PITCH},\index{timing!pitch} the resulting measurement of vertical wind during the pitch maneuver\index{maneuver!pitch} is shown in Fig.~\ref{fig:plot-shifted-vertical-wind}.\sindex[var]{GGVSPD>@GGVSPD} The standard deviation in measured wind through the pitch maneuvers is only 4\% of the imposed vertical motion of the aircraft, although there still appears to be
some correlation between the imposed vertical motion and the vertical wind.
However, the measured standard deviation in vertical wind is about the same as that for measurements just before and just after the pitch maneuvers, so it appears that the measuring system is able to remove the effects of the pitch maneuvers with low residual. 
% \begin{figure}
% \noindent \begin{centering}
% \includegraphics[width=0.8\textwidth]{31_home_cooperw_RStudio_DEEPWAVE_WindUncertainty_PitchManeuvers.png}  
% \par\end{centering}
% 
% \protect\caption{\label{fig:pitchManeuvers}Vertical wind measured during pitch maneuvers. The variable VSPDX (which is GGVSPD interpolated, filtered, and shifted) shows the vertical motion imposed on the aircraft, and WIX shows the resulting measurement of vertical wind. } 
% \end{figure}



\subsection{Correcting pitch for the Schuler oscillation\label{sub:Schuler}}


%include("chunks/latex-header")



% <<calculate-pitch-correction>>=
% read_chunk ("chunks/pitch-correction-function.R")
% <<correct-pitch>>=
% 
%@

%\section{Schuler correction for pitch\label{sec:Schuler}}


\subsubsection{Basis for the correction}

%Before discussing additional aspects of the measurement system like
%determination of sensitivity coefficients for the radome, it is necessary
%to explain and document a correction that will be used in that determination
%and in subsequent studies. 
The primary weakness in the measurement of vertical wind normally arises from the error in the measurement of pitch,\index{pitch!correction}\index{oscillation!Schuler} which is provided by inertial reference units and therefore has the uncertainty and fluctuations associated with those systems. An inertial system aligns\index{inertial reference unit!alignment} during initialization to detect the local vertical direction and then calculates the new vertical direction as the aircraft moves and accelerates. Any misalignment present at initialization persists but also can precess and can cause the roll and pitch errors to mix as the aircraft changes flight direction. The standard uncertainty associated with this measurement, from the IRU specifications, is 0.05$^{\circ}$ for flight duration of a few hours (Table~\ref{tab:Radome-system-measurements}).

The work of Schuler (\citet{Schuler1923}) demonstrated that coupling among some of these error sources leads to limits on the growth of errors and to simultaneous oscillations in some of the measurement errors.\index{oscillation!Schuler} In particular, an error in pitch leads to an error in horizontal acceleration because a component of gravity is resolved as a horizontal acceleration. Integration of that error in horizontal acceleration leads to a position error that grows to compensate for the original error in pitch. However, when the error in pitch is reduced to zero, errors in position and velocity have been accumulated and those lead to growth of the error in pitch in the direction opposite to the original error. The result is a Schuler oscillation having a period of\sindex[lis]{Tsch@$T_{Sch}$=period of the Schuler oscillation (84.4 min)}\index{oscillation!Schuler!period of}\sindex[lis]{Re@$R_{e}$=radius of the Earth}\sindex[lis]{g@$g$=acceleration of gravity} $T_{Sch}=(R_{e}/g)^{0.5}/(2\pi)\approx5064\thinspace s$ or 84.4\,min, where $R_{e}$ is the radius of the Earth and $g$ the acceleration of gravity. 

The existence of this coupling allows estimation of the pitch error if the error in horizontal acceleration can be measured. Because high-quality measurements of velocity are available from GPS, those measurements can be compared to the uncorrected measurements from the inertial systems to detect the error in velocity and, from its derivative, the error in acceleration. The specified uncertainty for the IRU, 0.05$^{\circ}$, would contribute an uncertainty in measured vertical wind of about 0.2 m/s and so would be the largest contributor to uncertainty in vertical wind. Therefore, improving the measurement of pitch can lead to important reduction in the uncertainty associated with measurement of vertical wind. 
Furthermore, because the sensitivity coefficients for angle of attack are determined using fits to the measurements of pitch, improved measurements of pitch can reduce the uncertainty in the measurement of angle of attack as well.

For these reasons, this section documents a procedure that can be used to correct for a major part of the error in the primary measurement of pitch by correcting for the Schuler oscillation\index{oscillation!Schuler}\index{pitch!correction} as determined from errors in the ground-speed components of the aircraft that are measured by the IRU.\index{inertial reference unit!Schuler oscillation}\footnote{This correction procedure applies only to the Honeywell IRU\index{IRU!Honeywell!Schuler oscillation} used with the radome-based wind system because the IRUs used with the gust pod or the LAMS already incorporate Kalman-filter corrections that apply similar adjustments to the measurements, and the uncorrected measurements are not available.}



\subsubsection{Simple illustration of Schuler oscillation}

The material in this subsection is standard material, presented here to make the discussion of the Schuler oscillation self-contained and possibly for tutorial purposes.\index{oscillation!Schuler!tutorial} It can be skipped without loss of continuity.

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-plot-illustrating-pitch-coupling-1} 
\includegraphics[width=\maxwidth]{figure/WU-plot-illustrating-pitch-coupling-2} 

}

\caption[Illustration of how a pitch error leads to a varying false horizontal acceleration]{Illustration of how a pitch error leads to a varying false horizontal acceleration: (left) A pitch error of magnitude $\delta\theta$ leads to a false measurement of horizontal acceleration of magnitude $g\delta\theta$. The blue line represents the true level plane tangent to the surface of the Earth and $g$ the magnitude and direction of the gravitational acceleration. (right) An error in the measurement of position, denoted here as an error in latitude $\delta\lambda_E$, leads to an error in the direction of the vertical axis and so to a changed error in horizontal acceleration.}\label{fig:plot-illustrating-pitch-coupling}
\end{figure}


\end{knitrout}


Consider first a case of straight flight to the north. If, at some starting point at rest, there is a pitch error $\delta\theta$, that will cause gravity to be resolved into a north-south component, as shown in this diagram where a pitch error produces an erroneous northward acceleration of $g\thinspace\sin(\delta\theta)\simeq g\delta\theta$, as shown in Fig.~\ref{fig:plot-illustrating-pitch-coupling}.
The result of this erroneous acceleration is growth of a false northward velocity which, integrated, gives a northward error in position. However, the error then causes the integrated position to become too far north, where the calculated direction toward the center of the earth becomes biased in the opposite direction, and at some point the calculated offset from being too far north equals the pitch bias, as shown on the right side of Fig.~\ref{fig:plot-illustrating-pitch-coupling}.

\sindex[lis]{lambdaE@$\lambda_E$=latitude}
At the point where the error in latitude cancels the error in pitch, there is an accumulated error in velocity, so the integrated solution for position overshoots the equilibrium position by an amount such that the error in pitch becomes the negative of the original error, at which point the integrated velocity is zero but the new error in pitch now causes a reversal of the position error. The result is that the errors in pitch, velocity and position all oscillate with a period equal to the Schuler period $T_{Sch}$. 

These equations \DIFdelbegin \DIFdel{predicting }\DIFdelend \DIFaddbegin \DIFadd{predict }\DIFaddend how this oscillation will occur:\sindex[lis]{x@$x$=northward coordinate in an Earth reference frame}\sindex[lis]{vn@$v_{n}$=northward component of velocity}\sindex[lis]{an@$a_{n}$=northward component of acceleration} 

\begin{equation}
v_{n}=\frac{dx_{n}}{dt}=R_{e}\frac{d\lambda_E}{dt}\label{eq:vn} 
\end{equation}


\begin{equation}
\frac{d^{2}x_{n}}{dt^{2}}=a_{n}\label{eq:an}
\end{equation}


where $x_{n}$ and $v_n$ are \DIFaddbegin \DIFadd{respectively }\DIFaddend the measured north coordinate of position and
northward component of aircraft motion, $R_e$ the radius of the Earth, and $a_{n}$ is the measured northward acceleration. \DIFdelbegin \DIFdel{However, if }\DIFdelend \DIFaddbegin \DIFadd{Regardless of the history of the pitch error $\delta\theta$ or the source of that error, it can be detected by the error it creates in the northward acceleration. If }\DIFaddend $a_{n}=a_{n}^{*}+\delta a_{n}$ where $a_{n}^{*}$ is the true northward acceleration of the aircraft and $\delta a_{n}$ is the erroneous acceleration that results from \DIFdelbegin \DIFdel{pitch and displacement errors}\DIFdelend \DIFaddbegin \DIFadd{the pitch error}\DIFaddend , then 

\begin{equation}
\delta a_{n}=\DIFdelbegin \DIFdel{g(}\DIFdelend \DIFaddbegin \DIFadd{-g}\DIFaddend \delta\DIFdelbegin \DIFdel{\lambda_E-\delta}\DIFdelend \theta\DIFdelbegin \DIFdel{)}\DIFdelend \label{eq:delta-an} 
\end{equation}
\DIFdelbegin \DIFdel{with $\lambda_E$ the latitude, $\delta\lambda_E=\delta x_{n}/R_{e}$ the error in latitude, and $\delta\theta$ the error in pitch}\DIFdelend \DIFaddbegin \DIFadd{where the critical assumption is that the accelerometers themselves do not introduce error}\DIFaddend . Then\\ 
\begin{equation}
\frac{d(\delta v_{n})}{dt}=-g\delta\theta\label{eq:delta-vn-dot}
\end{equation}
\begin{equation}
\frac{d(\delta\theta)}{dt}=\frac{\delta v_{n}}{R_{e}}=-\frac{1}{g}\frac{d^{2}(\delta v_{n})}{dt^{2}}\label{eq:delta-theta-dot}
\end{equation}
which has the solution:\\ 
\begin{equation}
\delta v_{n}=A_{n}\cos(\Omega_{Sch}t+\zeta_{n})\label{eq:delta-vn-solution} 
\end{equation}
where $A_{n}$ \sindex[lis]{Omega@$\Omega_{Sch}$=angular velocity}
is the amplitude of the oscillation, $\Omega_{Sch}=\sqrt{g/R_{e}}\simeq0.00124$
is the Schuler\index{oscillation!Schuler!angular velocity} angular
velocity, and $\zeta_n$ is the phase angle. Integrating in time gives\\ 
\begin{equation}
\delta x_{n}=\int\delta v_{n}dt=\frac{V_{n}}{\Omega_{Sch}}\sin(\Omega_{Sch}t+\zeta_{n})\label{eq:delta-xn-solution} 
\end{equation}

\subsubsection{Developing the correction equation}

The key to developing a correction to the pitch angle is that both $\delta x_{n}$ and $\delta v_{n}$ are observable because reference measurements are available from GPS. For example, if LAT and GGLAT are measured variables representing latitude respectively from the IRU and GPS,\sindex[var]{LAT=latitude measured by the Honeywell inertial reference unit}\sindex[var]{GGLAT=latitude measured by the GPS receiver}\sindex[var]{GGVNS>@GGVNS}\sindex[var]{VNS>@VNS}

\begin{eqnarray}
\delta x_{n} & = & R_{e}(\mathrm{LAT-GGLAT)}\nonumber \\ 
\delta v_{n} & = & \mathrm{VNS-GGVNS}\label{eq:observed-errors} 
\end{eqnarray}
These observations can determine $A_{n}$ and $\zeta_{n}$ in (\ref{eq:delta-vn-solution}). From these, the error in pitch can be found from (\ref{eq:delta-vn-dot}):\\ 
\begin{equation}
\delta\theta=-\frac{1}{g}\frac{d(A_{n}\cos(\Omega_{Sch}t+\zeta_{n})}{dt}=\frac{A_{n}\Omega_{Sch}}{g}\sin(\Omega_{Sch}t+\zeta_{n})\label{eq:solution-delta-theta} 
\end{equation}


Analogous equations lead to a similar coupling between the roll angle and the east component of the ground velocity: 

\begin{equation}
\delta\phi=\frac{A_{e}\Omega_{Sch}}{g}\sin(\Omega_{Sch}t+\zeta_{e})\label{eq:solution-delta-phi} 
\end{equation}


where $\phi$ is the roll angle and $A_{e}$ and $\zeta_{e}$ are determined from fits to the observed error $\delta v_{e}=\mathrm{VEW-GGVEW}$\sindex[var]{GGVEW>@GGVEW}\sindex[var]{VEW>@VEW}


Thus the observed errors in the components of the aircraft ground \sindex[lis]{An@$A_{n}$=amplitude of north component of the Schuler oscillation in ground speed}\sindex[lis]{Ae@$A_{e}$=amplitude of east component of the Schuler oscillation in ground speed} speed\index{speed of aircraft!ground speed} can be used to find corrections to be applied to the measurements of pitch and roll. Note, however, that "pitch" and "roll" as used here apply to aircraft attitude angles only for northward level flight. Otherwise, transformations are needed to obtain the attitude angles in the reference frame of the aircraft. The appropriate transformation is developed in Sect.~\ref{sub:angle-transforms-for-pitch-correction}.


\subsubsection{Illustrative example}

An example from the second ferry flight of DEEPWAVE\index{DEEPWAVE!ferry flight} is shown in Fig.~\ref{fig:v-errors-straight-leg}.\index{speed of aircraft!ground speed} The heading for most of this flight is close to southbound and steady, so to a reasonable approximation the errors in pitch and heading will be given by the respective derivatives in the error terms $\delta v_{n}$ and $\delta v_{e}$. 
The errors can be determined directly from the time-derivatives of the error terms in (\ref{eq:delta-vn-dot}) and the analogous equation for roll, restated as: 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-v-errors-straight-leg-1} 

}

\caption[Errors in the northward and eastward components of ground speed as determined by comparison to GPS, for DEEPWAVE flight ff02, a ferry flight starting on 1 June 2014 and traveling from Hawaii to Pago-Pago]{Errors in the northward and eastward components of ground speed as determined by comparison to GPS, for DEEPWAVE flight ff02, a ferry flight starting on 1 June 2014 and traveling from Hawaii to Pago-Pago.}\label{fig:v-errors-straight-leg}
\end{figure}


\end{knitrout}


\begin{eqnarray}
\delta\theta & = & -\frac{1}{g}\frac{d(\delta v_{n})}{dt}\label{eq:delta-theta}\\ 
\delta\phi & = & \DIFdelbegin \DIFdel{-}\DIFdelend \frac{1}{g}\frac{d(\delta v_{e})}{dt}\label{eq:delta-phi} 
\end{eqnarray}

\DIFdelbegin \DIFdel{Therefore, rather than }\DIFdelend \DIFaddbegin \DIFadd{An alternative to }\DIFaddend fitting variations like \DIFdelbegin \DIFdel{that }\DIFdelend \DIFaddbegin \DIFadd{those }\DIFaddend shown in Fig.~\ref{fig:v-errors-straight-leg} to sine and cosine functions \DIFdelbegin \DIFdel{, it is possible to obtain an estimate of }\DIFdelend \DIFaddbegin \DIFadd{is to estimate }\DIFaddend the time derivatives of the velocity-error terms over \DIFdelbegin \DIFdel{some shorter interval }\DIFdelend \DIFaddbegin \DIFadd{shorter intervals by differentiating the measured velocities provided by GPS }\DIFaddend and then use \DIFdelbegin \DIFdel{that derivative }\DIFdelend \DIFaddbegin \DIFadd{those derivatives }\DIFaddend in (\ref{eq:delta-theta}) or (\ref{eq:delta-phi}) to find the errors in pitch and roll. This gives errors in the local reference frame\index{coordinate system!local reference frame}\index{coordinate system!l-frame|see {coordinate system, local reference frame}} with axes eastward, northward, and upward, here called the\emph{ l}-frame, and these errors then must be transformed to the aircraft \DIFdelbegin \DIFdel{reference }\DIFdelend \DIFaddbegin \DIFadd{body }\DIFaddend frame\index{coordinate system!aircraft reference frame} to get errors in the measured quantities. The choice made here is to estimate the derivatives using fitted \index{Savitzky-Golay polynomials}Savitzky-Golay polynomials, as shown in Fig.~\ref{fig:sg-poly-smoothing}. Savitzky-Golay polynomials were chosen because they are computationally efficient, do not introduce a time shift, and can provide derivatives directly. A rather long averaging period of \DIFdelbegin \DIFdel{1009 }\DIFdelend \DIFaddbegin \DIFadd{1013 }\DIFaddend s, or about 1/5 of a Schuler oscillation, was used to reduce noise in the result, and interpolation filled some gaps in the measurements. 

\DIFaddbegin \DIFadd{Equations (\ref{eq:delta-theta}) and (\ref{eq:delta-phi}) are valid if the entire error in acceleration arises from platform mis-alignment and the associated false resolution of the gravity vector into horizontal components of acceleration. Errors in the measured accelerations would also contribute an additional term to these equations, so the validity of the proposed correction to pitch depends on the accuracy of the accelerometers. 
To check the calibration of the accelerometers, GPS measurements of the aircraft velocity were differentiated to obtain estimates of accelerations in the l-frame, and those accelerations after correction for inertial effects (Cf.}\ \DIFadd{Sect.}\ \DIFadd{\ref{sub:angle-transforms-for-pitch-correction}) were transformed to the aircraft reference frame and compared to the measured accelerations in that frame. 
When fitted to the GPS-derived measurements, the fit coefficients for the measured longitudinal accelerations (intercept and slope) were $-0.0033$ and 1.0014, with a residual standard error of 0.01}\,\DIFadd{m}\,\DIFadd{s$^{-2}$. 
The bias error would lead to a change in the pitch correction of about $0.02^{\circ}$, so this is an upper estimate of the approximate uncertainty in the pitch correction.
}

\DIFaddend \begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-sg-poly-smoothing-1} 

}

\caption[Deduced error in pitch and roll angles for DEEPWAVE ferry flight ff02]{Deduced error in pitch and roll angles for DEEPWAVE ferry flight ff02.}\label{fig:sg-poly-smoothing}
\end{figure}


\end{knitrout}

The result \DIFaddbegin \DIFadd{for this flight }\DIFaddend is that the estimated pitch error is less than about 0.01$^{\circ}$ in magnitude\DIFdelbegin \DIFdel{for most of this flight}\DIFdelend , except for the final descent, and the roll error is limited to less than about 0.015$^{\circ}$ for the same period. This is evidence for low uncertainty in the pitch measurement for this flight, well below the specification of 0.05$^{\circ}$. Section \ref{sub:Application-to-research} contains further discussion of the errors from the research flights, where the estimated errors sometimes can be larger. However, the smooth oscillations in Fig.~\ref{fig:sg-poly-smoothing} indicate that even those small errors can be detected and corrected.


\subsubsection{Transformation of attitude angles\label{sub:angle-transforms-for-pitch-correction}}

In a reference frame\index{coordinate system!local reference frame}\index{coordinate system!ENU frame|see {coordinate system, local reference frame}} called the $l$-frame or ENU\sindex[var]{ENU=east-north-up local reference frame} frame, where the coordinate axes are local-east, local-north, and upward, the preceding subsection showed that the pitch and roll errors are related, via (\ref{eq:delta-theta}) and (\ref{eq:delta-phi}), to the time-derivatives of the errors in horizontal velocity. Pitch and roll errors as used in these equations will be the respective errors in platform alignment\footnote{The inertial system used is a strap-down system, so there is no actual motion of the ``platform''. Instead, from measured rotations and accelerations, the system calculates the expected orientation if there were a true stabilized platform. The errors referenced here are those relative to that calculated platform orientation.} in the north-south and east-west directions, so these angles must be transformed to account for the orientation of the aircraft when it is not flying straight-and-level to the north. 
\DIFdelbegin \DIFdel{Coordinates in the body or $b$-frame of the aircraft}%DIFDELCMD < \index{coordinate system!b-frame|see {coordinate system, aircraft reference frame}}\index{coordinate system!body frame|see {coordinate system, aircraft reference frame}} %%%
\DIFdel{are obtained from those in the ENU or $l$-frame by applying three rotations}%DIFDELCMD < \index{coordinate system!rotation} %%%
\DIFdel{to account for the heading, pitch, and roll of the $b$-frame. This transformation leads to pitch errors in the body frame of the aircraft (where pitch and roll are measured and where the pitch measurement affects the calculated vertical wind) that are mixtures of pitch and roll errors in the $l$-frame, with the mixture dependent primarily on the heading. A positive pitch error for northbound level flight will be a negative pitch error for southbound level flight, and for eastbound flight an $l$-frame roll error becomes a $b$-frame pitch error while an $l$-frame pitch error become a negative $b$-frame roll error. 
}\DIFdelend 

Consider a unit vector $\mathbf{b}^{(l)}$ \sindex[lis]{bl@$\mathbf{b}^{(l)}$=unit vector representing errors in attitude angles in the \emph{l}-frame}representing the orientation errors in pitch and roll in the $l$-frame, with components \{\DIFdelbegin \DIFdel{$\sin\delta\phi,\,\sin\delta\theta,\,\sqrt{1-\sin^{2}\delta\phi-\sin^{2}\delta\theta}$}\DIFdelend \DIFaddbegin \DIFadd{$\sin\delta\phi,\,-\sin\delta\theta,\,\sqrt{1-\sin^{2}\delta\phi-\sin^{2}\delta\theta}$}\DIFaddend \} or, because the errors are always small, approximately \{\DIFdelbegin \DIFdel{$\delta\phi,\,\delta\theta,\,1$\}. The three-angle transformation of this vector }\DIFdelend \DIFaddbegin \DIFadd{$\delta\phi,\,-\delta\theta,\,1$\}. Transformation of these errors }\DIFaddend from the $l$-frame to the \DIFdelbegin \DIFdel{$b$}\DIFdelend \DIFaddbegin \DIFadd{$a$}\DIFaddend -frame \DIFdelbegin \DIFdel{is then represented by the following matrix, with 
\{$\phi,\,\theta,\,\psi$\} denoting \{roll, pitch, heading \}:}%DIFDELCMD < \sindex[lis]{Rlb@$R_{l}^{b}$=rotation matrix from \emph{l}-frame to \emph{b}-frame}
%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \DIFadd{requires rotation by the }\emph{\DIFadd{negative}} \DIFadd{of
the heading angle $\psi$ in the $l$-frame but does not require further transformation because
differences in pitch and roll between the $l$-frame and the $a$-frame do not affect the estimate of platform misalignment and how that misalignment is resolved into pitch and roll components. Therefore,
}\DIFaddend 

\DIFdelbegin \begin{displaymath}\DIFdel{
R_{l}^{b}=\begin{bmatrix}\cos\psi\cos\phi+\sin\psi\sin\phi\sin\theta & -\sin\psi\cos\phi+\cos\psi\sin\phi\sin\theta & -\cos\theta\sin\phi\\ 
\sin\psi\cos\theta & \cos\psi\cos\theta & \sin\theta\\ 
\cos\psi\sin\phi-\sin\psi\sin\theta\cos\phi & -\sin\psi\sin\phi-\cos\psi\sin\theta\sin\phi & \cos\theta\cos\phi 
\end{bmatrix}\label{eq:transform-l-to-b}
}\end{displaymath}
%DIFAUXCMD
\DIFdel{If the roll and pitch angles are small,
}%DIFDELCMD < \sindex[lis]{bb@$\mathbf{b}^{(b)}$=unit vector representing errors in attitude angles in the \emph{b}-frame} 
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend \begin{eqnarray}
\mathbf{b^{(b)}=}R_{l}^{b}\mathbf{b^{(l)}} & \approx & \left[\begin{array}{ccc}
\cos\psi & -\sin\psi & 0\\
\sin\psi & \cos\psi & 0\\
0 & 0 & 1
\end{array}\right]\DIFdelbegin %DIFDELCMD < \begin{bmatrix}\delta\phi\\ 
%DIFDELCMD < \delta\theta\\ 1 
%DIFDELCMD < \end{bmatrix}%%%
\DIFdel{=}%DIFDELCMD < \begin{bmatrix}\cos\psi\delta\phi-\sin\psi\delta\theta\\ 
%DIFDELCMD < \sin\psi\delta\phi+\cos\psi\delta\theta\\ 1 
%DIFDELCMD < \end{bmatrix}%%%
\DIFdelend \DIFaddbegin \begin{bmatrix}\delta\phi^{(l)}\\
-\delta\theta^{(l)}\\
1
\end{bmatrix}\DIFaddend \label{eq:b-vector-in-b-frame}\DIFaddbegin \\
 & \DIFadd{\simeq }& \begin{bmatrix}\cos\psi\delta\phi^{(l)}+\sin\psi\delta\theta^{(l)}\\
\sin\psi\delta\phi^{(l)}-\cos\psi\delta\theta^{(l)}\\
1
\end{bmatrix}
\DIFaddend \end{eqnarray}
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend which leads to $\delta\theta^{(b)}$ and $\delta\phi^{(b)}$, the
pitch and roll errors in the $b$-frame:

\begin{eqnarray}
\delta\theta^{(b)} & \simeq & \DIFaddbegin \DIFadd{-b_{2}^{(b)}/b_{3}^{(b)}=-}\DIFaddend \sin\psi\delta\phi\DIFaddbegin \DIFadd{^{(l)}}\DIFaddend +\cos\psi\delta\theta\DIFaddbegin \DIFadd{^{(l)}}\DIFaddend \label{eq:final-answer}\\
\delta\phi^{(b)} & \approx & \DIFaddbegin \DIFadd{b_{1}^{(b)}/b_{3}^{(b)}=}\DIFaddend \cos\psi\delta\phi\DIFdelbegin \DIFdel{-}\DIFdelend \DIFaddbegin \DIFadd{^{(l)}+}\DIFaddend \sin\psi\delta\theta\DIFaddbegin \DIFadd{^{(l)}}\,\,\,\DIFadd{.}\DIFaddend \nonumber 
\end{eqnarray}
\DIFdelbegin \DIFdel{In turns, the roll angle is no longer negligible, so in general the full transformation matrix }%DIFDELCMD < \eqref{eq:transform-l-to-b} %%%
\DIFdel{should be used. Because this matrix imposes rotations by the measured pitch and roll angles, the unit vector representing the errors in pitch and roll after transformation will have components from which the true pitch and roll can be determined, so subtracting the corrected pitch from the measured pitch gives the error in measured pitch: }%DIFDELCMD < \\ 
%DIFDELCMD < %%%
\begin{displaymath}\DIFdel{
\delta\theta^{(b)}=\theta-\arctan\frac{b_{2}^{(b)}}{b_{3}^{(b)}}\label{eq:pitch-error-wo-approx} 
}\end{displaymath}
%DIFAUXCMD
\DIFdelend \DIFaddbegin 

%DIF >  \[
%DIF >  \mathbf{R}_{a}^{l}=\left(\begin{array}{ccc}
%DIF >  0 & 1 & 0\\
%DIF >  1 & 0 & 0\\
%DIF >  0 & 0 & -1
%DIF >  \end{array}\right)\left(\begin{array}{ccc}
%DIF >  \cos\psi & -\sin\psi & 0\\
%DIF >  \sin\psi & \cos\psi & 0\\
%DIF >  0 & 0 & 1
%DIF >  \end{array}\right)\left(\begin{array}{ccc}
%DIF >  \cos\theta & 0 & -\sin\theta\\
%DIF >  0 & 1 & 0\\
%DIF >  \sin\theta & 0 & \cos\theta
%DIF >  \end{array}\right)\left(\begin{array}{ccc}
%DIF >  1 & 0 & 0\\
%DIF >  0 & \cos\phi & \sin\phi\\
%DIF >  0 & -\sin\phi & \cos\phi
%DIF >  \end{array}\right)
%DIF >  \]
%DIF >  \\
%DIF >  \[
%DIF >  R_{a}^{l}=\begin{bmatrix}\sin\psi\cos\theta & \sin\psi\sin\theta\sin\phi+\cos\psi\cos\phi & \cos\psi\sin\phi-\sin\psi\sin\theta\cos\phi\\
%DIF >  \cos\psi\cos\theta & \cos\psi\sin\theta\sin\phi-\sin\psi\cos\phi & -\cos\psi\sin\theta\cos\phi-\sin\psi\sin\phi\\
%DIF >  -\sin\theta & \cos\theta\sin\phi & -\cos\theta\cos\phi
%DIF >  \end{bmatrix}\label{eq:transform-a-to-l}
%DIF >  \]

%DIF >  
%DIF >  \begin{equation}
%DIF >  R_{l}^{b}=\begin{bmatrix}\cos\psi\cos\phi+\sin\psi\sin\phi\sin\theta & -\sin\psi\cos\phi+\cos\psi\sin\phi\sin\theta & -\cos\theta\sin\phi\\ 
%DIF >  \sin\psi\cos\theta & \cos\psi\cos\theta & \sin\theta\\ 
%DIF >  \cos\psi\sin\phi-\sin\psi\sin\theta\cos\phi & -\sin\psi\sin\phi-\cos\psi\sin\theta\sin\phi & \cos\theta\cos\phi 
%DIF >  \end{bmatrix}\label{eq:transform-l-to-b}
%DIF >  \end{equation}
%DIF >  The transformation from the $l$ to $a$-frame, $R_l^a$, is the inverse (or transpose) of this matrix. If the roll and pitch angles are small,\sindex[lis]{bb@$\mathbf{b}^{(b)}$=unit vector representing errors in attitude angles in the \emph{b}-frame} 
%DIF >  
%DIF >  \begin{eqnarray}
%DIF >  \mathbf{b^{(a)}=}R_{l}^{b}\mathbf{b^{(l)}} & \approx & \left[\begin{array}{ccc}
%DIF >  \cos\psi & -\sin\psi & 0\\ 
%DIF >  \sin\psi & \cos\psi & 0\\ 0 & 0 & 1 
%DIF >  \end{array}\right]\begin{bmatrix}\delta\phi\\ 
%DIF >  \delta\theta\\ 1 
%DIF >  \end{bmatrix}=\begin{bmatrix}\cos\psi\delta\phi-\sin\psi\delta\theta\\ 
%DIF >  \sin\psi\delta\phi+\cos\psi\delta\theta\\ 1 
%DIF >  \end{bmatrix}\label{eq:b-vector-in-b-frame}
%DIF >  \end{eqnarray}
%DIF >  
%DIF >  
%DIF >  which leads to $\delta\theta^{(b)}$ and $\delta\phi^{(b)}$, the pitch and roll errors in the $b$-frame: 
%DIF >  
%DIF >  \begin{eqnarray}
%DIF >  \delta\theta^{(a)} & \simeq & \sin\psi\delta\phi+\cos\psi\delta\theta\label{eq:final-answer}\\ 
%DIF >  \delta\phi^{(a)} & \approx & \cos\psi\delta\phi-\sin\psi\delta\theta\nonumber  
%DIF >  \end{eqnarray}
%DIF >  In turns, the roll angle is no longer negligible, so in general the full transformation matrix (the inverse of \eqref{eq:transform-a-to-l}) should be used. Because this matrix imposes rotations by the measured pitch and roll angles, the unit vector representing the errors in pitch and roll after transformation will have components from which the true pitch and roll can be determined, so subtracting the corrected pitch from the measured pitch gives the error in measured pitch: \\ 
%DIF >  \begin{equation}
%DIF >  \delta\theta^{(b)}=\theta-\arctan\frac{b_{2}^{(b)}}{b_{3}^{(b)}}\label{eq:pitch-error-wo-approx} 
%DIF >  \end{equation}
\DIFaddend This pitch error should then be \DIFdelbegin \DIFdel{subtracted }\DIFdelend \DIFaddbegin \emph{\DIFadd{subtracted}} \DIFaddend from the measured pitch to obtain a corrected value of the pitch \DIFdelbegin \DIFdel{for use }\DIFdelend \DIFaddbegin \DIFadd{to be used }\DIFaddend in the calculation of vertical wind.\index{pitch!correction!equation} 


\subsubsection{Application to research flights\label{sub:Application-to-research}}

The research flights have frequent changes in heading, with mixing of the roll and pitch errors but also accelerations that affect those errors and introduce new errors from heading errors. The corrections to pitch therefore appear much less systematic than was the case for the ferry flight. An example with larger pitch errors than those in most DEEPWAVE flights, DEEPWAVE\index{DEEPWAVE!flight 1} flight 1, is presented here. Figure \ref{fig:processing-1}\sindex[var]{GGVEW>@GGVEW}\sindex[var]{VEW>@VEW} shows the measured errors in ground-speed\index{speed of aircraft!ground speed} components, and Fig.~\ref{fig:processing-2}\sindex[var]{PITCH>@PITCH}\sindex[var]{ROLL>@ROLL} shows the deduced pitch and roll errors. There are instances where the pitch error abruptly reverses sign; those are cases where the flight direction \DIFdelbegin \DIFdel{changes }\DIFdelend \DIFaddbegin \DIFadd{changed }\DIFaddend by about 180\DIFdelbegin \DIFdel{deg. 
During turns, the full transformation leads to a result significantly different from the small-angle-approximation result, as shown by the orange line in Fig.~\ref{fig:processing-2}, but when not turning the full-transformation results replicate the small-angle-approximation results (blue line), as indicated by the orange dashed line overlapping the blue line. The proposed solution is to use the full transformation to find a corrected pitch variable}%DIFDELCMD < \sindex[var]{PITCHC=pitch corrected as described in Sect.~\ref{sub:angle-transforms-for-pitch-correction}} %%%
\DIFdel{to be used for calculation of the vertical wind. }\DIFdelend \DIFaddbegin \DIFadd{$^{\circ}$. 
%DIF >  During turns, the full transformation leads to a result significantly different from the small-angle-approximation result, as shown by the orange line in Fig.~\ref{fig:processing-2}, but when not turning the full-transformation results replicate the small-angle-approximation results (blue line), as indicated by the orange dashed line overlapping the blue line. The proposed solution is to use the full transformation to find a corrected pitch variable\sindex[var]{PITCHC=pitch corrected as described in Sect.~\ref{sub:angle-transforms-for-pitch-correction}} to be used for calculation of the vertical wind.
}\DIFaddend In straight-and-level flight, the needed corrections for this flight are about $\pm$0.03$^{\circ}$ at some times, and this error can lead (for airspeed of 220 m/s) to an error in vertical wind of more than $\pm0.1$\,m/s. Correction for this error thus can lead to a useful reduction in the uncertainty associated with the measured vertical wind. 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-processing-1-1} 

}

\caption[Measured errors in ground-speed components for DEEPWAVE flight 1]{Measured errors in ground-speed components for DEEPWAVE flight 1. DifEW \DIFdelbeginFL \DIFdelFL{denotes }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{is }\DIFaddendFL GGVEW-VEW, the difference in eastward ground speed between measurements from the GPS and IRU, and DifNS \DIFdelbeginFL \DIFdelFL{denotes }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{is }\DIFaddendFL the corresponding difference for the \DIFdelbeginFL \DIFdelFL{northwas }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{northward }\DIFaddendFL component.}\label{fig:processing-1}
\end{figure}


\end{knitrout}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-processing-2-1} 

}

\caption[Errors in pitch and roll determined from the measured errors in ground-speed components, after transformation to the reference frame that is the body frame of the aircraft.]{Errors in pitch and roll determined from the measured errors in ground-speed components, after transformation to the reference frame that is the body frame of the aircraft.  \DIFdelbeginFL \DIFdelFL{The orange line labeled 'Full Xfm' uses (\ref{eq:b-vector-in-b-frame}) and (\ref{eq:pitch-error-wo-approx})}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{Gaps in plots are turns}\DIFaddendFL , \DIFdelbeginFL \DIFdelFL{while }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{identified when }\DIFaddendFL the \DIFdelbeginFL \DIFdelFL{thick blue line uses the approximate result (\ref{eq:final-answer}). The limits $\pm$0.03 correspond to roll angle }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{absolute value }\DIFaddendFL of \DIFdelbeginFL \DIFdelFL{$\pm 30^{\circ}$ after division by 1000, so }\DIFdelendFL the \DIFdelbeginFL \DIFdelFL{regions with vertical black lines are ones with significant }\DIFdelendFL roll \DIFaddbeginFL \DIFaddFL{angle is more than $3^{\circ}$ }\DIFaddendFL and \DIFdelbeginFL \DIFdelFL{identify }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{30-s prior to and following such points. The pitch correction is not plotted there because }\DIFaddendFL the \DIFaddbeginFL \DIFaddFL{algorithm is not applicable to }\DIFaddendFL turns \DIFdelbeginFL \DIFdelFL{in the flight track}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{and small timing differences can lead to large errors when turning}\DIFaddendFL .}\label{fig:processing-2}
\end{figure}


\end{knitrout}

\subsubsection{Tests of the correction}

Two tests were used to determine if these pitch\index{pitch!correction!tests} corrections made any significant difference in the measurements of vertical wind. First, wind measurements made before and after level course reversal were compared to see if correcting\index{pitch!correction!tests!course reversal} the pitch reduces the difference in measurements on the two legs before and after turns. Reduction would be expected because if there is a pitch error it would reverse sign between the two legs, increasing their absolute difference. Second, flight-average and project-average vertical wind measurements were compiled without and with the pitch correction. 

The following is a tabulation of five instances where the flight track reversed course and remained at the same altitude. Some other candidates were excluded because conditions were too variable along the legs to produce a small-uncertainty estimate of the vertical wind. In each case, flight periods of about 5 min (sometimes adjusted in times of strong wind to give similar-length segments flown upwind and downwind) are listed before and after the turn, but excluding the turn, to represent approximately overlapping flight segments where it would be expected that the vertical wind would be the same. 

\begin{minipage}[t]{1\columnwidth}%
\hskip1in%
\begin{tabular}{|c|c|c|}
\hline 
\textbf{Flight}  &
\textbf{Times before turn [m/s]}  &
\textbf{Times after turn [m/s]}\tabularnewline
\hline 
\hline 
1  &
8:10:00--8:16:00  &
8:24:00--8:30:00\tabularnewline
\hline 
2  &
12:25:00--12:30:00  &
12:37:00--12:43:00\tabularnewline
\hline 
19  &
8:39:30--8:44:30  &
8:51:30--8:56:30\tabularnewline
\hline 
21  &
8:51:00--8:55:00  &
9:03:00--9:07:30\tabularnewline
\hline 
21  &
9:56:30--10:01:30  &
10:08:00--10:13:00\tabularnewline
\hline 
\end{tabular}%
\end{minipage}



%  The average absolute value of the
% difference before correction was smaller than 0.1\,m/s, so the wind 
% measurements were already in very good agreement for these pairs of legs
% and not much improvement could be expected. 
% However, application of the
% pitch-correction algorithm did reduce this average to about 36\% of the
% uncorrected value, as shown in Fig.\ \ref{fig:reverse-course-w-comparison}.

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-reverse-course-w-comparison-1} 

}

\caption[Absolute difference in vertical wind for flight segments before and after level course-reversal maneuvers]{Absolute difference in vertical wind for flight segments before and after level course-reversal maneuvers. The top panel shows the uncorrected measurements and the bottom panel shows the result of applying the pitch correction developed in this subsection.}\label{fig:reverse-course-w-comparison}
\end{figure}


\end{knitrout}

The difference between average vertical wind measurements for each  pair of legs was calculated before and after applying the pitch-correction  algorithm developed in this subsection. The results are shown in Fig.~\ref{fig:reverse-course-w-comparison}. The measurements were in good agreement without any pitch correction, with an average absolute value of the difference between opposing legs of 0.09\,m\,s$^{-1}$. The pitch correction kept the averages quite small and improved the agreement, reducing the mean value of the difference to \DIFdelbegin \DIFdel{0.09}\DIFdelend \DIFaddbegin \DIFadd{0.05}\DIFaddend \,m\,s$^{-1}$. More significant than this reduction is that the values were this small even before correction. This is a good indicator of the low uncertainty of the pitch measurement even without correction. A course-reversal difference of 0.1\,m\,s$^{-1}$ would result from a pitch error  of less than 0.015$^{\circ}$, so this suggests that the inertial system is performing significantly better than its specified uncertainty (0.05$^{\circ}$). After correction, the mean difference suggests an error of less than 0.005$^{\circ}$ for the corrected values. 

Table\ \ref{tab:vw-by-flight} lists the mean vertical wind with and without pitch correction for each of the DEEPWAVE flights. For each flight, all measurements above 25,000\,ft with airspeed above 130\,m/s and roll between $-5$ and $5^{\circ}$ were included to emphasize normal research conditions. Any \DIFaddbegin \DIFadd{periods with }\DIFaddend missing measurements were also excluded from the averages, and measurements from flights 6, 7, and 15 are not included because the first two were cases where the conventional vertical-wind measuring system malfunctioned and flight 15 was a flight devoted to calibration with little upper-level flight and frequent turns including circles. 



\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{ccc}
\toprule  
\textbf{flight}  & \textbf{mean WIC [m/s]}  & \textbf{mean corrected WIC [m/s]}\tabularnewline 
\midrule 
\midrule  1 & \ensuremath{-0.01} & \ensuremath{-0.02}\tabularnewline 
\midrule  2 & 0.03 & \DIFdelbeginFL \DIFdelFL{0.02}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.03}\DIFaddendFL \tabularnewline 
\midrule  3 & \ensuremath{-0.07} & \ensuremath{-0.07}\tabularnewline 
\midrule  4 & \ensuremath{-0.09} & \DIFdelbeginFL %DIFDELCMD < \ensuremath{-0.14}%%%
\DIFdelendFL \DIFaddbeginFL \ensuremath{-0.13}\DIFaddendFL \tabularnewline 
\midrule  5 & 0.03 & \DIFdelbeginFL %DIFDELCMD < \ensuremath{-0.02}%%%
\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0}\DIFaddendFL \tabularnewline 
\midrule  8 & 0.01 & \DIFdelbeginFL %DIFDELCMD < \ensuremath{-0.03}%%%
\DIFdelendFL \DIFaddbeginFL \ensuremath{-0.02}\DIFaddendFL \tabularnewline 
\midrule  9 & 0.02 & \DIFdelbeginFL \DIFdelFL{0.01}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.02}\DIFaddendFL \tabularnewline 
\midrule  10 & 0.15 & \DIFdelbeginFL \DIFdelFL{0.13}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.14}\DIFaddendFL \tabularnewline 
\midrule  11 & 0.08 & 0.08\tabularnewline 
\midrule  12 & \DIFdelbeginFL \DIFdelFL{0.07 }\DIFdelendFL \DIFaddbeginFL \ensuremath{-0.07} \DIFaddendFL & \DIFdelbeginFL \DIFdelFL{0.04}\DIFdelendFL \DIFaddbeginFL \ensuremath{-0.08}\DIFaddendFL \tabularnewline 
\midrule  13 & 0.02 & \DIFdelbeginFL %DIFDELCMD < \ensuremath{-0.01}%%%
\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.01}\DIFaddendFL \tabularnewline 
\midrule  14 & 0.08 & \DIFdelbeginFL \DIFdelFL{0.08}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.09}\DIFaddendFL \tabularnewline 
\midrule  16 & 0.07 & \DIFdelbeginFL \DIFdelFL{0.05}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.06}\DIFaddendFL \tabularnewline 
\midrule  17 & \DIFdelbeginFL \DIFdelFL{0.02 }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.01 }\DIFaddendFL & 0.01\tabularnewline 
\midrule  18 & \ensuremath{-0.07} & \ensuremath{-0.07}\tabularnewline 
\midrule  19 & 0.08 & 0.08\tabularnewline 
\midrule  20 & 0.07 & \DIFdelbeginFL \DIFdelFL{0.06}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.07}\DIFaddendFL \tabularnewline 
\midrule  21 & \DIFdelbeginFL \DIFdelFL{0.11 }\DIFdelendFL \DIFaddbeginFL \ensuremath{-0.02} \DIFaddendFL & \DIFdelbeginFL \DIFdelFL{0.08}\DIFdelendFL \DIFaddbeginFL \ensuremath{-0.04}\DIFaddendFL \tabularnewline 
\midrule  22 & 0.02 & \DIFdelbeginFL \DIFdelFL{0}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.01}\DIFaddendFL \tabularnewline 
\midrule  23 & 0.07 & 0.07\tabularnewline 
\midrule  24 & 0.03 & 0.03\tabularnewline 
\midrule  25 & \ensuremath{-0.02} & \ensuremath{-0.02}\tabularnewline 
\midrule  26 & 0.03 & \DIFdelbeginFL \DIFdelFL{0.03}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{0.05}\DIFaddendFL \tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption[The average vertical wind for each flight, before and after application of the pitch-correction algorithm.]{The average vertical wind for each flight, before and after application of the pitch-correction algorithm developed in this subsection. The data restriction applied was that the airspeed be above 130\,m/s, absolute value of the roll less than $5^{\circ}$, and the flight level greater than FL250 (25,000\,ft or approximately 7.6\,km, to emphasize normal research measurement conditions in the DEEPWAVE project. Flights 6, 7, and 15 \DIFdelbeginFL \DIFdelFL{are }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{were }\DIFaddendFL also \DIFdelbeginFL \DIFdelFL{missing}\DIFdelendFL \DIFaddbeginFL \DIFaddFL{excluded}\DIFaddendFL , as explained in the text.\label{tab:vw-by-flight}} 
\end{table}

\par\end{center}


The mean value of the vertical wind, for all flights combined, was 
\index{pitch!correction!magnitude of} 
\DIFdelbegin \DIFdel{0.03}\DIFdelend \DIFaddbegin \DIFadd{0.02}\DIFaddend \,m/s for the uncorrected measurements and \DIFdelbegin \DIFdel{0.02}\DIFdelend \DIFaddbegin \DIFadd{0.01}\DIFaddend \,m/s for the corrected measurements, with standard deviations of  
0.06\,m/s,  so both are well within expected tolerances. The pitch correction has little effect on these mean measurements or the overall standard deviation.  However, the small offset obtained with the pitch corrections applied does not indicate that the measurements are only uncertain within these limits, because most flights are long compared to the Schuler-oscillation period of about 84 min. Flights will average over an oscillating correction and that average may be small compared to the correction applied. The standard deviation of the applied correction is 0.02$^{\circ}$ when calculated for the entire project. That indicates that the correction to vertical wind arising from application of the pitch-correction algorithm introduces changes with standard deviation of about 
\DIFdelbegin \DIFdel{0.09}\DIFdelend \DIFaddbegin \DIFadd{0.08}\DIFaddend \,m\,s$^{-1}$  project-wide. Studies of individual flights  show that this varies significantly from flight to flight. This uncertainty, however, is a significant contributor to the uncertainty in vertical wind.  Without pitch correction, measurements of vertical wind  will have an error with typical period of the Schuler oscillation\index{oscillation!Schuler} that, for measurements spanning much shorter periods, will appear as a slowly varying bias.

\DIFaddbegin \DIFadd{To check for possible changes in the variance spectra of measurements, the variance spectrum of the correction signal from some representative flight legs in DEEPWAVE were examined. Because changes in attitude angles affect the transformation of the deduced corrections to the aircraft reference frame, body motions of the aircraft introduce some high-frequency contributions to the correction that would otherwise be eliminated by the >1000-s filtering of the GPS-measured accelerations. However, for all flight conditions examined, the variance spectrum of the effect of the correction on vertical wind was less than 1\% of that of vertical wind without correction, for all wavelengths smaller than 100}\ \DIFadd{km, and was less than 0.01\% at 1}\ \DIFadd{Hz.
}

\DIFaddend The correction procedure developed here is not applied in normal processing of data files because it \DIFaddbegin \DIFadd{uses }\DIFaddend fits to the entire sequence of ground-speed measurements to find the corrections while the normal processor is sequential and has no access to future measurements while processing. To apply these corrections, an additional processing step is required. Code for this purpose has been developed to add values of pitch and vertical wind after correction, and this code was used for all the analyses reported here including the determinations of sensitivity coefficients in Sect.~\ref{sec:Calibrations}. The code can be accessed in the reference file for this document, WindUncertainty.Rnw; for details, see Appendix C.

% \subsubsection{Unresolved Questions}
% \begin{enumerate}
% \item To obtain the result shown in Fig.~\ref{fig:pitchManeuvers}, it
% was necessary to use Savitzky-Golay polynomials for smoothing. It
% needs to be investigated if the situation is different from GGVSPDB
% measurements at 5 Hz interpolated and filtered for 25-Hz output, as
% would be the case for high-rate wind measurements. 
% \item It appears unresolved if GGVSPDB underestimates the contribution to
% the variance around 0.3 Hz. VSPD clearly makes no contribution here.
% The contributions from the two pod-mounted IRUs (with Kalman filtering
% to use GPS measurements) show slightly higher variance than GGVSPDB
% at these frequencies. \end{enumerate}
% 
% \vfill\eject

% \end{document}




\section{Studies of the Horizontal Wind\label{sec:HWind}}




\subsection{Analysis of circle maneuvers\label{sub:Analysis-of-circle}}

\subsubsection{Data Used}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-circle-tracks-1} 
\includegraphics[width=\maxwidth]{figure/WU-circle-tracks-2} 

}

\caption[An example of the circle flight pattern.]{An example of the circle flight pattern, from DEEPWAVE flight 15, 3:38:30--3:54:30 UTC. Left side: normal flight track referenced to ground coordinates; right side, flight track plotted in a Lagrangian reference frame drifting with the horizontal wind.}\label{fig:circle-tracks}
\end{figure}


\end{knitrout}

\index{maneuver!circle}
During the DEEPWAVE\index{DEEPWAVE} project, several circle patterns\index{maneuver!circle!plotted track} were flown to check the wind measurements. In these maneuvers, a constant roll angle was maintained so that the flight track drifted with the wind. That drift alone provides a measurement of mean horizontal wind that is dependent only on the measurement of position from the GPS. If the true wind is steady over the course of the flight pattern, the measured wind should also be steady, but that measured wind results from varying contributions from airspeed and from heading and sideslip as the heading changes, so variations in the measured wind will have characteristic patterns indicating the nature of any errors present. An example from DEEPWAVE\index{DEEPWAVE!flight 15} flight 15, 3:38:30--3:54:30 UTC, with two circles flown with left roll and then two with right roll, is shown in Fig.~\ref{fig:circle-tracks}. 
% \noindent 
% \begin{figure}[btp]
% \begin{centering}
% \includegraphics[width=0.49\textwidth]{Circle1}\includegraphics[width=0.49\textwidth]{Circle1Drift}
% \par\end{centering}
% 
% \protect\caption{An example of a circle flight pattern, from DEEPWAVE flight 15, 3:38:30--3:54:30
% UTC. Left side: normal flight track; right side, flight track plotted
% in a reference frame drifting with the horizontal wind.\label{fig:CircleFlightPatterns}}
% \end{figure}

\subsubsection{Constraints arising from the assumption that the wind is steady}

The circle maneuver is a stringent test of the wind measurements because, in steady conditions, the measured wind should remain constant around the circles. From the patterns of deviations with orientation in the turn, it is possible to detect an error in airspeed or an offset in heading or sideslip angle. A time offset in measured \index{speed of aircraft!ground speed!time offset}ground speed from the GPS relative to the IRU can also be detected because it produces a deduced heading offset that changes sign when left-turn and right-turn circles are compared. 

For these patterns, the wind should be relatively steady and non-turbulent and the roll angle should be constant. For this flight segment, the left-turn circles had a roll\sindex[var]{ROLL>@ROLL} angle of \ensuremath{-26.92}$\pm$0.17$^{\circ}$ and the right-turn circles had roll angle 27.08$\pm$0.12$^{\circ}$, while the mean airspeed for these circles was 153.5$\pm$0.5~m/s. Some of the standard deviation in airspeed arose from the normal fluctuations created by the flight management system, as discussed in Sect.~\ref{sub:Variance-spectra-for-W-components} (cf.~Fig.~\ref{fig:phugoid-plot}), and some represents real fluctuations in wind. The steadiness of these measurements indicates that this maneuver was flown with good precision and symmetrically, so the following is is a good illustration of what can be learned from this maneuver. 

\subsubsection{Basic equations}

These tests use the measured relative wind in Earth-based coordinates, with east and north components given approximately by \{$V\sin\psi^{\prime}$, $V\cos\psi^{\prime}$\} where $\psi^{\prime}=\psi+\beta\cos\phi-\alpha\sin\phi$ with $\psi$ the heading,\sindex[lis]{psiprime@$\psi^{\prime}$=heading angle adjusted in turns for sideslip angle and angle of attack} $\beta$ the sideslip angle, $\phi$ the roll angle, and $\alpha$ the angle of attack. In the circle maneuver, $\phi\approx27^{\circ}$ so the last two terms in the expression for $\psi^{\prime}$ do not simplify with the small-angle approximation. If the east and north components of the horizontal wind are $v_{x}$ and $v_{y}$, the corresponding components of the ground speed\index{speed of aircraft!ground speed} of the aircraft ($v_{p,x}$ and $v_{p,y}$) are 

\begin{eqnarray}
\begin{split}
v_{p,x} & = & V\sin\psi^{\prime}-v_{x}\\ v_{p,y} & = & V\cos\psi^{\prime}-v_{y} 
\end{split}
\label{eq:dead-reckoning}
\end{eqnarray}
and the difference between the motion of the aircraft expressed as \eqref{eq:dead-reckoning} and the ground-speed components measured by GPS ($v_{g,x},\,v_{g,y}$) is\\ 
\begin{eqnarray}
\begin{split}
\delta v_{x} & = & V\sin\psi^{\prime}-v_{x}-v_{g,x}\\ 
\delta v_{y} & = & V\cos\psi^{\prime}-v_{y}-v_{g,y} 
\end{split}
~~~~~.\label{eq:v-errors} 
\end{eqnarray}

If error terms for airspeed ($\delta V$) and for the adjusted heading angle ($\delta\psi^{\prime}$) are introduced so that the true values are $V=V_{m}+\delta V$ and $\psi^{\prime}=\psi_{m}^{\prime}+\delta\psi^{\prime}$ where subscript $m$ refers to the measured quantity, and if it is assumed that the wind components \{$v_{x}$ and $v_{y}$\} are steady around the circles, then estimates for the four fit parameters \{$\delta V,\,\delta\psi^{\prime},\,v_{x},\,v_{y}$\} can be found by minimizing the errors given by \eqref{eq:v-errors}. 

Once the average wind direction ($\lambda_w$) and wind speed ($v$) have been determined either by the above fit or from the mean of measurements around the circles,\footnote{With equal weighting for measurements with all orientations relative to the wind, averaging measurements should give correct values even if there are errors in the individual terms} the error $\delta v_{m}$ in the measurement of wind speed ($v_{m}$) can be expressed as\\ 
\begin{equation}
\delta v_{m}=v_{m}-v=-\delta V\cos\xi-V\delta\psi^{\prime}\sin\xi\label{eq:delta-v-m} 
\end{equation}
\sindex[lis]{xi@$\xi$=angle between the relative wind and Earth-referenced wind}%
where $\xi=\psi^{\prime}-\lambda_w$ is the angle between the relative wind (in the direction $\psi^{\prime}$ which is the heading adjusted for the roll angle by components from the sideslip angle and angle of attack) and the direction of the wind relative to the Earth ($\lambda_w$). 

This equation is justified as follows. Because the relative wind transformed to an Earth reference frame is added to the ground-speed vector to find the wind, an error $\delta V$ in airspeed leads to an error of the same magnitude in the component of measured wind along the longitudinal axis of the aircraft. The measured wind therefore changes by $-2\delta V$ when the aircraft changes from an upwind to a downwind flight direction, with the negative sign arising from the convention that wind direction is specified as the direction from which the wind blows. The error in airspeed thus can be determined from the difference between wind measured while flying upwind and that measured while flying downwind. For other flight directions, this error projects to the wind direction as $-\delta V\cos\xi$. Similarly, when flying crosswind the wind measurement is determined by the sum of the ground-speed component along the wind direction and the component of the relative wind lateral to the aircraft. If the wind is from the port side of the aircraft (e.g., for an east flight direction with wind from the north), a positive heading error leads to a relative wind component opposing the wind and so to a measurement error of $-V\delta\psi^{\prime}$. For wind from the starboard side of the aircraft, the sign reverses, and for other angles the error contribution is $-V\delta\psi^{\prime}\sin\xi$. 

Fitting to minimize the deviations expressed by \eqref{eq:delta-v-m} can then \sindex[lis]{v@$v$=wind speed (relative to the Earth)} give estimates of the three fit parameters $\delta V$, $\delta\psi^{\prime}$, and $v$, or a fixed value can be used for $v$ as given by the mean of measurements or by a previous fit to \eqref{eq:v-errors}. These fits to \eqref{eq:v-errors} or \eqref{eq:delta-v-m} should give consistent results, but a fit to \eqref{eq:delta-v-m} is particularly illustrative because plots of the error as a function of flight direction relative to the wind clearly reveal the magnitude and source of the deviations. The expected pattern is shown in Fig.~\ref{fig:sine-plot}. 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-sine-plot-1} 

}

\caption[Illustration of the expected variation in measured wind speed with flight angle relative to the wind direction, for assumed errors in airspeed and heading.]{Illustration of the expected variation in measured wind speed with flight angle relative to the wind direction, for assumed errors of $\delta V=1$ m/s in airspeed and $\delta\psi^{\prime}=0.3^{\circ}$ in heading and for an assumed true wind speed of 10 m/s. The assumed airspeed is 155 m/s. The red arrows show the differences in measured wind speed between 90 and 270$^{\circ}$ directions and between 0 and 180$^{\circ}$ directions.}\label{fig:sine-plot}
\end{figure}


\end{knitrout}



\subsubsection{Finding the wind from the GPS ground track}

From the definitions \eqref{eq:v-errors}, the mean wind can be found by adjusting the fit parameters $v_{x}$, $v_{y}$, $\delta V$ and $\delta\psi$ to minimize the error measure $\chi^{2}=\sum(\delta v_{x}^{2}+\delta v_{y}^{2})$. The results, with wind converted to wind direction $\lambda_w$ and wind speed $v$, are shown in Table~\ref{tab:GSmin} for the full circle maneuver and also separately for the right-turn circles and left-turn circles. 

\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{cccccc}
\toprule   & $\lambda_w\,[^{\circ}]$  & $v$~{[}m/s{]}  & $\delta V$~{[}m/s{]}  & $\delta\psi^{\prime}\,[^{\circ}]$  & residual error {[}m/s{]}\tabularnewline 
\midrule 
\midrule  all turns & 222.8 & 17.7 & 0.4 & -0.05 & 1.0\tabularnewline 
\midrule  mean of measurements & 222.8 & 18.0 &  &  & \tabularnewline 
\midrule  left turns & 222.9 & 18.3 & 0.5 & -0.05 & 1.0\tabularnewline 
\midrule  left-turn measurements & 222.8 & 18.5 &  & & \tabularnewline 
\midrule  right turns & 222.6 & 17.2 & 0.3 & -0.06 & 0.4\tabularnewline 
\midrule  right-turn measurements & 222.8 & 17.5 &  & & \tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption[The best-fit parameters that minimize the errors given by \eqref{eq:v-errors} for the first circle maneuver from DEEPWAVE flight 15.]{The best-fit parameters that minimize the errors given by \eqref{eq:v-errors} for the first circle maneuver from DEEPWAVE flight 15, 3:38:30--3:56:30 UTC, at an altitude of about 4.1 km (13,500 ft). The lines \textquotedbl{}mean of measurements\textquotedbl{}, \textquotedbl{}left-turn measurements\textquotedbl{} and \textquotedbl{}right-turn measurements\textquotedbl{} are based on the wind measurements from the aircraft data system.\label{tab:GSmin}}
\end{table}

\par\end{center}

There is an apparently significant difference of about 1~m/s in mean wind speed, both measured and resulting from the fits, between the right-turn circles and the left-turn circles. This seems to be a real difference between wind conditions in the regions where the circles were flown and is supported by the difference between maximum and minimum ground speed\index{speed of aircraft!ground speed} for the two sets of circles. Conditions are more uniform for the right-turn circles, as reflected in the lower residual error for those circles, so more weight will be given here to the results from the right-turn circles. 

The fits point to a very small heading error that is consistent for the two turn directions. That result is very sensitive to the timing of signal acquisition: Any difference in timing between the ground-speed components from the GPS and the heading measurement from the IRU will produce an indicated error in heading that changes sign with turn direction. Shifting either pitch or ground-speed components by 40\,ms changes the indicated errors in heading by 0.07$^{\circ}$, so these lags are very sensitive to the assumed delay. The results here were obtained for a heading time lag of $-50$\,ms, slightly different from the conventional lag of $-80$\,ms, and with no shift imposed on the GPS measurements of ground-speed components. Also, no offset was applied to heading. For documentation, the attributes\index{heading!attributes of THDG}\sindex[var]{THDG>@THDG} for the heading variable as processed for this study are listed here: 

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{verbatim}
## [1] "attributes for variable"
## [1] "_FillValue: -32767"
## [1] "units: degree_T"
## [1] "long_name: IRS Aircraft True Heading Angle"
## [1] "standard_name: platform_orientation"
## [1] "valid_range: c(0, 360)"
## [1] "actual_range: c(0.00287811458110809, 359.997497558594)"
## [1] "Category: Analog"
## [1] "SampledRate: 25"
## [1] "TimeLag: -50"
## [1] "TimeLagUnits: milliseconds"
## [1] "DataQuality: Preliminary"
## [1] "CalibrationCoefficients: c(0, 1)"
## [1] "modulus_range: c(0, 360)"
\end{verbatim}
\end{kframe}
\end{knitrout}

Two other circle patterns were flown on this same flight, at 4:35:00--4:53:00 and 5:30:00--5:53:00 UTC. Results from fits to those circle maneuvers are shown in Tables~\ref{tab:GS2min} and \ref{tab:GS3min}. In these two cases and in Table~\ref{tab:GSmin}, deduced airspeed corrections\index{airspeed!correction}\index{heading!correction} from individual circles varied from $-0.6$ to 0.6\,m/s and angular corrections (combining heading and sideslip-angle errors) varied from 0.01 to 0.23$^{\circ}$, with mean values of 0.2$\pm0.2$\,m/s and 0.13$\pm0.03^{\circ}$. 
The fits thus support the low uncertainty limit claimed for airspeed but suggest that there is an error in the combination of heading and sideslip that should be corrected.





\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{cccccc}
\toprule% 
 & $\lambda_w\,[^{\circ}]$  & $v$~{[}m/s{]}  & $\delta V$~{[}m/s{]}  & $\delta\psi^{\prime}\,[^{\circ}]$  & residual error {[}m/s{]}\tabularnewline 
\midrule 
\midrule  all turns & 230.7 & 22.8 & 0.5 & -0.01 & 0.6\tabularnewline 
\midrule  mean of measurements & 230.4 & 22.2 &  &  & \tabularnewline 
\midrule  left turns & 231.3 & 22.6 & 0.5 & -0.02 & 0.6\tabularnewline 
\midrule  left-turn measurements & 231.2 & 22 &  & & \tabularnewline 
\midrule  right turns & 230.1 & 23 & 0.6 & -0.01 & 0.4\tabularnewline 
\midrule  right-turn measurements & 229.6 & 22.5 &  & & \tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption[The best-fit parameters that minimize the errors given by \eqref{eq:v-errors} for the second circle maneuver from DEEPWAVE flight 15.]{The best-fit parameters that minimize the errors given by \eqref{eq:v-errors} for the second circle maneuver from DEEPWAVE flight 15, 4:35:00--4:53:00 UTC, at an altitude of about 6.1 km (20,000 ft). The lines \textquotedbl{}mean of measurements\textquotedbl{}, \textquotedbl{}left-turn measurements\textquotedbl{} and \textquotedbl{}right-turn measurements\textquotedbl{} are based on the wind measurements from the aircraft data system; others are fit results.\label{tab:GS2min}}
\end{table}

\par\end{center}



\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{cccccc}
\toprule   & $\lambda_w\,[^{\circ}]$  & $v$~{[}m/s{]}  & $\delta V$~{[}m/s{]}  & $\delta\psi^{\prime}\,[^{\circ}]$  & residual error {[}m/s{]}\tabularnewline 
\midrule 
\midrule  all turns & 253.7 & 7 & \ensuremath{-0.2} & -0.04 & 1.3\tabularnewline 
\midrule  mean of measurements & 253.7 & 7.2 &  &  & \tabularnewline 
\midrule  left turns & 256.6 & 7.1 & \ensuremath{-0.6} & -0.14 & 1.4\tabularnewline 
\midrule  left-turn measurements & 256.4 & 7.6 &  & & \tabularnewline 
\midrule  right turns & 250.9 & 6.9 & 0.2 & 0.05 & 0.8\tabularnewline 
\midrule  right-turn measurements & 251.1 & 6.8 &  & & \tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption[The best-fit parameters that minimize the errors given by \eqref{eq:v-errors} for the third circle maneuver from DEEPWAVE flight 15.]{The best-fit parameters that minimize the errors given by \eqref{eq:v-errors} for the third circle maneuver from DEEPWAVE flight 15, 5:30:30--5:53:00 UTC, at an altitude of about 9.1 km (30,000 ft). The lines \textquotedbl{}mean of measurements\textquotedbl{}, \textquotedbl{}left-turn measurements\textquotedbl{} and \textquotedbl{}right-turn measurements\textquotedbl{} are based on the wind measurements from the aircraft data system; others are fit results.\label{tab:GS3min}}
\end{table}

\par\end{center}



\subsubsection{Minimizing the variation in measured wind speed in circle maneuvers\label{WS-var-circles}}

\index{maneuver!circle!sinusoidal fit}
The fit results in Tables~\ref{tab:GSmin}--\ref{tab:GS3min} and also the mean measurements of the wind in those tables provide reference angles for the wind direction, so those angles can be used in fits that minimize \eqref{eq:delta-v-m}. Because there is significant variation among the circles, the tabulated values for fitted values for the appropriate set (all turns, left turns, or right turns) will be used as the value of $\lambda_w$ when fitting. An appropriate error function to minimize to find values for the parameters $\delta V$, $\delta\psi^{\prime}$, and $v$ in \eqref{eq:delta-v-m} is $\chi_{2}^{2}=\sum{\delta v_{m}^{2}}$. 

Tables \ref{tab:Circlemin}--\ref{tab:Circle3min} show the fit results for the three circles: 

\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{cccccc}
\toprule   & $v$~{[}m/s{]}  & $\delta V$~{[}m/s{]}  & $\delta\psi^{\prime}\,[^{\circ}]$  & residual error {[}m/s{]} & \tabularnewline 
\midrule 
\midrule  all turns  & 18 & 0.5 & -0.15 & 0.6\tabularnewline 
\midrule  left turns & 18.5 & 0.7 & -0.20 & 0.2\tabularnewline 
\midrule  right turns &  17.5 & 0.2 & -0.10 & 0.2\tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption{The best-fit parameters that minimize the errors given by \eqref{eq:delta-v-m} for the first circle maneuver from DEEPWAVE flight 15, 3:38:30--3:56:30 UTC.\label{tab:Circlemin}}
\end{table}

\par\end{center}



\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{cccccc}
\toprule   & $v$~{[}m/s{]}  & $\delta V$~{[}m/s{]}  & $\delta\psi^{\prime}\,[^{\circ}]$  & residual error {[}m/s{]} & \tabularnewline 
\midrule 
\midrule  all turns  & 22.3 & 0.7 & -0.08 & 0.3\tabularnewline 
\midrule  left turns & 22 & 0.8 & -0.07 & 0.2\tabularnewline 
\midrule  right turns &  22.5 & 0.7 & -0.08 & 0.2\tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption{The best-fit parameters that minimize the errors given by \eqref{eq:delta-v-m} for the second circle maneuver from DEEPWAVE flight 15, 4:35:00--4:53:00 UTC.\label{tab:Circle2min}}
\end{table}

\par\end{center}




\begin{center}
\begin{table}[H] 
\begin{centering}
\begin{tabular}{cccccc}
\toprule   & $v$~{[}m/s{]}  & $\delta V$~{[}m/s{]}  & $\delta\psi^{\prime}\,[^{\circ}]$  & residual error {[}m/s{]} & \tabularnewline 
\midrule 
\midrule  all turns  & 7.1 & \ensuremath{-0.5} & 0.17 & 1.0\tabularnewline 
\midrule  left turns & 7.5 & \ensuremath{-1.1} & 0.37 & 0.7\tabularnewline 
\midrule  right turns &  6.8 & 0.2 & 0.00 & 0.5\tabularnewline 
\bottomrule 
\end{tabular}
\par\end{centering}

\protect\caption{The best-fit parameters that minimize the errors given by \eqref{eq:delta-v-m} for the third circle maneuver from DEEPWAVE flight 15, 5:30:00--5:53:00 UTC.\label{tab:Circle3min}}
\end{table}

\par\end{center}
















Figures \ref{fig:first-circles}--\ref{fig:third-circles} show the mean measurements of wind speed as a function of the angle between the mean wind direction and the adjusted heading representing the motion of the aircraft relative to the air. The two turn directions are shown separately in each figure because they often require a different mean wind speed, as also shown in Tables~\ref{tab:Circlemin}--\ref{tab:Circle3min} where the fit results are tabulated. The fits to \eqref{eq:delta-v-m}, found by minimizing the defined $\chi^{2}$, are also shown in these figures (orange lines). 

\index{maneuver!circle!plotted wind-speed variations}


\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-first-circles-1} 

}

\caption[Measured wind speed from the left-turn and right-turn circles in the circle pattern shown in Fig.\ \ref{fig:circle-tracks}, as a function of the difference between the adjusted heading and the mean wind direction.]{Measured wind speed from the left-turn and right-turn circles in the circle pattern shown in Fig.\ \ref{fig:circle-tracks}, as a function of $\xi$, the difference between the adjusted heading and the mean wind direction. Orange lines are the results of fitting \eqref{eq:delta-v-m} to the measurements, with results as listed in Table~\ref{tab:Circlemin}.}\label{fig:first-circles}
\end{figure}


\end{knitrout}
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-second-circles-1} 

}

\caption[Measured wind speed from the left-turn and right-turn circles in the second circle pattern as a function of the difference between the adjusted heading and the mean wind direction.]{Measured wind speed from the left-turn and right-turn circles in the second circle pattern as a function of $\xi$, the difference between the adjusted heading and the mean wind direction. Orange lines are the results of fitting \eqref{eq:delta-v-m} to the measurements, with results as listed in Table~\ref{tab:Circle2min}.}\label{fig:second-circles}
\end{figure}


\end{knitrout}
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-third-circles-1} 

}

\caption[Measured wind speed from the left-turn and right-turn circles in the third circle pattern as a function of the difference between the adjusted heading and the mean wind direction.]{Measured wind speed from the left-turn and right-turn circles in the third circle pattern  as a function of $\xi$, the difference between the adjusted heading and the mean wind direction. Orange lines are the results of fitting \eqref{eq:delta-v-m} to the measurements, with results as listed in Table~\ref{tab:Circle3min}.}\label{fig:third-circles}
\end{figure}


\end{knitrout}

Some of the fits, notably the left-turn circles from the third maneuver, don't conform very well to the expected sinusoidal error pattern. 
However, if all six are averaged, the mean value for the error in airspeed is 
0.25$\pm$0.32\,m/s and the indicated error in adjusted heading $\psi^{\prime}$ is  
\ensuremath{-0.01} $\pm$ 0.09$^{\circ}$, where the indicated ranges are the standard deviations estimated for the mean values. These are useful constraints on the uncertainty associated with these key contributors to uncertainty in measured wind. 





% \begin{center}
% \begin{table}[H]
% \begin{centering}
% \begin{tabular}{cccccc}
% \toprule 
%  & $\bar{v_{d}}\,[^{\circ}]$ & $\bar{v_{s}}$~{[}m/s{]} & TAS~{[}m/s{]} & $\delta\psi\,[^{\circ}]$ & residual error {[}m/s{]}\tabularnewline
% \midrule
% \midrule 
% all turns & format(round(bestWD,1), nsmall=1) & round(bestWS,1) & round(bestFit[1],1) & round(bestFit[4],2) & format(round(rmsC,1), nsmall=1)\tabularnewline
% \midrule 
% mean of measurements & format(round(mwd,1), nsmall=1) & format(round(mws,1), nsmall=1) & round(mtas,1) &  & \tabularnewline
% \midrule 
% left turns & format(round(bestWDL,1), nsmall=1) & round(bestWSL,1) & round(bestFitL[1],1) & round(bestFitL[4],2) & format(round(rmsL,1), nsmall=1)\tabularnewline
% \midrule 
% left-turn measurements & format(round(mwdL,1), nsmall=1) & round(mwsL,1) & round(mtasL,1) & & \tabularnewline
% \midrule 
% right turns & format(round(bestWDR,1), nsmall=1) & round(bestWSR,1) & round(bestFitR[1],1) & round(bestFitR[4],2) & format(round(rmsR,1), nsmall=1)\tabularnewline
% \midrule 
% right-turn measurements & format(round(mwdR,1), nsmall=1) & round(mwsR,1) & round(mtasR,1) & & \tabularnewline
% \bottomrule
% \end{tabular}
% \par\end{centering}
% 
% \protect\caption{The same results as shown in Table\ \ref{tab:GSmin} but with a time shift applied to the GPS measurements of ground track to advance the measurements by 840\,ms.\label{tab:GSminShift}}
% \end{table}
% 
% \par\end{center}
% 
% The error in heading shown in Table\ \ref{tab:GSmin} approximately reverses sign for right-turn vs left-turn circles. This error would arise if there is a timing error between the measurement of heading and that of ground speed, here obtained from the GPS system (variables GGVEW and GGVNS) of about 0.46\,s, because the turn rate in these turns is about 1.8$^{\circ}$/s so the
% indicated errors of about 1.5$^{\circ}$ suggest that, for both turn directions, advancing the GPS ground-speed measurements by about 0.8\,s would remove the errors from all the circles. Fitting to minimize the residual standard deviation of the fits gave a minimum chisquare for a shift of nbest samples or nbest$\times$40 = 40*nbest\,ms, as shown in Table\ \ref{tab:GSminShift}. With this shift, the indicated errors in heading are all quite small and consistent with expected errors in heading (<0.05$^{\circ}$. The residual error for the right-turn circles, 0.3\,m/s, is also very good; variations of this magnitude were present in the wind field and hence in TAS, so this is as low as could be expected.






% The preceding fit used a constant true airspeed, but it is also possible
% to fit in the same way for an assumed error in true airspeed, by using
% $V=V_{m}+\delta V$ where $V_{m}$ is the measured value and $\delta V$
% is an assumed error in that measurement. There is some small variation
% in measured true airspeed during the maneuver, perhaps created by
% the normal oscillation that results from the flight management system
% and is discussed elsewhere in this report, so this approach may be
% preferable. However, the resulting best-fit values were the same as
% those shown in Table~\ref{tab:GSmin}, to the level of significance
% listed in that table.
% 
% 
% \paragraph{Offsets in TAS and heading}
% 
% An alternate way of determining the offsets in airspeed and heading,
% which illustrates the value of the circle maneuver for developing
% these constraints, is to plot the dependence of measured wind speed
% $v_{s}$ on the heading. The expected variation is for $v_{s}$ to
% change by $2\delta V$ from upwind to downwind flight and by $2V\delta\psi$
% from crosswind-right to crosswind-left flight direction (i.e., 90$^{\circ}$
% right of downwind vs.~90$^{\circ}$ left). The net effect is to produce
% a variation in $v_{s}$ given by:
% 
% \begin{equation}
% v_{s}=\bar{v_{s}}+\delta V\cos\theta+V\delta\psi\sin\theta\label{eq:SinCosDep}
% \end{equation}
% where $\theta$ is the difference between the heading and the wind
% direction.\footnote{As developed later, if there is non-zero sideslip
% the heading and the angle $\theta$ should be corrected by adding $\delta\beta\cos(\phi)$ where $\phi$ is the roll. Also, an error in sideslip will contribute to $\delta\psi$.}%
% Figure \ref{fig:sine-cosine-plot} illustrates the expected
% dependence that would result from errors of $\delta V$ = 1~m/s and
% $\delta\psi=0.3^{\mbox{\ensuremath{\circ}}}$. The plot is constructed
% so that $0^{\circ}$ corresponds to downwind flight and the difference
% between values at 0 and 180$^{\circ}$corresponds to $2\delta V$,
% while the difference from $90$ to 270$^{\circ}$ represents $2V\delta\psi$. 



% It is possible to determine $\delta V$ and $\delta\psi$ by fitting
% (\ref{eq:SinCosDep}) to observations. The measurements will be shown
% separately for the left-turn circles and the right-turn circles because
% a significant difference appears between them as discussed earlier. 
% Figures~\ref{fig:left-turn-circles}
% and \ref{fig:right-turn-circles} show the measurements, and the results
% of the fits are shown in Table \ref{tab:SinCosCoefficients}.%
% \footnote{The values for wind speed are slightly higher than those listed in
% Table~\ref{tab:GSmin}, but the fit is slightly different and preferable
% in Table~\ref{tab:SinCosCoefficients} because measured variations
% in $V$ are included.}%
% 
% 
% \noindent \begin{center}
% \begin{table}
% \noindent \begin{centering}
% \begin{tabular}{ccccc}
% \toprule 
%  & mean wind {[}m/s{]} & $\delta V$~{[}m/s{]} & $\delta\psi\,[^{\circ}]$ & residual error {[}m/s{]}\tabularnewline
% \midrule
% \midrule 
% left-turn circles & format(round(cf1[1],1), nsmall=1) & format(round(cf1[3],1), nsmall=1) & format(round(cf1[2]/(mtas*pi/180),2), nsmall=2) & round(summary(fm1)$sigma,2)\tabularnewline
% \midrule 
% right-turn circles & format(round(cf2[1],1), nsmall=1) & format(round(cf2[3],1), nsmall=1) & format(round(cf2[2]/(mtas*pi/180),2), nsmall=2) & round(summary(fm2)$sigma,2)\tabularnewline
% \bottomrule
% \end{tabular}
% \par\end{centering}
% \protect\caption{Fit results for the left-turn and right-turn circles as fitted by
% (\ref{eq:SinCosDep}).\label{tab:SinCosCoefficients}}
% \end{table}
% \par\end{center}
% A difference of about $0.4^{\circ}$ in heading offset translates
% to a change in wind speed of about 1 m/s at representative GV flight speeds, so small errors
% can be quite significant. Because the wind is more nearly uniform and the pattern of measurements is closer to a pure sinusoidal pattern for the right-turn circles, and because Fig.\ \ref{fig:gs-only-plot} shows better consistency for the two right-turn circles vs the left-turn circles, here the right-turn circles will be emphasized. They indicate that the wind measurements (with time-shifting as discussed above) are quite good, with indicated errors of only 0.2\,m/s in true airspeed and 0.03$^{\circ}$ in heading. For the right-turn circles, the significant departures are for parts of the circles nearly into the wind direction, where the circles start and end, so it may be that those small deviations arise from imperfect flight patterns for those times. Without those parts of the curve, the indicated sinusoidal variation in Fig.\ \ref{fig:right-turn-circles} would be even smaller.
% 
% However, there is a complication in regard to heading that needs further exploration, so the next section will discuss that complication before offering a concluding assessment regarding uncertainty. 
% 

\subsubsection{Offset in sideslip angle\label{sub:Offset-in-Sideslip}}

In the preceding, the error $\delta\psi^{\prime}$ was discussed as an error in adjusted heading, but that adjustment includes the sideslip angle so the error could also be one in sideslip angle. These errors are difficult to separate, and normal sideslip calibration (Sect.~\ref{sub:calibration-SS}) even with reverse-heading maneuvers does not provide a separation. 

The error term determined as in the above tables should be represented by $\delta\psi^{\prime}$ given by 

\begin{equation}
\delta\psi^{\prime}=\delta\psi+\cos\phi\delta\beta\label{eq:dpsiprime} 
\end{equation}
where $\phi$ is the roll angle and $\delta\psi$ and $\delta\beta$ are the offsets in heading and sideslip angle.\footnote{The angle of attack was determined by separate calibration in Sect.~\ref{sub:radome-sensitivity} so that contribution to $\psi^{\prime}$ is not included in the error term.} Because the dependence in (\ref{eq:dpsiprime}) is on the cosine of the roll which is an even function, left and right turns are affected in the same way and also cannot distinguish the two terms in the equation. Even though three different altitudes were used for these circle maneuvers, the GV flight management system maintains nearly the same roll angle for all three maneuvers so changes in roll also cannot be used to distinguish the contributions from heading offset and sideslip offset. 

One approximate test is to compare the sideslip measurement in left vs right turns. The measurements of sideslip angle\footnote{The sensitivity coefficients as determined in Sect.~\ref{sub:calibration-SS} have been used to construct this figure.} are shown in Fig.~\ref{fig:plotSS}. In the turns, some sideslip is introduced as the aircraft configuration remains slightly nose-up during the turn, and by symmetry that sideslip angle should reverse sign when the flight pattern changes from left-turn to right-turn circles. That figure shows that this is approximately characteristic of the measurements, but examination of the pitch and roll angles show small variations so it is useful to obtain a better estimate.


\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-plotSS-1} 

}

\caption[Measurement of sideslip during the first circle maneuver from DEEPWAVE fight 15.]{Measurement of sideslip during the first circle maneuver from DEEPWAVE flight 15, with left-turn circles from 3:40:00 -- 3:46:00 UTC, followed by a straight segment and then right-turn circles 3:47:30 -- 3:53:40 UTC.}\label{fig:plotSS}
\end{figure}


\end{knitrout}

%The mean value for the full maneuver, and the average of the right-turn and left-turn circles, both indicate that there is no offset in the sideslip angle.  
% This is a forced result, though, because the sensitivity
% coefficients for sideslip have been adjusted from a preliminary version of
% this plot to give symmetry, and an adjustment of 0.07$^{\circ}$ was required. 
% However, this approach is sensitive to any variations in pitch, and there were small but significant variations in pitch in the maneuvers.\footnote{This was first noticed in circle maneuvers by the C-130, where pitch variations are more significant during circles and this approach is necessary.} 
A better approach is to take into account the influence of all angles on vertical wind. The transformation equations from \citet{Bulletin23} (see also \citet{NCAR_OpenSky_TECH-NOTE-000-000-000-064}), with some small-angle simplifications, lead to this equation for the vertical wind: 

\begin{equation}
u_{z}=w_{p}+V(\sin\phi\tan\beta+\cos\phi\tan\alpha-\sin\theta)\label{eq:vwind-eq-for-SS} 
\end{equation}
where $w_{p}$ is the vertical motion of the aircraft, $V$ is airspeed, $\phi$ the roll angle, $\beta$ the sideslip angle, $\alpha$ the angle of attack, and $\theta$ the pitch angle. If it is assumed that the vertical wind is zero, in the circle maneuver this equation predicts that the sideslip angle will be $\beta^{*}$ given by\\ 
\begin{equation}
\beta^{*}\approx\frac{\theta-\alpha\cos\phi-(w_{p}/V)}{\sin\phi}\,\,\,.\label{eq:beta-from-other-measurements} 
\end{equation}
This is not useful in straight flight where the roll is near zero, but it provides a valid equation for sideslip angle in the case of steady turns. The key assumption is that the vertical wind is zero; a vertical wind of 0.1\,m/s will typically increase the deduced sideslip angle from this equation by about 0.06$^{\circ}$, so it is important that the circle maneuver be flown where there is no mean updraft. It is then possible to determine the offset in sideslip angle by comparing this prediction to the measured sideslip angle $\beta_{m}$:\\ 
\begin{equation}
\delta\beta=\beta_{m}-\beta^{*}\,\,.\label{eq:predicted-error-in-sideslip} 
\end{equation}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-sideslip-error-histogram-1} 

}

\caption[Distribution of measurements of sideslip error determined from (\ref{eq:predicted-error-in-sideslip}) for all measurements in turns from the three circle maneuvers.]{Distribution of measurements of sideslip error determined from (\ref{eq:predicted-error-in-sideslip}) for all measurements in turns from the three circle maneuvers. Each point in the histogram is the calculated error using one of the 1-Hz measurements from the circle maneuvers.}\label{fig:sideslip-error-histogram}
\end{figure}


\end{knitrout}

Measurements of this estimate of the sideslip error are shown in Fig.~\ref{fig:sideslip-error-histogram}. The mean error is 0.084$^{\circ}$, which  should be subtracted from the sideslip measurements.\footnote{The value is the measurement error so the required correction is the negative of that value.} 
% This result differs from the indication from Fig.\ \ref{fig:plotSS}, where no offset was required. The uncertainty in the estimated mean of this result is very low, and this result is more general because it uses measured values of the pitch, so this value will be used to correct the sideslip offset. 
This indicates that the sideslip sensitivity coefficients should be modified from those initially found in Sect.~\ref{sub:radome-and-gust-pod-beta} to these revised values:\label{page:SSoffset} \{$e_{0}$,\, $e_{1}$\} = \{0.008, 22.302\}. Because this result is dependent on the vertical wind being zero, an uncertainty of at least 0.03$^{\circ}$ should be assigned to the first coefficient to recognize that the vertical wind might typically be $\pm$0.05\,m/s in a region such as this.% %msrmt 0.1, but biased/unreliable in high-bank turn? 

%This result was obtained from files where a heading offset of -0.08$^{\circ}$ had been imposed. 
The results of the circle analyses thus point to a combined error from heading and sideslip angle of \index{heading!offset in}\index{sideslip!offset in}%
\ensuremath{-0.01}$\pm$0.09$^{\circ}$, so the mean heading error  calculated from \eqref{eq:dpsiprime} is 
\ensuremath{-0.09}$\pm$0.09$^{\circ}$. 
The required heading correction is then the negative of this value, and the result of this calibration is to make compensating adjustments in the offsets for heading and sideslip. 

% As a consistency check, we repeat the fit determining TAS and heading offsets after adjusting the sideslip measurements by the indicated correction. 
% 
% With this shift applied, the dependence of the left-turn and right-turn
% circles is shown in Fig.~\ref{fig:combined-circles}. The mean value of sideslip
% for the circle maneuvers is yrm; for left turns yrL and for right turns yrR. 



% The best-fit coefficients are as shown in the following table, where
% the values for left-turn-only and right-turn-only measurements are
% repeated:
% 
% \noindent \begin{center}
% \begin{tabular}{|c|c|c|c|c|}
% \hline 
%  & mean wind {[}m/s{]} & $\delta V$~{[}m/s{]} & $\delta\psi\,[^{\circ}]$ & residual error {[}m/s{]}\tabularnewline
% \hline 
% \hline 
% left-turn circles & round(cf1[1],1) & format(round(cf1[3],1), nsmall=1) & format(round(cf1[2]/(mtas*pi/180.),2), nsmall=2) & round(summary(fm1)$sigma,2)\tabularnewline
% \hline 
% right-turn circles & round(cf2[1],1) & format(round(cf2[3],1), nsmall=1) & format(round(cf2[2]/(mtas*pi/180.),2), nsmall=2) & round(summary(fm2)$sigma,2)\tabularnewline
% \hline 
% combined & round(cfc[1],1) & format(round(cfc[3],1), nsmall=1) & round(cfc[2]/(mtas*pi/180.),2) & round(summary(fmc)$sigma,2)\tabularnewline
% \hline 
% \end{tabular}
% \par\end{center}
% 
% The airspeed correction as applied differently to the two turn directions
% leads to one aspect of consistency in the measurements: The mean TAS,
% originally higher in the left turns but after correction higher in
% the right turns, conforms to the expected difference required by the
% higher absolute value of the roll angle in right vs left turns. If
% the lift $L$ is proportional to $V^{2}$ as expected, and $L\propto V^{2}\cos\phi$
% remains constant, the (from the total derivative of this expression)
% 
% \[
% \frac{2}{V}\delta V=-\frac{\sin\phi}{\cos\phi}\delta\phi
% \]
% \[
% \delta V=-\frac{V\tan\phi}{2}\delta\phi\simeq+0.11
% \]
% (i.e., an increase in roll of round(rmeanR+rmeanL,1)$^{\circ}$,
% as is the case for the right turns, leads to an expected increase
% in $V$ of round(dv,2)  while the corrected values for V
% for the left and right turns, respectively, are round(tasmL+cf1[3],2)
% and round(tasmR+cf2[3],2). The difference between the uncorrected
% measurements, round(tasmR-tasmL,2), has the opposite sign,
% while after correction the difference conforms to expectations for
% an increased roll angle.



% One correction that could lead to more consistency in the measurements
% is to impose a time shift in the measured ground-speed components
% from the GPS. The delayed measurements will be offset in different
% directions as the direction of the turns changes. For this reason,
% a time shift was introduced in the GPS-measured ground-speed components
% and the wind components were recalculated. The minimum-residual-error
% solution was for a shift of 240~ms; i.e., the measurements GGVNS
% and GGVEW were applied 240 ms ahead of where they were originally
% recorded in the data files.%
% \footnote{No offset was introduced in that original processing for these components.
% For THDG, the heading variable, an offset was introduced of 80~ms
% to account for the expected transmission time of the measurement from
% the IRU to the data system, so the best-fit lag between heading and
% ground speed is 160 ms. If the lag in THDG is changed, the lag in
% GGVEW and GGVNS should be changed also.%
% } In addition, the mean wind speed for left turns and separately for
% right turns was subtracted from the measured wind speed to compensate
% for the real difference in wind speed determined above, so the results
% could be combined in one plot. The standard residual error from the
% fit to the shifted measurements after this adjustment was reduced
% to round(summary(fms)$sigma,1)~m/s, which seems reasonable
% because (as shown in Fig.~\ref{fig:plot-time-shift}), the residuals
% could arise from real fluctuations in wind or in the precision of
% the circular flight track. The best-fit results were $\delta V=$format(round(cfs[3],1), nsmall=1)
% m/s and $\delta\psi=$round(cfs[2]/(mtas*pi/180.)-0.07,2)$^{\circ}$. 




 


\subsubsection{Summary\label{sub:HWsummary}}

The results obtained from analysis of the circle maneuvers are these:\index{maneuver!circle!summary of results} 

\begin{enumerate}
\item The circle maneuvers indicate that the measured airspeed (TASF)\sindex[var]{TASF>@TASF} with current LAMS-based pressure corrections is accurate to within expected uncertainty. The fits indicate an error in airspeed 
of 0.25$\pm$0.32\,m/s,% 
%0.2$\pm 0.3$\,m/s, 
which is within the expected ($\pm$0.3\,m/s) uncertainty limits for TAS deduced using the LAMS calibration (\citet{CooperEtAl2014}). The uncertainty range covers the calibrated value, so it appears better to make no adjustment to airspeed.  
\item The indicated error in sideslip is 0.084$^{\circ}$, so the first sensitivity coefficient should be reduced by this amount. That leads to sensitivity coefficients for the radome of  \{0.008, 22.302\}. Cf.\ the discussion in Section\ \ref{sec:Calibrations} and the summary section \ref{CalSSsummary} at the end of that section. It appears reasonable to consider that the bias in this measurement may be uncertain by about 0.03$^{\circ}$ because the mean offset is determined with this standard deviation from the combination of the available circle maneuvers and this is also the sensitivity to 0.05\,m/s vertical wind during the maneuvers. 
\item With the preceding sensitivity coefficients, an offset should be introduced to heading of magnitude 
0.09$\pm$0.09$^{\circ}$. 
The evidence from the circle fits is that the combined bias associated with the heading and sideslip offsets is \ensuremath{-0.01}$\pm$0.09$^{\circ}$. 
%0.02$\pm 0.09^{\circ}$, %
The heading and sideslip offsets are coupled, so the two offsets indicated by the circle fits should be used together.  
\item The results are consistent with no time offset in the GPS measurements of ground speed\index{speed of aircraft!ground speed} (GGVEW\sindex[var]{GGVEW>@GGVEW} and GGVNS).\sindex[var]{GGVNS>@GGVNS} 
\end{enumerate}

\vfill\eject



\subsection{The complementary filter\label{sub:comp-filter}}

\subsubsection{Use in past projects}

Wind measurements combine a measurement of relative wind with a measurement \index{filter!complementary}\index{wind!horizontal!correction for IRU errors in ground speed}\index{speed of aircraft!ground speed} of aircraft motion to determine the air motion relative to the ground. The aircraft motion is measured independently by an IRU and also by a GPS receiver. These have complementary strengths: The IRU provides very good information on short-term motion but drifts with a characteristic period of more than an hour, while the GPS provides good absolute accuracy but sometimes is unable to receive the GPS signals and (except in differential-GPS mode) can have short-term errors that make short segments of the track look jagged. To take advantage of the strengths of each, a complementary-filter calculation was developed and implemented in the 1980s. This section provides documentation of a procedure that has been in use for many years and also describes proposed changes to that procedure.

To combine these measurements, a low-pass filter,\sindex[lis]{Fl@$F_{L}$=low-pass filter applied to GPS ground-speed measurements}\sindex[lis]{Fh@$F_{H}$=high-pass filter applied to IRU ground-speed measurements} $F_{L}(\{\mathrm{GGVNS,GGVEW\}})$,\sindex[var]{GGVEW>@GGVEW}\sindex[var]{GGVNS>@GGVNS} is applied to the GPS measurements of ground speed,\index{speed of aircraft!ground speed} \{GGVNS,GGVEW\}, which are assumed to be valid for frequencies at or lower than the cutoff frequency\sindex[lis]{fc@$f_{c}$=cutoff frequency for filters used for complementary filtering} $f_{c}$ of the filter. Then the complementary high-pass filter, denoted ($1-F_{L}$)($\{\mathrm{VNS,VEW\}}$), is applied to the IRU measurements of ground speed, \{VNS,VEW\},\sindex[var]{VNS>@VNS}\sindex[var]{VEW>@VEW} which are assumed valid for frequencies at or higher than $f_{c}$. Ideally, the transition frequency would be selected where the GPS errors (increasing with frequency) are equal to the IRU errors (decreasing with frequency). The filter used historically was a three-pole Butterworth low-pass filter, coded following the algorithm described in \citet{Bozic1980}, p. 49. 




%
%In 2014 this was changed to use the Butterworth filter coefficients given by the R routine 'butter' for the corresponding filter function, because it was found that the previous digital filter introduced a mean shift in the measurements. 
The digital filter used is recursive, not centered, to permit calculation during a single pass through the data. If the cutoff frequency lies where both the GPS and INS measurements are valid and are almost the same, then the detailed characteristics of the filter in the transition region (e.g., phase shift) do not matter because the complementary filters have cancelling effects when applied to the same signal. The standard transition frequency $f_{c}$ was chosen to be (1/600) Hz. The Butterworth filter was chosen because it provides flat response away from the transition. The resulting variables for aircraft motion, \{VNSC,VEWC\},\sindex[var]{VNSC>@VNSC}\sindex[var]{VEWC>@VEWC} are then each the sum of two filtered signals, calculated as described in the following box:\index{filter!complementary!algorithm}\\ 
 %
\fbox{% 
\begin{minipage}[t]{0.95\textwidth}% 
VEW = IRU-measured east component of the aircraft ground speed\\  VNS = IRU-measured north component of the aircraft ground speed\\  GGVEW = GPS-measured east component of the aircraft ground speed\\  GGVNS = GPS-measured north component of the aircraft ground speed\\  $F_{L}()$ = three-pole Butterworth low-pass recursive digital filter\\ 
 \\
 \rule[0.5ex]{1\linewidth}{1pt} 

\[
\{\mathrm{VNSC}\}=\{\mathrm{VNS}\}+F_{L}(\mathrm{\{GGVNS\}-\{\mathrm{VNS\}})}
\]
\[
\{\mathrm{VEWC}\}=\{\mathrm{VEW\}+}F_{L}(\mathrm{\{GGVEW\}-\{\mathrm{VEW}\})}
\]
%
\end{minipage}}
\sindex[var]{GGVEW>@GGVEW}\sindex[var]{GGVNS>@GGVNS}\sindex[var]{VNS>@VNS}\sindex[var]{VEW>@VEW}

This is straightforward and effective when both sets of measurements (IRU and GPS) are available. The approach in use becomes more complicated when the GPS signals are lost, as sometimes happens in sharp turns. Then some means is needed to avoid sudden discontinuities in velocity (and hence wind speed), which would introduce spurious effects into variance spectra and other properties dependent on a continuously valid measurement of wind. To extrapolate measurements through periods when the GPS measurements are not available, a fit was determined to the difference between the best-estimate variables \{VNSC, VEWC\}\sindex[var]{VNSC>@VNSC}\sindex[var]{VEWC>@VEWC} and the IRU variables \{VNS,VEW\}\sindex[var]{VNS>@VNS}\sindex[var]{VEW>@VEW} for the period before GPS reception was lost, and that fit was used to extrapolate through periods when GPS reception is not available. The procedure is described in section 3.4 of \href{https://drive.google.com/file/d/0B1kIUH45ca5ATFV5d3QyQ0JpSjA/view?usp=sharing}{this document on processing algorithms}. 

\subsubsection{Recommended changes}

Because current measurements provided by GPS are so much better than when the filter was introduced, it seems appropriate to reconsider the response time used for the filter or even if the filter is still needed. A problem has also been found with the filter function, shown below. For these reasons, the use of the complementary filter is revisited in the remainder of this section.

The cutoff frequency should be selected to lie in a region where the signals are matched. Figure \ref{fig:FFTVEW} shows an example of the variance spectra for GGVEW\sindex[var]{GGVEW>@GGVEW} and VEW\sindex[var]{VEW>@VEW} from a level segment of GV boundary-layer flight. The two spectra
are essentially identical for most frequencies, with some deviation around 0.4~Hz. The coherence between these two signals, shown in Fig.~\ref{fig:coherence-plot}, indicates near-unity coherence for frequencies below 0.1\,Hz, and the corresponding phase through this region (not shown) is also near zero, so an appropriate choice is a frequency in the upper part of this range but still far enough below 0.1\,Hz that the transition region for the filter does not have significant residual transmission at that frequency.

\begin{figure}
\noindent \begin{centering}
\includegraphics[width=\maxwidth]{SpecialGraphics/FFTVEW}
\par\end{centering}
\protect\caption[Variance spectra for the eastward component of aircraft motion as measured by GPS and by IRU.]{Variance spectra for the eastward component of aircraft motion as measured by GPS (GGVEW) and for the corresponding measurement from the IRU (VEW). Data are from IDEAS-IV-GV flight 6 on 13 Oct 2013, 20:03:30--20:11:50 UTC. FFT spectral analysis was used, with 50\,Hz measurements, combining segments of 8192 points, and the resulting spectra were smoothed by averaging in 75 bins equally spaced in the logarithm of the frequency.\label{fig:FFTVEW}} 
\end{figure}
\sindex[var]{GGVEW>@GGVEW}\sindex[var]{VEW>@VEW}

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-coherence-plot-1} 

}

\caption{Coherence between the measurements GGVEW and VEW (cf.~Fig.~\ref{fig:FFTVEW}) as a function of frequency.}\label{fig:coherence-plot}
\end{figure}


\end{knitrout}

Figure~\ref{fig:CF-response} shows the frequency response of the filter that was used. The amplitude of the signal transmitted by the digital filter was measured by applying filters with varying cutoff frequencies to a sine-wave time series, so these are measured rather than theoretical characteristics. 
Two problems are evident in this figure. 
First, the amplitude of the response at low frequency is not unity but about 
11\% larger, leading to a bias when this filter is used. 
When used as a complementary filter, this does not introduce an error as long as the two values being filtered are the same, but if they are not (e.g., as a result of Schuler oscillation in VEW\sindex[var]{VEW>@VEW}) about 11\% of that difference is transmitted by the filter. 
Second, the cut-off frequency differs from that prescribed, occurring at a frequency about 60\% higher than expected. 
This suggests that the filter being used should be replaced by another filter, such as for example the Butterworth filter provided by the R package "signal", which was used to construct the response curve shown as the blue line in Fig.~\ref{fig:CF-response}.

\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/WU-CF-response-1} 

}

\caption[Amplitude of the signal transmitted by two low-pass filters, shown as a function of the ratio of the frequency ]{Amplitude of the signal transmitted by two low-pass filters, shown as a function of the ratio of the frequency $f$ to the cutoff frequency $f_c$. The blue line is the Butterworth third-order filter provided by the 'signal' package in R, and the red line is the filter previously used for processing.}\label{fig:CF-response}
\end{figure}


\end{knitrout}

A good choice for the cutoff frequency is thus $f_c=0.04$\,Hz. This gives low transmission at frequencies where the coherence decreases yet provides good response to changes like that expected from the Schuler oscillation. The approach suggested for future calculation of variables like VEWC\sindex[var]{VEWC>@VEWC} is then to apply this new filter as before. When calculating wind, the GPS measurements alone appear to be good candidates also, but new variables like VEWC  will likely be the best choice.

% plan: show var. spec. e.g. from WINTER #6 leg, with coherence; argue for small tau.

% The following provides more documentation of the fit procedure used to determine the Schuler oscillation. The errors are assumed to result primarily from this oscillation, so the three-term fit is of the form\index{oscillation!Schuler!angular velocity} $\delta x=h_{1}+h_{2}\sin(\Omega_{Sch}t)+h_{3}\cos(\Omega_{Sch}t)$ , where $\Omega_{Sch}$ is the angular frequency of the Schuler oscillation (taken to be $2\pi/(5067\,s))$ and $t$ is the time since the start of the flight. A separate fit is used for each component of the velocity and each component of the position (discussed below under LATC and LONC). The fit matrix used to determine these coefficients is updated each time step but the accumulated fit factors decay exponentially with about 30-min decay constant, so the terms used to determine the fit are exponentially weighted over the period of valid data with a time constant that decays exponentially into the past with a characteristic time of 30 min. This is long enough to determine a significant portion of the Schuler oscillation but short enough to emphasize recent measurements of the correction. The procedures for accumulating the matrices for the fit are as follows:\\ 
%  \\
%  %
% \fbox{% 
% \begin{minipage}[t]{0.9\columnwidth}% 
% Define $u_{G}$ as the aircraft eastward velocity measured by the GPS and $u_{I}$ the corresponding velocity measured by the IRU, so that the difference is 
% 
% \[
% \delta u=u_{G}-u_{I} 
% \]
% If $\Omega_{S}$ is the Schuler oscillation period, with $\Omega_{S}=2\pi t/T_{s}$ where $T_{s}=5067$ s, $\tau_{u}$ is the time constant for the update (1800 s), $t$ is the time from the start of the flight, and the measurement matrix is $A_{ij}$, then updated terms of the measurement matrix each sample period ($A_{i,j}^{\prime}$) are (for $\delta u$): 
% 
% \[
% A_{0,1}^{\prime}=A_{0.1}(1-\frac{1}{\tau_{u}})+\delta u 
% \]
% \[
% A_{1,1}^{\prime}=A_{1,1}(1-\frac{1}{\tau_{u}})+\delta u\,\sin(\Omega_{S}t) 
% \]
% \[
% A_{2,1}^{\prime}=A_{2,1}(1-\frac{1}{\tau_{u}})+\delta u\,\cos(\Omega_{S}t) 
% \]
% 
% 
% The matrix components $A_{j,0}$ apply to the northward velocity component and so are represented by the same equations with $\delta u$ replaced by $\delta v$. Similar matrices are calculated for latitude $\theta$ and longitude $\phi$, based on the differences $\delta\theta$ and $\delta\phi$ between GPS and IRU measurements. The information matrix $H_{ij}$ is calculated via 
% 
% \[
% H_{i,j}=H_{i,j}(1-\frac{1}{\tau_{u}})+V_{i,j} 
% \]
% 
% 
% where $V_{0,0}=1$, $V_{0,1}=V_{1,0}=\sin(\Omega_{S}t)$, $V_{0,2}=V_{2,0}=\cos(\Omega_{S}t)$, $V_{1,1}=\sin^{2}(\Omega_{S}t)$, $V_{1,2}=V_{2,1}=\sin(\Omega_{S}t)\cos(\Omega_{S}t)$, and $V_{2,2}=\cos^{2}(\Omega_{S}t)$. When the fit is needed, the matrix $H_{i,j}$ is inverted and the result multiplied by the measurement matrix $A_{i,j}$ to get the fit coefficients $C_{ij}$ to use for predicting the results for $\delta u$, $\delta v$, $\delta\theta$, 
% and $\delta\phi$ via equations like $\delta u=C_{0,1}+C_{1,1}\sin(\Omega_{S}t)+C_{2,1}\cos(\Omega t)$.% 
% \ENDDIF{minipage}} % \end{document}
% % \end{document}

\appendix


%% LyX 2.1.3 created this file.  For more info, see http://www.lyx.org/.


% define format for exercises and examples:

\newcount\exernumber \exernumber=1 
\newcount\examnumber \examnumber=1
\global\long\def\beginexercise{\bigskip\goodbreak\hrule\nobreak\smallskip\nobreak\hrule\nobreak\bigskip\sl\nobreak
{\bf \noindent EXERCISE \arabic{chapter}.\the\exernumber:\enspace}\advance\exernumber by 1}
 \global\long\def\endexercise{\nobreak\bigskip\nobreak\hrule\nobreak\smallskip\nobreak\hrule\nobreak\bigskip\goodbreak{\rm }}
 \global\long\def\beginexample{\bigskip\goodbreak\nobreak\hrule\nobreak\smallskip\nobreak\hrule\nobreak\bigskip\sl\nobreak{\bf \noindent EXAMPLE:\enspace}\advance\examnumber by 1}
 \global\long\def\endexample{\endexercise}

\section{Uncertainty-analysis conventions}

\index{analysis of uncertainty!conventions used}
So that this document might serve as a template for future analyses of uncertainty in NCAR/RAF measurements, this appendix documents some of the conventions followed here and suggested for standardized use. 


\subsection{Why perform analyses of uncertainty?}

When measurements are made to test scientific theories, provide input to models, or characterize nature, they are only useful if accompanied by some sense of their reliability. A key use of uncertainty analysis is to provide this sense, in as quantitative terms as can be justified. A quoted value should be considered incomplete unless accompanied by some sense of the associated uncertainty, preferably in the form of estimated confidence limits to be associated with measurements or to be propagated to final scientific results. Although it is usually impossible in a strict statistical sense to provide formal estimates of confidence limits, this target still underlies approaches to uncertainty analysis. If those who make measurements don't characterize their reliability, others must make their own (probably less informed) evaluations. 

There are additional benefits of analyzing measurement uncertainty. If an uncertainty analysis is done before an experiment, it may suggest ways to refine the experiment to minimize critical uncertainty contributions, and it should be possible to judge if the desired uncertainty is attainable. An uncertainty analysis also highlights the dominant sources of error and so can guide efforts to improve instruments. 


\subsection{Error, accuracy, and uncertainty}

The \emph{error} in a measurement is the difference between the measurement and the correct value of the measurand. A measurement is of little use unless there is some way of estimating how large this error may be. This estimate is called the \emph{uncertainty}.\footnote{Results are sometimes classified according to their use: \textit{indication} based only on primary measures such as sample means or correlation coefficients; \textit{determination} based on primary and secondary statistics, so that some estimate of uncertainty is obtained; and 
\textit{inference}, in which a specific mathematical model is used to assess uncertainty quantitatively. Often, a considerable amount of information about the underlying distribution must be known (or assumed) before statistical inference is possible. Experimental results are usually appropriately quoted as determinations.} The uncertainty usually can be estimated in some way from knowledge of the performance of an instrument or from calibrations, inter-comparisons, or statistical analysis of repeated measurements of the same quantity. 

The term \emph{accuracy} is often used erroneously where \emph{uncertainty} would be appropriate. \emph{Accuracy} is determined by the presence or absence of error, not uncertainty; a measurement may by chance be accurate and still have a large uncertainty. \emph{Measurement} 
\emph{uncertainty} is the correct term for an estimate of the limits to the experimental error; it is incorrect to refer to this as the measurement \emph{accuracy,} although that is unfortunately common usage. \emph{Accuracy} is sometimes used to refer to error, not uncertainty, but because accuracy is an absolute term even this usage is best avoided. A measurement will either be accurate or not. 


\subsection{International standards}

Many different measures are used to characterize measurement error, often making it difficult to determine which interpretation should be associated with a quoted uncertainty. However, there is now an established international consensus, defined by the International Organization for Standardization (ISO)\sindex[var]{ISO=International Organization for Standardization} and by the US National Institute of Standards and Technology (NIST)\sindex[var]{NIST=National Institute of Standards and Technology}\sindex[var]{US=United States}, and this or modified forms have also been adopted by many engineering societies. After decades of debate within engineering societies and among international groups, this methodology  finally reached standardization through the recommendations of the International Committee on Weights and Measures. The two key publications now defining these standards are the \href{http://www.iso.org/iso/iso_catalogue/catalogue_ics/catalogue_detail_ics.htm?csnumber=50461}{Guide to the Expression of Uncertainty in Measurement}(often referred to as the ``GUM'')\sindex[var]{GUM=Guide to the Expression of Uncertainty in Measurement}\index{GUM}\index{Guide to the expression of uncertainty in measurement} and NIST Technical Note 1297\index{NIST Technical Note1297} {[}1994 revision{]}, \href{http://www.nist.gov/pml/pubs/tn1297/index.cfm}{\textquotedblleft Guidelines for Evaluating and Expressing the Uncertainty of NIST Measurement Results.\textquotedblright}The latter is available in full from the web link and will be the primary reference followed in this document.\footnote{While the methodology described here is consistent with recommendations from those publications, it seems appropriate in addition to advocate separate estimation of the uncertainty associated with systematic errors because the validity of such estimates often depends on judgment and so is much harder to defend than in the case of random error.} 


\subsection{Classification of sources}
\subsubsection{Errors}

\label{sec:Classification-of-sources}Errors are often classified as ``systematic'' or ``random,''\index{error!systematic}\index{error!random}\index{bias} the former arising from consistent and repeatable sources (like an offset in calibration) and the latter from fluctuations about the measurand that are expected to average to zero in a repeated series of measurements. The former are also called ``biases'' when they arise from characteristics of an instrument. It is straightforward to differentiate these error classes by this test: Random errors are reduced when an experiment is repeated many times and the results averaged together, while systematic errors remain the same. Systematic errors can be reduced by better equipment or better calibration or better experimental procedures. Figure \ref{fig:IllustrationOfTerms} illustrates these terms. 

\begin{figure}[H] 
\noindent \begin{centering}
\includegraphics[width=11cm]{SpecialGraphics/A-figure1.png}  
\par\end{centering}

\protect\caption[Illustration of the separate effects of bias errors and random errors.]{\emph{\label{fig:IllustrationOfTerms}Illustration of the separate effects of bias errors and random errors. The true population mean is $\mu$, but an instrument is used that has a bias $b$ and measures with random error (in each observation) $\sigma$. The resulting estimate of the mean, obtained from $\overline{x}$, is in error because of the separate contributions of the bias error $b$ and the random error in the measurement of the mean, in this case $(\overline{x}-a)$. The precision of the instrument is $\sigma$, so the estimated random error in the mean is $\sigma/{N}^{1/2}$. The actual error in an experiment is the difference between the true value $\mu$ and the measured value $\overline{x}$. The histogram represents a frequency distribution measured in a particular experiment, with mean shown as the solid line labeled $\overline{x}$. In a large number of observations, it would be expected that the results would tend toward the smooth dashed curve with mean $a=\mu+b$. The measured standard deviation is $s$, but the limiting value for a large number of measurements is expected to be $\sigma$.} } 


\end{figure}

\subsubsection{Uncertainties}

Like errors, estimates of \emph{uncertainty} are also classified into two categories, ``Type-A'' (evaluated by statistical methods) and ``Type-B'' (evaluated by other means). 


A Type-A \index{evaluation of uncertainty!type-A}evaluation of uncertainty is based on statistical analysis of repeated measurements or knowledge of the statistical character of the observations. Standard statistical measures and approaches including the standard deviation, analysis of variance, propagation of error, etc., can provide the needed estimate. For example, the standard deviation $s_{i}$ in repeated measurements of the same quantity leads to an estimate of standard uncertainty  $u_{i}=s_{i}$. Statistical means can also provide the required estimate of the degrees of freedom associated with the standard uncertainty. 

Two important points need to be made in regard to Type-A evaluations:  
\begin{enumerate}
\item ``Type-A'' refers to how the estimate is obtained, not to the type of error. Type-A evaluations often result in estimates of systematic error. For example, a random error affecting calibration of an instrument can subsequently produce a systematic error when the instrument is used, but the uncertainty can still be estimated via a Type-A evaluation. This uncertainty component is therefore Type-A, even though the associated error being characterized is systematic. This has sometimes been called ``fossilization'' of error: The random error in the calibration procedure becomes a bias when that calibration is used.  
\item Variability in a measurement may result from random measurement error, but it also may result from variability in the quantity being measured. Variations in a measurement arising from true variation in the quantity being measured cannot be used to estimate random measurement error, although they may place upper limits on that error. When using a standard deviation in repeated measurements to estimate standard uncertainty, it is necessary to correct for any contribution from natural variability.  
\end{enumerate}
A particularly clear example of a Type-A evaluation leading to a proper estimate of precision is that where the measurement consists of counting discrete events, such as cloud droplets or particles. The uncertainty in such measurements is expected to be characterized by Poisson statistics if the events occur at times determined from random distribution of the droplets in space. 

\index{evaluation of uncertainty!type-B}A Type-B evaluation of standard uncertainty is more dependent on judgment and experience so it is harder to defend than a Type-A evaluation. Some guidance can be obtained from the following, but it must be acknowledged that these are imperfect and not quantitative, so another analyst with different judgment and experience could well disagree with the estimate. In place of statistical measures, information obtained from inter-comparisons with other instruments, performance against standards,  repeated calibrations, stability of the measurements, and specifications of components can all contribute to Type-B estimates of uncertainty. Nevertheless, it is useful to attempt to make Type-B evaluations that are as far as possible comparable to Type-A evaluations. For example, it is a goal that the ``coverage'' of the estimate be comparable to a standard deviation. The following may provide some guidance when developing such estimates:  
\begin{itemize}
\item If the error source is expected to be within the limits $\pm a$ 50\% 
of the time, then $u_{j}\approx1.5a$.   
\item If it is expected to be within those limits about 2/3 of the time, then $u_{j}\approx a$.  
\item If the quantity is expected to be within those limits 100\% of the time, but equally probable anywhere in this range, then use $u_{j}\approx a/\surd3$.  
\item If the limits are interpreted as 3-standard-deviation limits, then $u_{j}\approx a/3$. (The NIST TN and GUM provide other examples also.) 
\end{itemize}

\subsection{The composite or net uncertainty}

The tabulated standard uncertainties should then be combined to a single standard uncertainty, $u_{c}$, which incorporates all sources of uncertainty.  Where possible, degrees of freedom should also be provided. The recommended uncertainty to quote with results is the standard uncertainty $u_{c}$; this is a departure from earlier practice, favoring two standard deviations or 95\% confidence limits.\footnote{``Confidence limits'' should only refer to Type-A evaluations; the term ``coverage probability'' is sometimes used to emphasize the difference between Type-B evaluations and those obtained via statistical analysis.} NIST continues to accept such estimates also, and uses the term\emph{ expanded uncertainty} (symbol $U$) such that $U=2u_{c}$. 

% Contributions to \emph{uncertainty} (as opposed to error) are classified into two types: "Type-A" (which can be evaluated by statistical methods) and "Type-B" (which must be evaluated by other methods. These types often correspond to random or systematic \emph{error sources}, respectively, but the correspondence can be misleading because the type of uncertainty refers to how the error limit is estimated. For example, there may cases where a statistical method can be used to estimate a bias error, for example when a calibration method can be studied by repeated comparison to a standard but, once determined, becomes a fixed bias as applied to subsequent measurements by an instrument.
%
% It is awkward that often the most troublesome uncertainties encountered in experimental research are Type-B uncertainties. Digitization noise\footnote{I.e., the error that results when a continuously varying measurement is measured by a digital instrument that must round the measurement to the nearest digital value.} and the errors introduced when counting finite numbers of events\footnote{When, for example, the average measurement might be the possibly fractional value $x$ but the actual value must be an integer.} are among the good examples of Type-A errors in modern experiments.\footnote{The prevalence of systematic error is a particularly compelling reason to follow the methodology advocated here, because that approach features parallel treatment of systematic and random errors and focuses attention on their different characteristics. These separate error sources should be investigated and treated in different ways, and should be reported separately.} Analyses of uncertainty are made more difficult when the most important uncertainties are Type-B, as is the normal case.
% Evaluation of uncertainty for Type-B sources is often subjective, based on judgment, and hard to quantify or defend rigorously. Repeated calibrations, intercomparisons among different instruments, and long-term stability of the calibrations can all provide information on Type-B uncertainty. 

Error contributions thought to be random may really be systematic, and evaluating their associated uncertainty via Type-A methods may not reveal that dependence. An example often cited as a possible source of random error is a dependence of an instrument on line voltage, causing fluctuations in the response function of an instrument during an experiment. However, line voltage fluctuations are seldom random, and are probably biased in a particular direction relative to the conditions at the time of calibration, so it is likely that in a given experiment or series of experiments such fluctuations will introduce a bias. Furthermore, such errors are likely to be correlated in time, so the usual procedure of assuming random error contributions to be independent for different measurements will not be valid. Estimating the associated uncertainty via standard Type-A methods can thus be misleading in such a case. Close inspection of other common sources of error shows that they are often biases, and this increases the importance of estimating the associated uncertainty appropriately.  


\subsection{Recommended Guidelines}

\index{analysis of uncertainty!recommended reporting guidelines}
These are central features of the methodology recommended and used here:  
\begin{enumerate}
\item Components introducing uncertainty are classified into two categories, Type-A and Type-B (as defined in section \ref{sec:Classification-of-sources}), and \emph{standard uncertainties} are estimated for each component. The estimated coverage associated with these evaluations is, in the case of Type-A components, that corresponding to one standard deviation. This is not quantifiable in a manner that can be defended rigorously in the base of Type-B errors, but estimating a standard uncertainty remains the goal.  
\item To obtain the combined evaluation of uncertainty resulting from the net effects of many uncorrelated sources, the standard uncertainties are combined in quadrature,\footnote{i.e., $s^{2}=\sum_{i}s_{i}^{2}$.} and the number of degrees of freedom in the combined uncertainty is estimated from the Welch-Satterthwaite equation.\footnote{
$n_{r}={[\sum_{i}S_{Y,i}^{2}]^{2}}/[{\sum_{i}{S_{Y,i}^{4}}/n_{i}}]$ 
where n$_{r}$ is the number of degrees of freedom in the final result, $S_{Y,i}$ is the standard deviation in $Y$ that would result from error source $i$ alone, and $n_{i}$ is the number of degrees of freedom in that source of uncertainty.} For cases with correlations among components, methods that treat these correlations must be used, as specified in a subsequent section. A complete uncertainty report should also include an estimate of the number of degrees of freedom associated with the result.  
\item If some standard uncertainties are asymmetrical, the positive and negative values should be combined separately to obtain separate upper and lower composite values.  
\item The recommended uncertainty to be reported is the combined standard uncertainty, evaluated to represent a single standard deviation. Other estimates (e.g., that covering a specified level of confidence) can be obtained readily from this, provided that the number of degrees-of-freedom in the result is also reported.  
\item \emph{{[}Not part of the standard:{]}} The uncertainty report should also include separate estimates of the limits to precision and bias in the result.  
\end{enumerate}
An uncertainty report will normally include a tabulated list of sources of uncertainty, which should have separate sections for distinct influences like those arising from calibration, data collection, and data analysis. It is also useful to include associated estimates of precision, degrees of freedom, and bias for each contribution shown in the table. Such tabulations make it possible to isolate major sources of error, to consider the validity of other investigators' estimates of error sources, and to repeat the analyses for a new case when only one of the contributions has changed. 

An important aspect of this methodology is that the degrees of freedom associated with cited estimates should be calculated and quoted. This becomes important when the number of degrees of freedom in the result is small, so that error limits and propagated errors have non-Gaussian character. Even if it is assumed that the individual measurements are distributed according to a Gaussian error distribution, the true standard deviation for an average of $n$ samples, $\sigma_{n}$, is not known and must be estimated from the observations. The test statistic $t=(\overline{x}-\xi)/S_{n}$ (where $\overline{x}$ is the average of $n$ measurements, $\xi$ is the true value of $x$, and $S_{n}$ is the estimated standard deviation of the average $\overline{x}$ about $\xi$, determined from $S_{n}=[\sum_{i=1}^{n}(x_{i}\overline{x})^{2}/(n(n-1))]^{\frac{1}{2}}$) will not be Gaussian distributed. The appropriate distribution for such averages is the Student-t distribution. The difference between the Gaussian and Student-t distributions is generally insignificant when the number of degrees of freedom\footnote{In the case of an average of n values, the number of degrees of freedom is $n-1$.} exceeds about thirty, but for small sample sizes the differences can be quite important. For this reason, when $n<30$, the confidence limits used should be taken from the Student-t distribution rather than from the normal distribution. 

% Figure \ref{fig:Student's t distribution} shows the relationship between the 95\% confidence limits and the t statistic for the Student-t distribution.  
% \begin{figure}
% \begin{centering}
% \includegraphics[width=5in,keepaspectratio]{48_home_cooperw_RStudio_DEEPWAVE_WindUncertainty_A-figure2.png}  
% \par\end{centering}
% 
% \protect\caption{\emph{\label{fig:Student's t distribution}Confidence limits for the Student's t distribution.}} 
% \end{figure}
% If the final number of degrees of freedom is larger than thirty, the range to select for the precision error limit in the result is easily determined by use of the estimated standard deviation in the result, the approximate 68\% confidence limit. Otherwise, it is necessary to know the effective number of degrees of freedom in the final result, as shown in Fig.~\ref{fig:Student's t distribution}. The\index{Welch-Satterthwaite formula} Welch-Satterthwaite formula provides an estimate:  
% \begin{equation}
% n_{r}={\frac{{[\sum_{i}S_{Y,i}^{2}]^{2}}}{{\sum_{i}{S_{Y,i}^{4}}/n_{i}}}}\label{eq:WS} 
% \end{equation}
% where n$_{r}$ is the number of degrees of freedom in the final result, $S_{Y,i}$ is the standard deviation in $Y$ that would result from error source $i$ alone, and $n_{i}$ is the number of degrees of freedom in that source of uncertainty. 

The format advocated and followed here for an analysis of uncertainty includes these components:\vfill\eject
 %
\fbox{% 
\begin{minipage}[t]{1\columnwidth}% 
\begin{enumerate}
\item \textit{Description of the measurement system with discussion of the limits within which the analysis to be presented is valid.} For example, the uncertainty in measurements of wind for a research aircraft might be specified for straight-and-level flight within three hours of takeoff (because of drift of the inertial navigation system), perhaps within some altitude range. This description should discuss the calibration procedures, tests to characterize measurement uncertainty, data processing, and propagation of uncertainty to derived quantities. In this report, the measurement systems are discussed in detail in Sect.~\ref{sec:Components}, calibration procedures in Sect.~\ref{sec:CalProcedures}, data processing and associated uncertainties in Sect.~\ref{sec:Calibrations}, and tests of measurement uncertainty in individual components contributing to the measurement of wind are discussed in Sects.~\ref{sec:vertical-wind} and \ref{sec:HWind}. 
\item \textit{Tabulation} \textit{and classification of} \textit{the elemental sources} \textit{of uncertainty. }Each elemental source should be listed with its associated standard uncertainty $u_{i}$ and, for Type-A sources, the number of degrees of freedom ($n_{i}$). It is also convenient to tabulate the effect of the error source on the final measurement $Y$ by including entries for $u_{i}(\partial Y/\partial x_{i})$ in the tables, where $u_{i}$ is the standard uncertainty in the uncertainty-component $x_{i}$. This simplifies propagation to the final result, although special treatment is still needed in cases where the contributions are correlated. 
% The sources should be classified into groups contributing to calibration, data acquisition, and data processing, or into similarly meaningful groups for the instrument under consideration. 
In this report, this tabulation is contained in Tables~\ref{tab:Elemental-w}--\ref{tab:GP-Elemental-h}.
\item \textit{Discussion of} \textit{each elemental source} \textit{of uncertainty in the table(s)} \textit{along with a} \textit{description of} \textit{the basis for the evaluation. }These discussions should reflect the evidence for the tabulated values. Section~\ref{sec:Uncertainty-components} contains these discussions. 
\item \textit{Summarize} \textit{the results and the uncertainty limitations of the measurement.} It is helpful here to highlight the main sources of error and possible actions that could improve the measurements. 
See Table~\ref{tab:Summary-of-uncertainty} and related discussion in this report.
\end{enumerate} 
%
\end{minipage}}

% 
% 
% \subsection{Propagation of uncertainty estimates}
% 
% \index{propagation of error}
% The interesting quantities for research are often derived from the basic measurements by calculations that combine many measurements into final quantities, transform the measurements, apply filters, or otherwise convert the fundamental measurements into derived quantities. In such cases, the uncertainty characteristics of the derived quantities can become quite complicated and difficult to understand without a prescribed methodology, and serious errors in interpretation can result. For example, some attempts to derive correlations between radar reflectivity ($Z$) and rainfall ($R$) have been distorted by the problem that both are based on different calculations from the same characteristics of the drop size distributions, and hence there is a natural correlation between the two that arises purely from correlated error sources. If data sources are used that provide imprecise estimates of $Z$ and $R$, a correlation will appear that is purely the result of these correlated error contributions and does not reflect a natural correlation between radar reflectivity and rainfall rate. It would be a serious error to use the correlation determined in this way to estimate rainfall from radar reflectivity. 
% 
% The following develops a consistent approach, often called ``error propagation,'' that makes it possible to determine the uncertainty characteristics in derived quantities if the characteristics of the fundamental measurements are known. Let $\{x\}$ = $\{x_{\ell},\ell=1,L\}$ be a set of measured quantities with known measurement uncertainties.\footnote{Brackets denote multidimensional quantities and bold-face symbols denote matrices.} Consider derived quantities $\{Y\}$ = $\{Y_{m},~m=1,M\}$, each of which is a function of the measured quantities $\{x\}$:  
% \begin{equation}
% Y_{m}=Y_{m}(x_{1},x_{2},\dots x_{L})~or~{\textbf{Y}}={\textbf{Y}}({\textbf{x}}). 
% \end{equation}
% The mean values of $x_{\ell}$, $\overline{x_{\ell}}$, are then the ``best'' values for $x_{\ell}$ in the sense that they minimize the squares of the deviations from these best values. In the same sense, the ``best'' values for $Y_{m}$ are the values $Y_{m}(\overline{x_{1}},\overline{x_{2}},\dots\overline{x_{L}})$.\footnote{These values do not necessarily minimize the sum of the squared deviations from $\{\overline{Y}\}$, the derived quantities, unless the relationship to the measured quantities is linear.} 
% 
% The one-standard-deviation uncertainties in $\{Y\}$ are those that represent the range over which $\{Y\}$ can vary while $\{x\}$ remain within one-standard-deviation of their measured values. For small deviations, a first-order Taylor expansion relates deviations in $\{Y\}$ to deviations in $\{x\}$:  
% \begin{equation}
% Y_{m}(x_{1},x_{2},\dots\,\,x_{L})=Y_{m}(\overline{x_{1}},\overline{x_{2}},\dots\,\,\overline{x_{L}})+\sum_{k=1}^{L}{\frac{{\partial Y_{m}(x_{1},x_{2},\dots\,\,x_{L})}}{{\partial x_{k}}}}\Bigr|_{\overline{x}}(x_{k}-\overline{x_{k}}). 
% \end{equation}
% The variance in $Y_{m}$ is then obtained by averaging over the $N$ measurements, indicated by index $i$:  
% \begin{equation}
% V_{Y_{m}Y_{m}}={\frac{{1}}{{N}}}\sum_{i=1}^{N}\bigl(Y_{m}(\{x\}_{i})-Y_{m}(\{\overline{x}\})\bigr)^{2} 
% \end{equation}
% 
% 
% \begin{equation}
% ~~~~={\frac{{1}}{{N}}}\sum_{i=1}^{N}\Bigl[\bigl(\sum_{j=1}^{L}{\frac{{\partial Y_{m}}}{{\partial x_{j}}}}\Bigr|_{\overline{x}}(x_{i}-x_{j})\bigr)\bigl(\sum_{k=1}^{L}{\frac{{\partial Y_{m}}}{{\partial x_{k}}}}\Bigr|_{{\overline{x}}}(x_{k}-x_{i})\bigr)\Bigr] 
% \end{equation}
% \begin{equation}
% ~~~~~=\sum_{j}\sum_{k}{\frac{{\partial Y_{m}}}{{\partial x_{j}}}}\Bigr|_{\overline{x}}{\frac{{\partial Y_{m}}}{{\partial x_{k}}}}\Bigr|_{\overline{x}}\bigl({\frac{{1}}{{N}}}\sum_{i}(x_{ji}-\overline{x_{j}})(x_{ki}-\overline{x_{k}})\bigr)\,\,\,.\label{eq:DerivedCoverianceMatrix} 
% \end{equation}
% 
% 
% The matrix elements  
% \begin{equation}
% H_{jk}^{-1}={\frac{{1}}{{N}}}\sum_{i=1}^{N}(x_{ji}-\overline{x_{j}})(x_{ki}-\overline{x_{k}}) 
% \end{equation}
% entering (\ref{eq:DerivedCoverianceMatrix}) are the variances and covariances of the measured quantities, so ${\textbf{H}}^{-1}$ is called the \textit{covariance matrix} or the \textit{error matrix.} If the relationship between $\{Y\}$ and $\{x\}$ is linear or is assumed linear (as in the first-order Taylor expansion) over the range of fluctuations, then this matrix is particularly useful for determining the variances in derived quantities because those variances can be expressed as  
% \begin{equation}
% V_{Y_{m}Y_{n}}=\langle(Y_{m}-\overline{Y_{m}})(Y_{n}-\overline{Y_{n}})\rangle 
% \end{equation}
% \begin{equation}
% ~~~~~=\sum_{j=1}^{L}\sum_{k=1}^{L}{\frac{{\partial Y_{m}(x)}}{{\partial x_{j}}}}\Bigr|_{x=\overline{x}}{\frac{{\partial Y_{n}(x)}}{{\partial x_{k}}}}\Bigr|_{x=\overline{x}}H_{jk}^{-1} 
% \end{equation}
% or, in matrix notation,  
% \begin{equation}
% V=T^{t}H^{-1}T\label{eq:refa} 
% \end{equation}
% where $T_{mj}$ = $\partial Y_{m}/\partial x_{j}$ is the element of the (column) matrix of derivatives of the derived quantity $Y_{m}$ with respect to the measured quantity $x_{j}$ and the superscript $t$ denotes the transpose matrix. This general form is valid for any correlations among the original measurements (which will be represented by off-diagonal elements of $H$) and properly represents the correlations among dependent variables. 
% 
% \beginexample 
% \htmlrule 
% \html{\textbf{Example:}} A thermocouple can be used to measure temperature, because a junction between two metals will produce a voltage difference in the two metals that is dependent on (and nearly proportional to) the temperature of the junction. A common experimental set-up is shown in Fig.~\ref{fig:ThermocoupleExperiment}.  
% \begin{figure}[H] 
% \begin{centering}
% \includegraphics[width=4.5in]{49_home_cooperw_RStudio_DEEPWAVE_WindUncertainty_A-figure3.png}  
% \par\end{centering}
% 
% \protect\caption{\emph{\label{fig:ThermocoupleExperiment}Experimental configuration for measuring temperature with a thermocouple. Junctions J1 and J2 are junctions between copper and constantan wire, so the voltage V1 is a measure of the temperature difference between $T$ and $T_{ref}$. A thermistor R$_{t}$ measures the bath temperature via the voltage V2, and so provides a reference temperature to be added to the temperature difference measured by the thermocouple.}} 
% \end{figure}
% The thermocouple junctions both produce voltage differences, dependent respectively on the temperature $T$ and on the reference bath temperature $T_{ref}$. The reason for using this arrangement is that both the wires leading to the instrument measuring the voltage $V$ are then copper wires, and can connect to copper junctions at the voltmeter without introducing additional contact potentials such as would result if the constantan wire were connected directly to the voltmeter. The uncertainty in $T$ is then caused by two sources: (a) the uncertainty in the measurement of $\Delta T$ = $T-T_{ref}$, and (b) the uncertainty in $T_{ref}$. Often, a thermistor is used to measure the temperature of the reference bath (or of a metal block used in the same way). 
% 
% If a thermistor is used to determine the temperature of the reference junction, as shown, there are two voltages that must be measured to determine the unknown temperature $T$: $V_{1}$, produced by the pair of thermocouples, and $V_{2}$, produced by the thermistor. These are related to the temperature difference $\Delta T$=($T-T_{ref}$) and to $T_{2}$, the temperature of the thermistor junction, by functions $Y_{1}$ and $Y_{2}$, which often are almost linear relationships: 
% \begin{equation}
% \Delta T=Y_{1}(V_{1})=a_{1}V_{1} 
% \end{equation}
% \begin{equation}
% T_{2}=Y_{2}(V_{2})=a_{2}V_{2}. 
% \end{equation}
% Then the first two fundamental quantities affecting the measurement, in the earlier notation, are $x_{1}=V_{1}$ and $x_{2}=V_{2}$. 
% 
% If $V_{1}$ and $V_{2}$ are measured by the same voltmeter, part of the uncertainty in $V_{2}$ will be correlated with that in $V_{1}$ because bias in the voltmeter will affect both measurements in the same way. This will be reflected in off-diagonal terms in the error matrix, representing correlations between errors in $V_{1}$ and $V_{2}$. 
% 
% There will also be an error in the measurement of $T$ introduced by the assumption that $T_{ref}=T_{2}$, because the temperature bath or constant-temperature block may not be uniform in temperature. Another function $Y_{3}=x_{3}=T_{ref}-T_{2}$ can be introduced to account for this error source, which probably will be a systematic error. The measurement $T$ is then determined from  
% \begin{equation}
% T=\Delta T+(T_{ref}-T_{2})+T_{2}=Y_{1}(V_{1})+Y_{2}(V_{2})+Y_{3}. 
% \end{equation}
% 
% 
% Suppose that the voltmeter has a precision of $S_{i}$ and a systematic error of $B_{i}$ when measuring $V_{i}$, and that the random errors are uncorrelated but the bias errors are always the same (as might occur for a calibration error). If the only sources of error are these random and systematic errors and a non-zero value of $Y_{3}$, the error matrix for the random component of the uncertainty is  
% \begin{equation}
% H_{r}^{-1}=\left(\begin{matrix}S_{1}^{2}\end{matrix}\right) 
% \end{equation}
% and the bias component is  
% \begin{equation}
% H_{s}^{-1}=\left(\begin{matrix}(B_{1}^{2}\end{matrix}\right) 
% \end{equation}
% when expressed in terms of the fundamental quantities $x_{1}$, $x_{2}$, and $x_{3}$ representing the two measurements and the unmeasured difference between $T_{ref}$ and $T_{2}$. 
% 
% The sum of these matrices can be used in (\ref{eq:refa}) to evaluate the variance in the measured temperature:  
% \begin{equation}
% V_{TT}=\begin{pmatrix}a_{1}\end{pmatrix}\BEGINDIF{pmatrix}S_{1}^{2}+B_{1}^{2}\end{pmatrix}\begin{pmatrix}a_{1}\\ a_{2}\\ 1 
% \end{pmatrix}
% \end{equation}
% \begin{equation}
% ~~~~~=a_{1}^{2}S_{1}^{2}+a_{2}^{2}S_{2}^{2}+(a_{1}B_{1}+a_{2}B_{2})^{2}+B_{3}^{2}. 
% \end{equation}
% The first two terms show that the random contributions add to the net variance in quadrature, as expected for independent error sources. The next term shows that the bias contributions, however, add linearly. This results because a bias error affects measurements of $\Delta T$ and $T_{2}$ in the same way, so the error enters the final result additively.  
% \endexample 
% \htmlrule 
% \rm


\subsection{Monte Carlo techniques}

\index{Monte Carlo techniques}
Sometimes the functional relationships are so complex or non-linear that the preceding analytical formulas are unwieldy. In such cases, an alternative is to employ what is conventionally called a \textit{Monte Carlo} technique. In this approach, the measured quantities are varied randomly in ways that represent the experimental uncertainties, and the calculations leading to the final answer are repeated with these artificial quantities. This is done repeatedly, and the variances and covariances in the resulting final answers are calculated. Random number generators are available on computer systems that generate variables having zero mean, unity variance, and a Gaussian probability distribution. Correlated fluctuations can be represented by defining linear combinations of such independent variables. In cases where the error propagation is especially complex (e.g, where the final answer might depend on non-linear fits to the input data), Monte Carlo techniques may be the only feasible way of determining the uncertainty in the final result. 

% 
% \subsection{Reference material and glossary}
% 
% \index{terminology!reference}
% This section provides, for reference, specific definitions of some of the other terms used in the analysis of uncertainty. This information is included here because this terminology is sometimes in conflict with nonscientific usage and is not always used consistently even in scientific papers. 
% 
% With many of these terms, it is necessary to distinguish between the characteristics of a \textit{parent} distribution and the estimates of those characteristics obtained from a specific sample from the parent population. For example, one may want to estimate characteristics of the parent population from measurements taken on only a specific subset from that population. A common convention, followed here, is to use Greek letters for population characteristics and Roman letters for sample characteristics. Thus, for example, $\overline{x}$ will denote the average of a set of measurements, but $\mu$ will denote an average characteristic of the underlying population. 
% 
% \textit{Precision} is a measure of reproducibility or scatter in the results, without regard for the accuracy of the result. It is a measure of random error only; systematic errors will not affect the precision of a result.
% 
% The \textit{mean} of a set of measurements $\{x_{1},x_{2},\dots x_{N}\}$ is the average:  
% \begin{equation}
% \overline{x}={\frac{{1}}{{N}}}\sum_{i=1}^{N}x_{i}. 
% \end{equation}
% The \textit{expectation value} of a quantity is the value expected if averaged over the entire parent population, and will be denoted by angle brackets: $\langle\rangle$. For example, the mean in the parent population that corresponds to the sample mean x is  
% \begin{equation}
% \mu=\langle x\rangle={\textrm{lim}}_{N\rightarrow\infty}(\overline{x}). 
% \end{equation}
% 
% 
% There is an important distinction to be made between the standard deviation characterizing the random error of a measurement and the standard deviation characterizing a set of accurate observations and hence reflecting physical reality. The latter is often encountered in experimental research, and pertains to the natural variability in the parameter being measured; e.g., the temperature may really vary when measured over a path through the atmosphere. The former represents the precision with which a constant value of that parameter could be measured in a particular experiment. For example, in experiments using airborne instrumentation variance spectra for measured variables seldom show evidence of noise except at low levels that correspond to digitization noise. This indicates that random measurement errors seldom contribute significantly to the uncertainty in such a measurement. However, there usually is high natural variability that causes repeated sets of measurements in presumably identical conditions to vary significantly, and the standard deviations among repeated measurements of, for example, fluxes of water vapor are large. This standard deviation reflects natural variability, not the random error in the measurement. It results from the variability of particular samples about the underlying population mean, and that variability would still characterize measurements from error-free sensors. 
% 
% The \textit{median} is the value that divides the population into equal halves; i.e., half the members lie above and half below the median. The \textit{most probable value} is that observed most frequently, sometimes referred to as the \textit{mode} of a distribution. As an example, the expected distribution of time intervals between randomly occurring events is  
% \begin{equation}
% N(t)=N_{0}e^{-t/\tau} 
% \end{equation}
% where $N(t)$ is the number of events per time interval that occur at time t, $N_{0}$ is the total number of events, $t$ is the time, and $\tau$ is a time constant characterizing the process. For this distribution, the mean time is $\tau$, the median time is $\tau$ln(2), and the mode occurs for t=0. 
% 
% A \textit{deviation} $\delta$ is the difference between a specific measurement or value and the mean. The \textit{standard deviation} $\sigma$ is the ``root-mean-square'' value of the deviations, obtained from  
% \begin{equation}
% \sigma=\Bigl[{\textrm{lim}}_{N\rightarrow\infty}\bigl({\frac{{1}}{{N}}}\sum_{i=1}^{N}(x_{i}-\mu)^{2}\bigr)\Bigr]^{\frac{{1}}{{2}}}. 
% \end{equation}
% For a sample of measurements, the conventional estimate $s$ of the population standard deviation $\sigma$ is  
% \begin{equation}
% s=\Bigl[{\frac{{1}}{{N-1}}}\sum_{i=1}^{N}(x_{i}-\overline{x})^{2}\Bigr]^{\frac{{1}}{{2}}}. 
% \end{equation}
% The \textit{variance} is the average of the squares of the deviations, or the square of the standard deviation. 
% 
% If $x_{j}$ is a possible observation, the observed fraction of observations having the value $x_{j}$ is $P(x_{j})=N(x_{j})/N$ where $N$ is the total number of observations and $N(x_{j})$ is the number having value $x_{j}$. The underlying population distribution function is then  
% \begin{equation}
% \Phi(x_{j})={\textrm{lim}}_{N\rightarrow\infty}P(x_{j}). 
% \end{equation}
% The preceding quantities can then be expressed in terms of the distribution function; for example, the mean is  
% \begin{equation}
% \mu=\sum_{j=1}^{N}x_{j}\Phi(x_{j}) 
% \end{equation}
% and the variance is  
% \begin{equation}
% \sigma^{2}=\sum_{j=1}^{N}(x_{j}-\mu)^{2}\Phi(x_{j})=\Bigl(\sum_{j=1}^{N}x_{j}^{2}\Phi(x_{j})\Bigr)-\mu^{2}=\langle x^{2}\rangle-\mu^{2}. 
% \end{equation}
% The extensions to continuous distribution functions are these:  
% \begin{equation}
% \sum_{j}P(x_{j})\rightarrow\int P(x)dx 
% \end{equation}
% \begin{equation}
% \mu=\int_{-\infty}^{\infty}x\Phi(x)dx 
% \end{equation}
% \begin{equation}
% \sigma^{2}=\int_{-\infty}^{\infty}(x-\mu)^{2}\Phi(x)dx. 
% \end{equation}
% Similarly, the expectation value for any function $f$ of measurable characteristics $x$ is  
% \begin{equation}
% \langle f(x)\rangle=\int f(x)\Phi(x)dx 
% \end{equation}
% where $x$ can be a set of variables and the multidimensional integration must then cover all possible values of $x$. 
% 
% Other characteristics sometimes cited are the \textit{probable error}, the magnitude of the deviation exceeded by 50\% of the deviations, and the \textit{average deviation,} the expectation value for the absolute magnitude of the deviations. For a Gaussian distribution, the probable error, average deviation, and standard deviation have the ratios 0.674:0.800:1. 
% 
% If the distribution in measurement errors follows a known probability distribution, then \textit{confidence intervals} determined from that distribution can be used to obtain quantitative estimates of probabilities associated with such errors. It is this relationship that establishes the often used correspondence between standard deviation and probability, for the Gaussian distribution. Specifically, measurements falling more than two standard deviations ($\pm2\sigma$) from the true value are expected with about 0.05 probability, so $2\sigma$ limits correspond to approximate limits providing 95\% coverage. Other distribution functions can be treated in the same way. 

% \furtherread
% 
% Abernethy, R. B., and Benedict, 1984:
% 
% Abernethy, R. B., and B. Ringhiser, 1985: The history and statistical
% development of the new ASME-SAE-AIAA-ISO measurement uncertainty methodology.
% 
% Barford, N.. C., 1985: \textit{Experimental Measurements: Precision,
% Error, and Truth.} John Wiley and Sons, New York, 159 pp.
% 
% Beers, Yardley, 1957: \textit{Introduction to the Theory of Error.}
% Addison-Wesley. Reading, Massachusetts, 66 pp.
% 
% Taylor, J. R., 1982: An Introduction to Error Analysis. University
% Science Books, Mill Valley, California, 270 pp. \endfurther
% {}
% 







\section{Measurements of turbulence\label{sec:turbulence}}

\subsection{Scope of this appendix}

\index{turbulence!characterization of}
Distributions showing variance vs.~frequency for measured vector components of the wind are needed to characterize turbulence.\footnote{For wind, the variance spectrum has units of, e.g., m$^{2}$s$^{-2}$ per frequency interval which is energy per mass per frequency interval, so this is best interpreted as an energy spectrum, not a power spectrum (which would have units of (energy/time) per frequency interval or, e.g., Watts/Hz instead of Joules/Hz for unit mass. For this reason, ``variance spectrum'' or ``energy spectrum'' or, perhaps best, ``spectral density of variance'' seem preferable to ``power spectrum'' for the present application.} This appendix discusses the high-rate measurements of wind on the NSF/NCAR GV and proposes new variables for use in studies of turbulence.\footnote{The tools for spectral analysis used here are discussed further in \citet{Cooper1994}. In particular, the ``all poles'' or ``maximum entropy'' method of spectral analysis (cf.~\citet{Press:1992:NRC:148286}) will be the main method used for generating plots of the spectral density of variance from the measurements of wind. Because this is commercial software, this code is an exception to the effort to provide reproducible analysis in this report. Construction of the variance spectra shown here is dependent on the routine described on p.~572 of the cited reference.} 

\subsection{High-rate sampling\label{sub:high-rate}}

\index{high-rate data files}
The normal high-rate output for wind components is 25~Hz. However, the different measurements entering the calculation of wind are available at various sampling frequencies, so these must be converted to a common rate. The most important contributors to high-frequency variance are the measurements of dynamic pressure (QCF)\sindex[var]{QCF>@QCF} and the pressure differences (ADIFR\sindex[var]{ADIFR>@ADIFR} and BDIFR)\sindex[var]{BDIFR>@BDIFR} measured at the radome. These are measured at 50\,Hz by digital sensors having response times adequate for such sampling.\footnote{However, the sensors introduce a delay of about one sample period or 20\,ms in the measurement.} Measurements of attitude angles (pitch, roll, and heading) are available from the inertial system at 50~Hz, but it provides ground speeds\index{speed of aircraft!ground speed} only at 13\,Hz and the GPS system as operated in the DEEPWAVE project provided ground-speed components at 5\,Hz. The aircraft ground speed shows little high-frequency variance, so this has little effect on the final measurements, but these samples are all converted to 25\,Hz for processing by interpolating all samples with sample rates lower than 25\,Hz to 25\,Hz, then applying a digital filter with 25\,Hz cutoff to reduce aliasing. However, in parts of this appendix 50-Hz samples will be used to illustrate the nature of the unfiltered measurements at the maximum sample rate. As sill be shown, this is outside the
range of frequencies where the GV wind-sensing system can make good measurements.

Evidence from Sect.~\ref{sub:Variance-spectra-for-W-components} (cf.~Fig.~\ref{fig:WIXHR1}) indicates that sensor noise\index{noise!sensor} introduces a lower limit to the intensity of turbulence that can be measured that is about $4\times10^{-4}$ m$^{2}$s$^{-2}$\,Hz$^{-1}$ for lateral wind components (arising from the transducers used for measuring ADIFR\sindex[var]{ADIFR>@ADIFR} and BDIFR)\sindex[var]{BDIFR>@BDIFR} and about $1\times10^{-3}$ m$^{2}$s$^{-2}$\,Hz$^{-1}$ for the longitudinal component. These are important limitations to the ability of the wind-sensing system to measure turbulence when the intensity of turbulence is low. 


\subsection{Standard variance spectra\label{sub:var-spec}}

Some examples from the DEEPWAVE\index{DEEPWAVE} project have been shown in Sect.~\ref{sec:VerticalVelocity}. That project emphasized studies of waves and often measured in regions where waves rather than turbulent air motions were predominant, so here different measurements from lower-level flight will be used here. In particular, a flight segment from two test programs flown in Oct.~2013 and Nov.~2014 provide good cases for study of \index{turbulence!boundary-layer}boundary-layer turbulence. In the former, a leg was flown from 19:54:00 to 20:12:00 UTC on Oct.~16 2013 at an altitude of about 5500~ft (1700\,m) over terrain having an approximate elevation of 3700\,ft (1130\,m). In the latter project the leg to be used was flown from 21:02:00--21:09:99 UTC on Nov.~24 2014. It will be used here because both LAMS and the gust pod were also operational. 



Because the measurements affecting high-frequency measurements of wind components are all sampled at 50\,Hz, \index{variance spectrum}variance spectra can in principle be calculated up to a \index{Nyquist frequency}Nyquist frequency of 25\,Hz. However, there are some limitations expected, primarily arising from expected effects in the pressure-sampling lines (\citet{Iberall1950}) and aliasing and the absence of filtering of the 50-Hz measurements. Figures\ \ref{fig:AppxB-PSD1}--\ref{fig:AppxB-PSD3} show examples of the three components of the variance spectra for the first flight leg cited above. The lateral spectra (WIC and VYC)\sindex[var]{VYC=horizontal-wind component lateral to the aircraft axis} are reasonably similar, have similar variances through the range of frequencies, and show similar indications of noise and aliasing for frequencies above 10\,Hz. However, the longitudinal variance spectrum (variable UXC\sindex[var]{UXC=horizontal-wind component along the aircraft axis}, Fig.~\ref{fig:AppxB-PSD2}) indicates that there is a problem with this measurement at frequencies above about 2~Hz. This problem appears directly in the airspeed measurement used for determining the longitudinal component of the wind and in the measurement of dynamic pressure (QCF)\sindex[var]{QCF>@QCF} used for that measurement. 

\index{variance spectrum!WIC}

\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/PSD1.png}  
\par\end{centering}

\protect\protect\protect\caption{\label{fig:AppxB-PSD1}Variance spectra for the vertical wind for the flight segment from 19:51:01--20:12:00 UTC on 16 Oct.\ 2013.} 
\end{figure}
\index{variance spectrum!UXC}
\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/PSD2.png}  
\par\end{centering}

\protect\caption{\label{fig:AppxB-PSD2}Variance spectra for the longitudinal component of the wind (along the aircraft centerline, and so essentially also the spectrum for the airspeed) for the flight segment from 19:51:01--20:12:00 UTC on 16 Oct.\ 2013.} 
\end{figure}

\index{variance spectrum!VYC}
\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/PSD3.png}  
\par\end{centering}

\protect\caption{\label{fig:AppxB-PSD3}Variance spectra for the lateral component of the horizontal wind for the flight segment from 19:51:01--20:12:00 UTC on 16 Oct.\ 2013.} 
\end{figure}


% \noindent \begin{center}
% \includegraphics[height=0.45\textheight]{PSD2}
% \par\end{center}
% 
% \noindent \begin{center}
% \includegraphics[height=0.45\textheight]{PSD3}
% \par\end{center}
% 
% \noindent \begin{center}
% \includegraphics[height=0.45\textheight]{PSD4}
% \par\end{center}


The longer \index{pressure lines}pressure lines used for the measurement of dynamic pressure QCF\sindex[var]{QCF>@QCF} and the larger random uncertainty in that sensor in comparison to the sensors for angle of attack and sideslip pressure differences contribute to the problems in the distribution shown in Fig.~\ref{fig:AppxB-PSD2}. The lateral components are determined from pressure measurements made using lines about 1.5~m long connected to the radome pressure ports, but QCF\sindex[var]{QCF>@QCF} is the difference between the total pressure at a pitot tube and the static pressure delivered by static buttons on the fuselage, so these necessarily use longer pressure lines which, for the reference static pressure delivered to the lower-pressure port of the QCF sensor, are about 8~m in length.

Calculations by D.~Lenschow using equations presented in \citet{Iberall1950} for the line lengths and tubing sizes in use are shown in Figs.~\ref{fig:AppxB-DHL1} and \ref{fig:AppxB-DHL2}. The first plot, applicable to QCF,\sindex[var]{QCF>@QCF} shows that there are significant effects on the amplitude and phase of the measured signals even for frequencies of 1--10\,Hz, although the amplitude effects are smallest for flight between 12--16\,km. The most pronounced effects on amplitude are for flight near sea level, where for example the measured amplitude is more than three times the correct value for frequencies near 9\,Hz. In contrast, the effect on phase is largest for the higher flight levels, and for example at 12\,km would introduce a phase lag of about 0.03\,s. 
\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/PressureLines1.png}  
\par\end{centering}

\protect\caption[Amplitude ratio and phase for transmission through the QCF pressure line.]{\label{fig:AppxB-DHL1}Amplitude and phase of response at the sensor end of the QCF pressure line, for a set of assumed standard-atmosphere flight conditions: (blue) sea level; (orange) 4 km; (green) 8 km; (red) 12 km; (violet) 16 km; (dark orange) 20 km. The same results are shown in the top and bottom plots but for different ranges in frequency. Phase angles above zero should be interpreted as 180$^{\circ}$ minus the plotted angle, so that the phase angle decreases monotonically with frequency. Tube dimensions: 5.3~mm inside diameter, length 8~m. } 
\end{figure}

The corresponding results for the radome pressure lines are shown in Fig.~\ref{fig:AppxB-DHL2}. Here the effect on amplitude is negligible for frequencies below 12.5\,Hz, the Nyquist frequency for the normal high-rate measurements. The effect on phase is also negligible in this range, with a time delay smaller than 5\,ms for all pressures. The measurements could not be extended to higher rates without significant error, but for normal high-rate measurements the lines do not introduce any problems that affect the lateral components of the wind.\sindex[var]{ADIFR>@ADIFR}\sindex[var]{BDIFR>@BDIFR}
\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.6\textheight]{SpecialGraphics/PressureLines2.png}  
\par\end{centering}

\protect\caption[Amplitude ratio and phase for transmission through the pressure lines for ADIFR and BDIFR.]{\label{fig:AppxB-DHL2}Amplitude and phase of response at the sensor end of the ADIFR and BDIFR pressure lines, for a set of assumed standard-atmosphere flight conditions: (blue) sea level; (orange) 4 km; (green) 8 km; (red) 12 km; (violet) 16 km; (dark orange) 20 km. Phase angles above zero should be interpreted as 180$^{\circ}$ minus the plotted angle, so that the phase angle decreases monotonically with frequency. Tube dimensions: 4.0~mm inside diameter, length 1.5~m.} 
\end{figure}


If the measurements from UXC at frequencies from about 0.4--2~Hz are representative of the same inertial subrange characterized by the lateral components of the wind at about 0.4--10~Hz, then the intensities of turbulence for all components are reasonably consistent with expectations for an inertial subrange. The reference lines on Figs.~\ref{fig:AppxB-PSD1}--\ref{fig:AppxB-PSD3} that indicate expectations for different values of the eddy dissipation rate are adjusted to account for the expect 4:3 ratio between lateral and longitudinal variance spectra. Thus all three components are reasonably consistent with the same eddy dissipation rate of about 5$\times10^{-3}\,\mathrm{m}^{2}\mathrm{s}^{-3}$. In this comparison, the horizontal lateral component VYC\sindex[var]{VYC>@VYC} is lower than the vertical lateral component by about 25\%.\footnote{This would arise if, for example, the second sensitivity coefficient for sideslip angle is too low by about 12\%.}

\index{variance spectrum!WIC}




\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/PSD5.png}  
\par\end{centering}

\protect\protect\protect\caption{\label{fig:AppxB-PSD5}Variance spectra for the vertical component of the wind (WIC) for the flight segment from 21:02:00 to 21:09:00 UTC on 24 Nov.\ 2014.} 
\end{figure}

Another example of the high-frequency variance spectrum of the vertical wind is shown in Fig.~\ref{fig:AppxB-PSD5}, and the corresponding variance in the longitudinal component of the horizontal wind is shown in Fig.~\ref{fig:AppxB-PSD6}. The intensity of turbulence is lower in this case than in the first case presented, and the level of noise\index{noise!vertical wind} appearing for frequencies above 10\,Hz in the vertical-wind spectrum is of lower intensity. The spectrum for the lateral component of the horizontal wind, not shown, is quite similar to that for the vertical wind in regard to shape and intensity. Both indicate that, for normal processing at 25\,Hz with digital filtering, these variance spectra will appear reasonable. However, the longitudinal component (Fig.~\ref{fig:AppxB-PSD6}) again appears to have spurious variance at frequencies above about 1--2\,Hz. This appears consistent with the studies of the pressure lines shown earlier, and these errors will pose problems not only with measurements of the spectrum of turbulence but also with high-frequency contributions to \index{momentum fluxes}momentum fluxes or Reynolds stresses. Therefore, in the next subsection a new variable constructed from combinations of the measurements that does not show these problems is discussed. 

\index{variance spectrum!UXC}
\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/PSD6.png}  
\par\end{centering}

\protect\protect\protect\caption{\label{fig:AppxB-PSD6}Variance spectra for the longitudinal component of the horizontal wind for the flight segment from 21:02:00 to 21:09:00 UTC on 24 Nov.\ 2014.} 
\end{figure}

\subsection{\textquotedbl{}Blended\textquotedbl{} variables}

\index{wind!blended variables}
The other wind-sensing systems on the GV can help provide valid measurements of high-frequency components of the variance spectra of winds. The gust pod has very short pressure lines and a sensing head that is much smaller than the radome, and the LAMS also can measure the longitudinal component of the relative wind at high frequency. In the case of the gust pod, this report concludes that the horizontal wind measurements have serious weaknesses arising primarily from the inertial reference unit used for its measurements, but those weaknesses give slowly varying biases so it might be expected that the high-frequency spectrum for the longitudinal component of the wind would be measured better by the gust pod than by the radome. 

% the figure MEMPlotQC.png was constructed by MEMPlotQCF.py, 
% hand constructed by editing MEMPlot.py versions produced by
% Xanadu for QCF and QC_GP to combine the two traces. The Python
% programs are in ~/Xanadu/HCRTEST.

\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/MEMPlotQC.png}  
\par\end{centering}

\protect\protect\protect\caption{\label{fig:AppxB-PSD1314}Variance spectra for the dynamic pressure measurements from the radome-based system (QCF) and from the gust-pod system (QC\_GP) for the flight segment from 21:02:00 to 21:09:00 UTC on 24 Nov.\ 2014.} 
\end{figure}

\sindex[var]{QC_GP>@QC\_GP}\sindex[var]{QCF>@QCF}Figure \ref{fig:AppxB-PSD1314}\index{variance spectrum!comparison of QCF and QC_GP@comparison of QCF and QC\_GP} shows the variance spectra for the gust-pod dynamic pressure (QC\_GP) and for the radome-system dynamic pressure (QCF).\sindex[var]{QCF>@QCF} This comparison shows that there appears to be noise\index[noise|radome system} in the radome-system measurement at high frequency but the gust-pod measurement\index[noise!gust-pod system} looks reasonable up to about 10\,Hz. (The reduced amplitude for QC\_GP at frequencies lower than about 0.1\,Hz arises from the reduction in dynamic pressure measured under the wing because of disturbed airflow. This is corrected when the gust-pod airspeed TAS\_GP is calculated.) To see how this is reflected in the wind measurements and in a proposed new variable that blends measurements from the gust-pod and radome systems, these steps were used: 

\begin{enumerate}
\item Develop a calibration for airspeed from the gust pod, similar to that developed in Sect.~\ref{sub:GP-TAS}. There the fit was restricted to measurements at high flight levels because that was of primary interest to DEEPWAVE\index{DEEPWAVE}, but for measurements in the boundary layer this needs to be repeated. The same equation was used to represent the fit, and the fit used the measurements from flight 3 of the HCRTEST\index{HCRTEST}\sindex[var]{HCRTEST=HIAPER Cloud Radar test flights} program were used, but all measurements with conventionally measured airspeed (TASF)\sindex[var]{TASF>@TASF} above 130\,m/s and magnitude of the roll angle less than $5^{\circ}$ were used. A fit of \eqref{eq:TASfit} to these measurements then produced coefficients from which the ratio of dynamic to static pressure could be determined. 
\item As in Sect.~\ref{sub:GP-TAS}, this ratio of pressures then was used to calculate the airspeed (TAS\_GP) in the standard way. 
\item This airspeed, with the other measurements from the gust pod, was then used to recalculate the relative wind and then, as explained earlier in this document, the wind direction and magnitude and the various wind components including vertical and horizontal lateral and longitudinal components. 
\item Next, new wind variables were calculated, labeled with suffix \textquotedbl{}M\textquotedbl{} for \textquotedbl{}merged\textquotedbl{}, that combined each component of the measurements from the gust-pod and the radome systems, using the technique described in Sect.~\ref{sub:comp-filter}. For 50-Hz measurements, the time constant used was 150 samples or 3~s. This then resulted in measurements that combined the small low-frequency uncertainty of the radome measurements and the good high-frequency response of the gust-pod measurements. Because the complementary-filter technique uses a cross-over between components at a frequency where both signals are thought to be valid and show high coherence and similar amplitudes, no phase shift or other spurious effect on the variance spectra at the cross-over frequency is expected. 
\end{enumerate}

The result was that a variable TAS\_GP representing the airspeed from the gust pod was obtained that, for measurements where TASF exceeded 130 m/s and the absolute value of the roll was less than 5$^{\circ}$, matched the mean TASF\sindex[var]{TASF>@TASF} from the radome-based system with a residual standard deviation of 0.26\,m/s. This also led to new variables representing the wind from the gust pod and also a new longitudinal-wind variable\sindex[var]{UXM=new variable representing the ``blended'' longitudinal component of the horizontal wind} (UXM) obtained by combining the conventional-system variable UXC and the new gust-pod variable UX\_GP\sindex[var]{UX_GP@UX\_GP=horizontal-wind component along the aircraft axis, from gust-pod measurements} via complementary filtering. 

Because this all involves the same approaches documented in the body of this report, the code will not be documented again, but if it is of interest it can be found in the 'Rnw' file for this report. (See the reproducibility discussion at the end of this report). 

\index{variance spectrum!new blended variable for longitudinal wind}

\index{variance spectrum!all three components}










\begin{figure}
\noindent \begin{centering}
\includegraphics[height=0.4\textheight]{SpecialGraphics/MEMPlot3Comp.png}  
\par\end{centering}

\protect\caption[Variance spectra for the three components of the wind.]{\label{fig:AppxB-3Comp}Variance spectra for the three components of the wind represented by UXM (longitudinal component as recalculated by combining the gust-pod airspeed and the radome-based airspeed, as discussed in the text), VYC (the conventional lateral component of the horizontal wind), and WIC (the conventional measurement of vertical wind). The two lateral components (VYC and WIC) have been multiplied by 0.75 to make them comparable to the longitudinal component in relation to the indicated reference lines for eddy dissipation rate (green lines), which are shown with magnitudes applicable to the longitudinal component. Data from HCRTEST flight 3, 24 Nov.\ 2014.} 
\end{figure}
\sindex[var]{VYC>@VYC}\sindex[var]{WIC>@WIC}\sindex[var]{HCRTEST>@HCRTEST}

The result is shown in Fig.~\ref{fig:AppxB-3Comp}, where the longitudinal component of the horizontal wind is calculated as described above by combining measurements from the gust-pod and the radome-based systems. The lateral components have been scaled by a factor of 3/4 because the variance spectra for longitudinal and lateral components are expected to be in this ratio in an inertial subrange (e.g., \citet{batchelor1953theory}) so this adjustment should make the spectra coincide. From 1--10\,Hz all indeed appear consistent with an \index{eddy dissipation rate}eddy dissipation rate of about $5\times10^{-4}$~m$^{2}$s$^{-3}$. 

The conclusion from this appendix is that the lateral components of the wind measurements appear reasonable up to a frequency of about 10\,Hz, but the longitudinal wind component should not be used at frequencies above about 1\,Hz. For higher frequencies, a useful measurement of the longitudinal wind can be obtained by calculating a new airspeed obtained by combining the high-frequency response from the gust pod with the low-frequency response from the standard radome system and then calculating the wind using this blended variable. There is evidence of noise\index{noise!all wind components} in all wind measurements for frequencies above about 10\,Hz, so this should be considered the upper limit to the capability to measure high-frequency fluctuations in wind on the GV. 

\section{Reproducibility}


\begin{tabular}{ll}
\textsf{\textsc{\textcolor{blue}{Project:}}} & WindUncertainty\tabularnewline
\textsf{\textsc{\textcolor{blue}{Archive package:}}} & WindUncertainty.zip\tabularnewline
\textsf{\textsc{\textcolor{blue}{Contains:}}} & attachment list below\tabularnewline
\textsf{\textsc{\textcolor{blue}{Program:}}} & WindUncertainty.Rnw\tabularnewline
\DIFaddbegin \textsf{\textsc{\DIFadd{\textcolor{blue}{Workflow:}}}} & \DIFadd{Workflow.pdf}\tabularnewline
\DIFaddend \textsf{\textsc{\textcolor{blue}{Original Data:}}} & /scr/raf\_data/\{ProjectName\}/ [accessed May 2015] \tabularnewline
\textsf{\textsc{\textcolor{blue}{DataFrame Archive:}}} & NCAR HPSS\tabularnewline
\textsf{\textsc{\textcolor{blue}{Git:}}} & https://github.com/WilliamCooper/WindUncertainty.git\tabularnewline
\end{tabular}

\DIFdelbegin %DIFDELCMD < \attachm{WindUncertainty.Rnw\\WindUncertainty.pdf\\SessionInfo\\Ranadu\_2.1-15-5-29.tar.gz\\Introduction.Rnw\\ComponentsOfWindSensingSystem.Rnw\\Conventions.Rnw\\CalibrationProcedures.Rnw\\ElementsOfUncertaintyAndSummary.Rnw\\SensitivityCoefficients.Rnw\\SchulerSection.Rnw\\VerticalWindStudies.Rnw\\HorizontalWindStudies.Rnw\\Turbulence.Rnw\\./chunks\\./SpecialGraphics\\WAC.bib}
%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \attachm{WindUncertainty.Rnw\\WindUncertainty.pdf\\SessionInfo\\Ranadu\_2.1-15-5-29.tar.gz\\Introduction.Rnw\\ComponentsOfWindSensingSystem.Rnw\\Conventions.Rnw\\CalibrationProcedures.Rnw\\ElementsOfUncertaintyAndSummary.Rnw\\SensitivityCoefficients.Rnw\\SchulerSection.Rnw\\VerticalWindStudies.Rnw\\HorizontalWindStudies.Rnw\\Turbulence.Rnw\\./chunks\\./SpecialGraphics\\WAC.bib\\Workflow.pdf}
\DIFaddend 

\index{reproducibility of this document}This document is constructed in ways that support duplication of the
study. The processing programs are incorporated into the same file
that generates this document, using principles and techniques described
by \citet{Xie2014a} as implemented in the R package 'knitr' (\citet{Xie2014b}).
The core program, 'WindUncertainty.Rnw', is archived on 'GitHub' 
\index{GitHub repository}in
the directory at \href{https://github.com/WilliamCooper/WindUncertainty.git}{this URL}.\sindex[var]{URL=Uniform Resource Locator}
There is some supplemental material in that directory, like the bibliography, special graphics not generated by the R code,
and many code segments saved in the 'chunks' subdirectory, so the
full directory should be downloaded in order to run the program. The file WindUncertainty.zip will contain all the files needed to generate this document. \DIFaddbegin \DIFadd{It also contains a file called Workflow.pdf that describes the steps that created the document. This description should be of use to anyone wanting to reproduce or extend the results. }\DIFaddend The calculations
use the programming language R\index{R!the programming language}\index{R!RStudio used with} (\citet{Rlanguage}) and were run within RStudio
(\citet{RStudio2012}), so this is the most straightforward way to replicate the
calculations and the generation of this document. To duplicate the list of symbols, list of variable names and acronyms, and the index, once the 'WindUncertainty.tex' file is generated by RStudio, run 'pdflatex WindUncertainty' three times to generate the index files, run 'splitindex WindUncertainty' and then 'makeindex WindUncertainty', then 'pdflatex WindUncertainty' again to update the indices.

A package named Ranadu,\index{Ranadu} containing auxiliary functions, is used extensively
in the R code. It is
available on GitHub as \href{https://github.com/WilliamCooper/Ranadu.git}{https://github.com/WilliamCooper/Ranadu.git}. The specific version used for calculations in this
report is included in the 'zip' archive listed below and as a released version on GitHub.

The\index{data files} data files used are also preserved in the NCAR High Performance
Storage System (HPSS)\sindex[var]{HPSS=High Performance Storage System} in files that are available, and they can be
provided via a \index{data!requesting}request to \url{mailto:raf-dm@eol.ucar.edu}.
The original files representing the data as produced by the NCAR Earth
Observing Laboratory, Research Aviation Facility, were in netCDF\index{netCDF format} format
(cf.~\href{http://www.unidata.ucar.edu/software/netcdf/}{this URL}),
but in many cases special reprocessing was used and the files may
change after reprocessing so a separate archive is maintained for
this document. The data files in this archive represent R data.frames\index{R!data.frame}
and are preserved as binary-format 'Rdata' files via R 'save' commands.
The code in the GitHub archive has appropriate 'load' commands to
ingest these data files from a subdirectory named 'DataFrames' but this
is not part of the GitHub repository because it is too large to be
appropriate there. To reproduce this research, those data files have
to be transferred separately from the NCAR HPSS to the 'Data' directory. 
There is a logical switch in the program named "ReloadData" that, if set true,
causes the program to reload all the data files from the original netCDF
files, so this is best left false to use the 'DataFrames' archive unless
all the original files are first downloaded to appropriate locations. As
corrections are made to the project archives, these netCDF files may change.

Extensive use has been made of attributes\index{attribute!variables}\index{attribute!data.frame} assigned to the data.frames
and the variables in those data.frames. All the attributes from the
original netCDF files have been transferred, so there is a record
of how the original data were processed, for example recording%
\index{calibration coefficients!nimbus} calibration
coefficients and processing chains for the variables. Once the data.frames
are loaded into R, these attributes can be viewed and provide additional
documentation of what data were used. Key information like the processing
date, the program version, and the selection of primary variables
is thus preserved.




\section*{Acknowledgments}
\label{sec:acknowledgements}

The research aircraft discussed in this report, often called "HIAPER,"\sindex[var]{HIAPER=High-Performance Airborne Platform for Environmental Research} was the result of an extensive effort both within and outside of NCAR, and especially at the National Science Foundation. Everyone at the Research Aviation Facility contributed, and additional key contributions were made by Krista Laursen, who led the HIAPER Project Office that oversaw this initial development, and Jim Huning and Cliff Jacobs at the NSF, whose contributions pervade the system as it exists today. The staff of the UCAR Contracts Office made essential contributions through negotiation and oversight. Chris Webster's development and maintenance of the software used for data processing over this entire cycle was also crucial. The technical staff of the NCAR Earth Observing Laboratory were involved in all stages of the development and operation of this research platform, and the project management staff, operations staff, and computing and data management groups of that Laboratory conducted the projects that produced the data used in this report. Without all these contributions, the measurements characterized in this report would not have been available to the community.

To maintain focus and avoid even greater length, this technical report does not acknowledge the many contributions made to measurement science related to wind measurement by other research groups, but their work has influenced our approaches and thinking significantly. We especially acknowledge the advances and related work at the University of Wyoming, the German Aerospace Center (DLR), the Facility for Airborne Atmospheric Measurements (FAAM), as well as much published literature originating from NASA and other aeronautical groups, all of which have had important influences on our approach to these measurements\DIFaddbegin \DIFadd{. We also appreciate the very constructive reviews provided by Ulrich Schumann and Al Rodi}\DIFaddend .

Almost all of the analyses reported here were performed using R (\citet{Rlanguage}), with RStudio  \citet{RStudio2012} and knitr (\citet{Xie2014a,Xie2014b}). The
"ggplot2" package (\citet{wickham2009}) was used for many of the figures. The effort to make these results reproducible benefited greatly by the work represented in these analysis tools, especially that provided by Y. Xie. The book by C. Gandrud (\citet{Gandrud2014}) also had a strong influence on our approach to this report.

\bibliographystyle{plainnat}
\label{sec:bibliography}
\clearpage
\phantomsection
\addcontentsline{toc}{section}{References}
\bibliography{WAC}
\clearpage
\phantomsection
\addcontentsline{toc}{section}{List of Symbols}
\printindex[lis]{}
\clearpage
\phantomsection
\addcontentsline{toc}{section}{Variable Names and Acronyms}
\printindex[var]{}
\clearpage
\phantomsection
\addcontentsline{toc}{section}{Index}
\printindex[idx]{}

\clearpage

\centerline{-- Blank Page, End of this Technical Report --}
\vfill\eject
\clearpage
\addcontentsline{toc}{chapter}{End}


\end{document}
