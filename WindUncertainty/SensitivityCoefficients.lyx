#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\begin_preamble

\end_preamble
\use_default_options false
\begin_modules
knitr
hanging
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman times
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 0
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 2
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\bullet 1 0 30 -1
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Section
Sensitivity coefficients
\begin_inset CommandInset label
LatexCommand label
name "sec:Calibrations"

\end_inset


\end_layout

\begin_layout Standard
This section reviews the determination of 
\begin_inset Quotes erd
\end_inset

sensitivity coefficients
\begin_inset Quotes erd
\end_inset

 that provide parameterized measurements of the angles of the relative wind
 (angle of attack and sideslip angle) in terms of measured quantities like
 pressure differences between ports on the radome.
 These sensitivity coefficients are essential for measurement of the relative
 wind, as described in Sect.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand formatted
reference "sub:The-Relative-Wind"

\end_inset

, Eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:relative wind"

\end_inset

).
 DEEPWAVE Flight RF15 on 3 July 2014 was devoted to calibration maneuvers,
 and measurements from that flight, combined with similar calibration maneuvers
 flown on RF11 at 40,000 ft, are used to determine sensitivity coefficients
 for angle of attack (AKRD and AK_GP) and for sideslip (SSRD and SS_GP).
 A larger data set, described below, is also used to study the representativenes
s and uncertainty of the resulting sensitivity coefficients.
 This section also discusses some aspects of the relative timing of the
 measurements.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% For reference: The data files used were those produced in the field
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% during the DEEPWAVE project using nimbus code on the ground station
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% at that time.
 Files used were those from RF15, RF11, RF14, and RF16.
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% These data files have been transferred to EOL storage as /scr/rafdata/DEEPWAVE
/DEEPWAVErfxx.nc
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% where xx is the flight number.
 For backup purposes, there is also
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% a zip file of these data files saved as DWCal.zip.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Initialization,echo=FALSE,include=FALSE>>=
\end_layout

\begin_layout Plain Layout

require(Ranadu)
\end_layout

\begin_layout Plain Layout

library(knitr)
\end_layout

\begin_layout Plain Layout

library(zoo)
\end_layout

\begin_layout Plain Layout

# set global chunk options
\end_layout

\begin_layout Plain Layout

opts_chunk$set(fig.path='figure/WU-', fig.lp="fig:", fig.align='center', fig.show='h
old', echo=FALSE, include=FALSE, fig.width=5, fig.height=5, size='footnotesize')
\end_layout

\begin_layout Plain Layout

options(replace.assign=TRUE,width=49, digits=4)
\end_layout

\begin_layout Plain Layout

SummarizeFit <- function(ft) {
\end_layout

\begin_layout Plain Layout

  print (summary(ft)$call)
\end_layout

\begin_layout Plain Layout

  print ("Coefficients:")
\end_layout

\begin_layout Plain Layout

  print (summary(ft)$coefficients)
\end_layout

\begin_layout Plain Layout

  print (sprintf ("Residual standard error: %.3f, dof=%d", summary(ft)$sigma,
 summary(ft)$df[2]))
\end_layout

\begin_layout Plain Layout

  print (sprintf ("R-squared %.3f", summary(ft)$r.squared))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Angle of Attack
\begin_inset CommandInset label
LatexCommand label
name "sub:Calibration-AOA"

\end_inset


\end_layout

\begin_layout Subsubsection
Equations underlying the calibration
\end_layout

\begin_layout Standard
The first-order expression for the vertical wind 
\begin_inset Formula $w$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
w=V\sin(\alpha-\phi)+w_{p}\label{eq:VWind}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $V$
\end_inset

 is the true airspeed, 
\begin_inset Formula $\alpha$
\end_inset

 the angle of attack, 
\begin_inset Formula $\phi$
\end_inset

 the pitch, and 
\begin_inset Formula $w_{p}$
\end_inset

 the vertical motion or rate-of-climb of the aircraft.
 The solution for the angle-of-attack is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha=\phi+\arcsin\frac{w-w_{p}}{V}\label{eq:SolvedForAOA}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If it is reasonable to assume for some period of flight that 
\begin_inset Formula $w$
\end_inset

 is zero, or that it averages to zero, then
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha^{*}=\phi-\arcsin\frac{w_{p}}{V}\label{eq:alphaWithwZero}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
can be used as a reference angle-of-attack to which to fit a parameterized
 formula.
 This fit reference depends on measurements of pitch, rate-of-climb, and
 true airspeed.
 Even in the presence of waves, fitting functions of the radome measurements
 and other flight characteristics to this reference should average any real
 effects of vertical wind as long as the vertical wind over the flight segments
 used averages to zero.
\end_layout

\begin_layout Standard
The danger in this approach is that a particular data set may not have negligibl
e average mean wind.
 For example, if a flight spent more time in the updraft regions in the
 ascending portion upwind of the island and less in the downdraft region
 downwind of the island, the mean measurement of vertical wind may not be
 negligible.
 The functions used for representation of angle of attack always include
 an offset term along with functions of measurements, so it may be appropriate
 to adjust that offset if there is evidence that the mean vertical wind
 should not be zero.
 Other steps can be taken to check that offset coefficient, as discussed
 in subsequent sections.
 One compromise, followed below, is to determine any coefficients other
 than the offset term from comprehensive data sets but then revised the
 constant coefficient in the fit on the basis of special periods expected
 to average to zero vertical wind, like flight over the ocean well away
 from weather disturbances or special calibration flights in conditions
 with apparently level air motions.
 
\end_layout

\begin_layout Standard
In the case of the radome, the relevant variables are 
\begin_inset Formula $\phi$
\end_inset

=PITCH, 
\begin_inset Formula $w_{p}=$
\end_inset

GGVSPDB, and 
\begin_inset Formula $V=$
\end_inset

TASX.
 The radome measures the pressure difference (ADIFR) between top and bottom
 ports on the radome, and this pressure is usually normalized by some measure
 of dynamic pressure like QCF or QCXC or QCRC.
 The former is preferable because the use of corrected QCXC requires the
 application of static-defect corrections that themselves depend on 
\begin_inset Formula $\alpha$
\end_inset

, leading to circularity in the calculation, and QCR and QCRC are sometimes
 affected by icing or freezing of accumulated water even when ADIFR continues
 to function.
\end_layout

\begin_layout Standard
For the gust pod, the relevant variables are 
\begin_inset Formula $\phi$
\end_inset

=CPITCH_GP, 
\begin_inset Formula $w_{p}$
\end_inset

=CVSPD_GP, and 
\begin_inset Formula $V$
\end_inset

=TASX.
 The gust-pod measurements differ from those measured relative to the fuselage;
 for example, the pitch of the gust pod is several degrees different from
 that of the fuselage because of the way in which the gust-pod IRU is installed.
 However, the true airspeed 
\begin_inset Formula $V$
\end_inset

 in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:alphaWithwZero"

\end_inset

) is measured better by the fuselage system, so TASX will be used for 
\begin_inset Formula $V$
\end_inset

.
 The equation with the appropriate variables is then: 
\begin_inset Formula 
\begin{equation}
\alpha^{*}=\mathrm{CPITCH\_GP}-\arcsin\frac{\mathrm{CVSPD\_GP}}{\mathrm{TASX}}\label{eq:AOAeq}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Quotes erd
\end_inset

Calibration
\begin_inset Quotes erd
\end_inset

 of the angle-of-attack (i.e., determining the sensitivity coefficients) then
 requires determining a function 
\begin_inset Formula $f(\{x_{i}\})$
\end_inset

 of measured quantities that matches 
\begin_inset Formula $\alpha^{*}$
\end_inset

 determined from (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAeq"

\end_inset

).
 Possible terms 
\begin_inset Formula $\{x_{i}\}$
\end_inset

 in that function may include ADIFR and related measurements of pressure
 and dynamic pressure as well as Mach number, and powers and products of
 these terms.
 For the Rosemount 858 sensor used with the gust pod, it is expected from
 theory that one element of 
\begin_inset Formula $\{x_{i}\}$
\end_inset

 will be ADIFR_GP/QC_GP.
 Wind tunnel and theoretical studies predict how the pressure will vary
 on a hemispheric surface with changing angles, but those don't necessarily
 apply to the mounting location on the GV because there is considerable
 flow distortion at the under-wing location of the pod and that affects
 the pressure response to changes in flow angles.
 Therefore, the best approach is to use the above approach for that sensor
 also and determine a functional response that matches the calibration data.
\end_layout

\begin_layout Subsubsection
Application to the radome
\begin_inset CommandInset label
LatexCommand label
name "sub:radome-sensitivity"

\end_inset


\end_layout

\begin_layout Standard
The best method for calibrating angle-of-attack is through the use of speed
 runs.
 In this maneuver, the aircraft is slowed to a speed near the lower range
 of its operating range, then accelerated to near the upper limit, and then
 slowed again to normal cruise.
 If this is done while flying a level track, the angle of attack will vary
 through its normal range and the pitch will vary similarly.
 If there is no vertical wind or if a fluctuating vertical wind averages
 to zero, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:alphaWithwZero"

\end_inset

) then can be used to provide a reference angle 
\begin_inset Formula $\alpha^{*}$
\end_inset

 that serves as reference for the parameterized fit.
 There were three speed runs during RF15, at the times 3:21--3:29, 4:15--4:23,
 and 5:01--5:11 UTC.
 On RF11, there was a similar speed run flown from 10:30--10:40.
 For the purpose of this first determination of sensitivity coefficients
 for angle-of-attack, only those periods were used.
 In addition, because some of the measurements at minimum speed deviated
 from the otherwise simple fits, only measurements with true airspeed in
 excess of 130 m/s were used; this eliminated some of the slowest parts
 of the speed runs, but that is a flight speed not used in normal operation.
\end_layout

\begin_layout Standard
In the code being used (cf.
\begin_inset space \space{}
\end_inset

WindUncertainty.Rnw), the line 
\end_layout

\begin_layout LyX-Code
AOAREF <- PITCH - asin(GGVSPDB/TASX) / Cradeg
\end_layout

\begin_layout Standard
represents Eq.
\begin_inset space ~
\end_inset

(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:alphaWithwZero"

\end_inset

).
\end_layout

\begin_layout Standard
The sensitivity to the pressure difference between vertically separated
 ports is the most important part of the calibration of angle of attack.
 Secondary terms are sometimes needed to adjust the value to maintain a
 correct zero.
 Therefore, the fit was done in two stages.
 First, the four speed runs alone were used to determine the sensitivity
 to the pressure ratio, and then a larger dataset was used to incorporate
 a wider range of flight conditions to check that the fit determined from
 the speed runs remained representative of the larger data set..
 The first fit was to the following simplified equation:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha^{*}=c_{0}^{*}+c_{1}^{*}\frac{\Delta p_{\alpha}}{q}\label{eq:AOAsens1term}
\end{equation}

\end_inset

A fit to the data is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:AOA-fit-and-plot"

\end_inset

 and tabulated in the following summary of the fit, which was produced by
 the 
\begin_inset Quotes eld
\end_inset

R
\begin_inset Quotes erd
\end_inset

 call at the top of the listing.
 AOAREFC is 
\begin_inset Formula $\alpha^{*}$
\end_inset

 with correction to pitch as in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Schuler"

\end_inset

and AQR=
\begin_inset Formula $\Delta p_{\alpha}/q$
\end_inset

 .
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<getData-AOA, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

ReloadData = FALSE	# otherwise, retrieve from previously saved data
\end_layout

\begin_layout Plain Layout

Project <- "DEEPWAVE"
\end_layout

\begin_layout Plain Layout

if (ReloadData) {
\end_layout

\begin_layout Plain Layout

  Flight <- "rf15"        # this was the flight with cal maneuvers
\end_layout

\begin_layout Plain Layout

  fname = sprintf("%s%s/%s%s.nc", DataDirectory (), Project, Project, Flight)
\end_layout

\begin_layout Plain Layout

  VarNames <- c("VYC","GGALT","LATC", "LONC", "PSXC", "QCXC",
\end_layout

\begin_layout Plain Layout

              "WDC", "WSC", "GGVEW", "GGVNS", "VEW", "VNS", "TASX",
\end_layout

\begin_layout Plain Layout

              "ADIFR", "AKRD", "SSLIP", "PITCH", 
\end_layout

\begin_layout Plain Layout

              "ROLL", "THDG", "BDIFR", "EWX", "GGALT",
\end_layout

\begin_layout Plain Layout

              "ADIFR_GP", "BDIFR_GP", "PS_GP", "QC_GP",
\end_layout

\begin_layout Plain Layout

              "CROLL_GP", "CPITCH_GP", "CTHDG_GP", "WIC",
\end_layout

\begin_layout Plain Layout

              "CVNS_GP", "CVEW_GP", "VSPD", "CVSPD_GP",
\end_layout

\begin_layout Plain Layout

              "ATX", "GGVSPDB", "QCF", "PSF")
\end_layout

\begin_layout Plain Layout

  D <- getNetCDF (fname, VarNames)      # this handles high-rate data also
\end_layout

\begin_layout Plain Layout

  PC <- CorrectPitch(D)
\end_layout

\begin_layout Plain Layout

  Valid <- (D$TASX > 130)
\end_layout

\begin_layout Plain Layout

  Valid[abs(D$ROLL) > 5] <- FALSE
\end_layout

\begin_layout Plain Layout

  #hist(PC[Valid], xlim=c(-0.02,0.02))
\end_layout

\begin_layout Plain Layout

  D["PITCHC"] <- D$PITCH - PC
\end_layout

\begin_layout Plain Layout

  Flight <- "rf11"        # this had  cal maneuvers at 40K ft
\end_layout

\begin_layout Plain Layout

  fname = sprintf("%s%s/%s%s.nc", DataDirectory (), Project, Project, Flight)
\end_layout

\begin_layout Plain Layout

  D2 <- getNetCDF (fname, VarNames)
\end_layout

\begin_layout Plain Layout

  D2["PITCHC"] <- D2$PITCH - CorrectPitch (D2)
\end_layout

\begin_layout Plain Layout

  r4 <- setRange (D2$Time, 103000,104000)
\end_layout

\begin_layout Plain Layout

  D2 <- D2[r4,]
\end_layout

\begin_layout Plain Layout

  Flight <- "rf16"        # 43000-ft leg
\end_layout

\begin_layout Plain Layout

  fname = sprintf("%s%s/%s%s.nc", DataDirectory (), Project, Project, Flight)
\end_layout

\begin_layout Plain Layout

  D3 <- getNetCDF (fname, VarNames)
\end_layout

\begin_layout Plain Layout

  D3["PITCHC"] <- D3$PITCH - CorrectPitch (D3)
\end_layout

\begin_layout Plain Layout

  r5 <- setRange (D3$Time, 94000,110000)
\end_layout

\begin_layout Plain Layout

  D3 <- D3[r5,]
\end_layout

\begin_layout Plain Layout

  Flight <- "rf14"        # 45000-ft leg
\end_layout

\begin_layout Plain Layout

  fname = sprintf("%s%s/%s%s.nc", DataDirectory (), Project, Project, Flight)
\end_layout

\begin_layout Plain Layout

  D4 <- getNetCDF (fname, VarNames)
\end_layout

\begin_layout Plain Layout

  D4["PITCHC"] <- D4$PITCH - CorrectPitch (D4)
\end_layout

\begin_layout Plain Layout

  r6 <- setRange (D4$Time, 113000,122000)
\end_layout

\begin_layout Plain Layout

  D4 <- D4[r6,]
\end_layout

\begin_layout Plain Layout

  flight = "rf11"
\end_layout

\begin_layout Plain Layout

  fname = sprintf("%s%s/%s%s.nc", DataDirectory (), Project, Project, Flight)
\end_layout

\begin_layout Plain Layout

  D5 <- getNetCDF (fname, VarNames)
\end_layout

\begin_layout Plain Layout

  D5["PITCHC"] <- D5$PITCH - CorrectPitch (D5)
\end_layout

\begin_layout Plain Layout

  r7 <- setRange (D5$Time, 70000, 100000)
\end_layout

\begin_layout Plain Layout

  D5 <- D5[r7,]
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

capnF1 <- "The angle-of-attack determined from the fit to pressure measurements
 from the radome, as a function of the reference angle provided by Equation
 (
\backslash

\backslash
ref{eq:AOAsens1term}), for the combination of data from all four speed runs
 as listed in the text."
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<AOA-fit-and-plot, fig.cap=capnF1, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

if (ReloadData) {
\end_layout

\begin_layout Plain Layout

  r1 <- setRange (D$Time, 32100,32900)
\end_layout

\begin_layout Plain Layout

  r2 <- setRange (D$Time, 41500,42300)
\end_layout

\begin_layout Plain Layout

  r3 <- setRange (D$Time, 50100,51100)
\end_layout

\begin_layout Plain Layout

  # need to add high-altitude segment also to constrain fit:
\end_layout

\begin_layout Plain Layout

  # rf11 103000--104000 is a speed run at 40,000 ft.
\end_layout

\begin_layout Plain Layout

  # useful also to include some data from max altitude:
\end_layout

\begin_layout Plain Layout

  r <- c(r1,r2,r3)
\end_layout

\begin_layout Plain Layout

  DD <- merge(D2, D4, all=TRUE)
\end_layout

\begin_layout Plain Layout

  DD <- merge(DD, D[r,], all=TRUE)
\end_layout

\begin_layout Plain Layout

  DD <- merge (DD, D3, all=TRUE)
\end_layout

\begin_layout Plain Layout

  Data <- merge (DD, D5, all=TRUE)
\end_layout

\begin_layout Plain Layout

  Data2 <- merge (D2, D[r,], all=TRUE)
\end_layout

\begin_layout Plain Layout

  Valid <- (Data2$TASX > 130.)
\end_layout

\begin_layout Plain Layout

  Data2 <- Data2[Valid,]
\end_layout

\begin_layout Plain Layout

  save (Data,Data2,D,D2, file="~/RStudio/DEEPWAVE/CalData.Rdata")
\end_layout

\begin_layout Plain Layout

} else {
\end_layout

\begin_layout Plain Layout

  load (file="~/RStudio/DEEPWAVE/CalData.Rdata")
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

Cradeg <- pi / 180.
\end_layout

\begin_layout Plain Layout

Data2["Mach"] <- MachNumber (Data2$PSF, Data2$QCF)  # uses uncorrected q,
 p
\end_layout

\begin_layout Plain Layout

## use corrected value of PITCHC
\end_layout

\begin_layout Plain Layout

Data2["AOAREFC"] <- Data2$PITCHC - asin(Data2$GGVSPDB/Data2$TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

Data2["AOAREF"]  <- Data2$PITCH  - asin(Data2$GGVSPDB/Data2$TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

Data2["AQR"] <- Data2$ADIFR/Data2$QCF # basic pressure ratio for AO
\end_layout

\begin_layout Plain Layout

fmy <- lm(AOAREFC~AQR, data=Data2)
\end_layout

\begin_layout Plain Layout

#print(summary(fmy))
\end_layout

\begin_layout Plain Layout

SummarizeFit (fmy)
\end_layout

\begin_layout Plain Layout

fmyp <- lm (AOAREF~AQR, data=Data2)
\end_layout

\begin_layout Plain Layout

#print(summary(fmyp))
\end_layout

\begin_layout Plain Layout

cfr <- coefficients (fmy)
\end_layout

\begin_layout Plain Layout

A1 <- cfr[1]+cfr[2]*Data2$AQR
\end_layout

\begin_layout Plain Layout

Data2["A1"] <- A1
\end_layout

\begin_layout Plain Layout

std.coef <- c(4.605, 18.44, 6.75)
\end_layout

\begin_layout Plain Layout

clr <- c("measurements", "fit", "std")
\end_layout

\begin_layout Plain Layout

col <- c ('darkorange', 'darkgreen')
\end_layout

\begin_layout Plain Layout

g <- ggplot (data=Data2, aes(x=AOAREFC))
\end_layout

\begin_layout Plain Layout

g <- g + geom_point (aes(y=A1), colour='blue', pch=19) 
\end_layout

\begin_layout Plain Layout

g <- g + xlab (expression(paste("Reference AOA [",degree,"]")))
\end_layout

\begin_layout Plain Layout

g <- g + ylab (expression(paste("AOA from best-fit equation [",degree,"]")))
\end_layout

\begin_layout Plain Layout

g <- g + geom_smooth (aes(y=A1, colour=clr[2]), method='lm', lwd=2, linetype=2)
\end_layout

\begin_layout Plain Layout

g <- g + scale_colour_manual ("", breaks = clr, values = col)
\end_layout

\begin_layout Plain Layout

g <- g + theme_WAC()
\end_layout

\begin_layout Plain Layout

print (g)
\end_layout

\begin_layout Plain Layout

#plot (Data2$AOAREFC, A1, pch=16, cex=0.8, col='blue', xlab="Ref.
 AOA", ylab="fit AOA")
\end_layout

\begin_layout Plain Layout

#lines (c(-3.,6.), c(-3.,6.), lty=2, lwd=3, col='darkorange')
\end_layout

\begin_layout Plain Layout

capnF1b <- "The angle of attack determined from the simple fit to the pressure
 ratio from the radome, compared to the standard variable AKRD used for
 preliminary processing.
 The 
\end_layout

\begin_layout Plain Layout

points plotted in red are those measured at altitudes between 8 and 9 km
 GPS altitude; all others are plotted as blue symbols."
\end_layout

\begin_layout Plain Layout

capnF2 <- "The angle-of-attack determined from the expanded fit, as a function
 of the reference angle provided by Equation (
\backslash

\backslash
ref{eq:AOAsens1term})."
\end_layout

\begin_layout Plain Layout

capnF1b <- "The angle of attack determined from the simple fit to the pressure
 ratio from the radome, as a function of the angle-of-attack predicted for
 zero vertical wind from the formula in the text (blue shapes), and the
 corresponding distribution that would result from using the standard calibratio
n (green shapes).
 The shapes show the distributions for measurements in centered bins at
 (1/3)-deg increments in the predicted angle-of-attack.
 The dashed orange line is the best fit to the speed-run measurements."
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<AOA-fit-and-plot, fig.cap=capnF1,out.width="300pt",fig.align="center", echo=F>>=
\end_layout

\begin_layout Plain Layout

r1 <- setRange (D$Time, 32100,32900)
\end_layout

\begin_layout Plain Layout

r2 <- setRange (D$Time, 41500,42300)
\end_layout

\begin_layout Plain Layout

r3 <- setRange (D$Time, 50100,51100)
\end_layout

\begin_layout Plain Layout

# need to add high-altitude segment also to constrain fit:
\end_layout

\begin_layout Plain Layout

# rf11 103000--104000 is a speed run at 40,000 ft.
\end_layout

\begin_layout Plain Layout

# useful also to include some data from max altitude:
\end_layout

\begin_layout Plain Layout

r <- c(r1,r2,r3)
\end_layout

\begin_layout Plain Layout

DD <- merge(D2, D4, all=T)
\end_layout

\begin_layout Plain Layout

DD <- merge(DD, D[r,], all=TRUE)
\end_layout

\begin_layout Plain Layout

DD <- merge (DD, D3, all=TRUE)
\end_layout

\begin_layout Plain Layout

Data <- merge (DD, D5, all=TRUE)
\end_layout

\begin_layout Plain Layout

Data2 <- merge (D2, D[r,], all=T)
\end_layout

\begin_layout Plain Layout

Valid <- (Data2$TASX > 130.)
\end_layout

\begin_layout Plain Layout

Data2 <- Data2[Valid,]
\end_layout

\begin_layout Plain Layout

attach(Data2)
\end_layout

\begin_layout Plain Layout

Cradeg <- pi / 180.
\end_layout

\begin_layout Plain Layout

Mach <- MachNumber (PSXC, QCXC)  # uses conventional q, p
\end_layout

\begin_layout Plain Layout

AOAREF <- PITCH - asin(VSPD/TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

AQR <- ADIFR/QCXC # basic pressure ratio for AOA
\end_layout

\begin_layout Plain Layout

fmy <- lm(AOAREF~AQR)
\end_layout

\begin_layout Plain Layout

summary(fmy)
\end_layout

\begin_layout Plain Layout

cfr <- coefficients (fmy)
\end_layout

\begin_layout Plain Layout

A1 <- cfr[1]+cfr[2]*AQR
\end_layout

\begin_layout Plain Layout

plot (AOAREF, A1, pch=16, cex=0.8, col='blue', xlab="Ref.
 AOA", ylab="fit AOA")
\end_layout

\begin_layout Plain Layout

lines (c(-3.,6.), c(-3.,6.), lty=2, lwd=3, col='darkorange')
\end_layout

\begin_layout Plain Layout

capnF1b <- "The angle of attack determined from the simple fit to the pressure
 ratio from the radome, compared to the standard variable AKRD used for
 preliminary processing.
 The 
\end_layout

\begin_layout Plain Layout

points plotted in red are those measured at altitudes between 8 and 9 km
 GPS altitude; all others are plotted as blue symbols."
\end_layout

\begin_layout Plain Layout

capnF2 <- "The angle-of-attack determined from the expanded fit, as a function
 of the reference angle provided by Equation (3)."
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{kframe}
\end_layout

\end_inset

 
\end_layout

\begin_layout Verbatim

\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{kframe}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-AOA-fit-and-plot.pdf
	width 300pt

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
The angle-of-attack determined from the fit, as a function of the reference
 angle provided by Equation (3), for the combination of data from all four
 speed runs as listed in the text
\end_layout

\end_inset

The angle-of-attack determined from the fit, as a function of the reference
 angle provided by Equation (3), for the combination of data from all four
 speed runs as listed in the text.
\begin_inset CommandInset label
LatexCommand label
name "fig:AOA-fit-and-plot"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This fit gave coefficients 
\begin_inset Formula $c_{0}^{*}$
\end_inset

 and 
\begin_inset Formula $c_{1}^{*}$
\end_inset

 equal to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(summary(fmy)$coef[1],3), nsmall=3)}
\end_layout

\end_inset

 and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fmy)$coef[2],3)}
\end_layout

\end_inset

.
 The fit accounted for 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(100*summary(fmy)$r.squared, 1)}
\end_layout

\end_inset

% of the variance and had a residual standard error of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fmy)$sigma, 2)}
\end_layout

\end_inset


\begin_inset Formula $^{\circ}$
\end_inset

, so it represented the speed runs well.
 In Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:AOA-fit-and-plot"

\end_inset

, the thin grey line under the thick orange dashed line represents the uncertain
ty in the fit result and shows that the uncertainty in representing these
 data with this set of coefficients is negligible.
 The more significant uncertainty, however, comes from the assumption that
 the vertical wind is zero for these periods of the speed runs.
 Therefore, additional studies will be used below for further evaluation
 of the uncertainty introduced by this assumption.
\end_layout

\begin_layout Standard
This calibration would be affected by a time difference between the IRU
 measurement of pitch and the data-system sampling of the pressures involved,
 especially that from the radome.
 The IRU outputs measurements with a time delay that can be variable and
 unknown but is expected to be <0.1
\begin_inset space ~
\end_inset

s, and normal processing uses an adjustment of 60
\begin_inset space ~
\end_inset

ms to compensate for this delay.
 To guard against this delay affecting the calibration, a series of fits
 like that leading to the above formula and coefficients were performed
 after shifting the measurement of pitch by various time intervals, both
 forward and backward.
 For shifts within about 0.5
\begin_inset space \thinspace{}
\end_inset

s, the results did not change significantly, although the fit with adjustment
 of pitch 
\emph on
backward
\emph default
 by about 0.5
\begin_inset space \thinspace{}
\end_inset

s had the smallest standard error .
 Equivalently, a similar standard error was obtained if the measurement
 of the pressure ratio from the radome (
\begin_inset Formula $\delta p_{\alpha}$
\end_inset

) were moved forward in time by a similar amount.
 Neither of these shifts seems likely at this magnitude, and the change
 in standard error was only about 0.002
\begin_inset Formula $^{\circ}$
\end_inset

, so we interpret this as indicating insensitivity of the calibration to
 small shifts in time.
 That is likely a result of the calibration data being from speed runs where
 the flight speed is gradually increased and then decreased, so any effect
 of a lag partially cancels in such data segments.
\end_layout

\begin_layout Standard
The calibration would also be affected by pitch errors such as are discussed
 in Sect.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Schuler"

\end_inset

.
 Therefore the correction procedure discussed in that section was applied
 to these data before finding the preceding fit.
 In comparison to the fit without this correction, the standard error was
 changed only negligibly and the two fit coefficients changed by -0.007 and
 -0.004, respectively, so this correction also had only minor effect on the
 fit, with changes comparable to or smaller than the standard errors in
 these coefficients.
 This insensitivity perhaps arises because the period of the calibration
 spanned a few hours and so included enough time for the Schuler oscillation
 of pitch to average over the dataset used for calibration.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<adjust-timing, include=TRUE, eval=FALSE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

## try adjusting timing of pitch measurement:
\end_layout

\begin_layout Plain Layout

MakeHR <- function (X) {
\end_layout

\begin_layout Plain Layout

  DL <- length(X)
\end_layout

\begin_layout Plain Layout

  Padj <- vector ("numeric", 25*DL)
\end_layout

\begin_layout Plain Layout

  for (k in 2:(DL-1)) {
\end_layout

\begin_layout Plain Layout

    if ((is.na(X[k])) | (X[k] == -32767) | is.na(X[k-1]) | is.na(X[k+1])) {
\end_layout

\begin_layout Plain Layout

      for (j in 1:25) {
\end_layout

\begin_layout Plain Layout

        Padj[(k-1)*25+j] <- -32767
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

    } else {
\end_layout

\begin_layout Plain Layout

      for (j in 0:12) {
\end_layout

\begin_layout Plain Layout

        Padj[(k-1)*25+j+1] <- X[k-1]+0.04*(j+13)*(X[k]-X[k-1])
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

      for (j in 13:24) {
\end_layout

\begin_layout Plain Layout

        Padj[(k-1)*25+j+1] <- X[k]+0.04*(j-12)*(X[k+1]-X[k])
\end_layout

\begin_layout Plain Layout

      }
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  # just replicate the start and end measurements
\end_layout

\begin_layout Plain Layout

  k <- 1
\end_layout

\begin_layout Plain Layout

  if (is.na(X[k]) | is.na(X[k+1])) {
\end_layout

\begin_layout Plain Layout

    for (j in 1:25) {
\end_layout

\begin_layout Plain Layout

      Padj[j] <- -32767.
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    for (j in 0:12) {
\end_layout

\begin_layout Plain Layout

      Padj[(k-1)*25+j+1] <- X[k]
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    for (j in 13:24) {
\end_layout

\begin_layout Plain Layout

      Padj[(k-1)*25+j+1] <- X[k]+0.04*(j-12)*(X[k+1]-X[k])
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  k <- DL
\end_layout

\begin_layout Plain Layout

  if (is.na(X[k]) | is.na(X[k-1])) {
\end_layout

\begin_layout Plain Layout

    for (j in 1:25) {
\end_layout

\begin_layout Plain Layout

      Padj[j] <- -32767.
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  } else {
\end_layout

\begin_layout Plain Layout

    for (j in 0:12) {
\end_layout

\begin_layout Plain Layout

      Padj[(k-1)*25+j+1] <- X[k-1]+0.04*(j+13)*(X[k]-X[k-1])
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

    for (j in 13:24) {
\end_layout

\begin_layout Plain Layout

      Padj[(k-1)*25+j+1] <- X[k]
\end_layout

\begin_layout Plain Layout

    }
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  #T <- filter(butter(3,2./25.),T)
\end_layout

\begin_layout Plain Layout

  Padj <- signal::filter(signal::sgolay(4,75),Padj)
\end_layout

\begin_layout Plain Layout

  return (Padj)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

<<cycle-thru-times, include=TRUE, eval=FALSE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

DPITCH <- c(D$PITCH[1], D$PITCH[1:(length(D$PITCH)-1)]) 
\end_layout

\begin_layout Plain Layout

D2PITCH <- c(D2$PITCH[1], D2$PITCH[1:(length(D2$PITCH)-1)]) 
\end_layout

\begin_layout Plain Layout

#DPITCH <- c(D$PITCH[2:length(D$PITCH)], D$PITCH[length(D$PITCH)])
\end_layout

\begin_layout Plain Layout

#D2PITCH <- c(D2$PITCH[2:length(D2$PITCH)], D2$PITCH[length(D2$PITCH)])
\end_layout

\begin_layout Plain Layout

Padj1 <- MakeHR (DPITCH)
\end_layout

\begin_layout Plain Layout

Padj2 <- MakeHR (D2PITCH)
\end_layout

\begin_layout Plain Layout

Padj <- c(Padj2, Padj1)
\end_layout

\begin_layout Plain Layout

rf <- c(r4,(r+length(D2$Time)))
\end_layout

\begin_layout Plain Layout

DL <- length(D$TASX) + length(D2$TASX)
\end_layout

\begin_layout Plain Layout

for (j in 1:25) {
\end_layout

\begin_layout Plain Layout

  ix <- seq(j, 25*DL, by=25)
\end_layout

\begin_layout Plain Layout

  Pt <- Padj[ix]
\end_layout

\begin_layout Plain Layout

  Pt <- Pt[rf]
\end_layout

\begin_layout Plain Layout

  Pt <- Pt[Valid]
\end_layout

\begin_layout Plain Layout

  Aref <- Pt - (Data2$GGVSPDB/Data2$TASX)*180/pi
\end_layout

\begin_layout Plain Layout

  ft <- lm(Aref ~ Data2$AQR)
\end_layout

\begin_layout Plain Layout

  print(sprintf("j=%d, stderr=%f", j, summary(ft)$sigma))
\end_layout

\begin_layout Plain Layout

  if (j == 24) {
\end_layout

\begin_layout Plain Layout

    cft <- coefficients(ft)
\end_layout

\begin_layout Plain Layout

    plot (Aref, cft[1]+cft[2]*Data2$AQR, pch=20, col='blue')
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Previous studies of the radome where low-altitude flight segments were included
 indicated that an additional term was needed in the calibration to adjust
 the zero for vertical wind for flight in the boundary layer over the ocean.
 The standard calibration determined in that way is that given in the RAF
 document on 
\begin_inset CommandInset href
LatexCommand href
name "Processing Algorithms"
target "https://drive.google.com/open?id=0B1kIUH45ca5Ab2Z6cld1M1cydjA&authuser=0"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha=c_{0}^{\prime}+\frac{\Delta p_{\alpha}}{q}(c_{1}^{\prime}+c_{2}^{\prime}M)\label{eq:AOAstandard}
\end{equation}

\end_inset

with coefficients {
\begin_inset Formula $c^{\prime}$
\end_inset

} = {4.604, 18.67, 6.49}.
 The last term provides some adjustment dependent on Mach number and corrects
 an offset often seen in vertical wind at low airspeed.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-AOA-vs-Standard.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
The angle of attack determined from the simple fit to the pressure ratio
 from the radome, as a function of the angle-of-attack predicted for zero
 vertical wind from the formula in the text (blue shapes), and the corresponding
 distribution that would result from using the standard calibration (green
 shapes)
\end_layout

\end_inset

The angle of attack determined from the simple fit to the pressure ratio
 from the radome, as a function of the angle-of-attack predicted for zero
 vertical wind from the formula in the text (blue shapes), and the corresponding
 distribution that would result from using the standard calibration (green
 shapes).
 The shapes show the distributions for measurements in centered bins at
 (1/3)-deg increments in the predicted angle-of-attack.
 The dashed orange line is the best fit to the speed-run measurements.
\begin_inset CommandInset label
LatexCommand label
name "fig:AOA-vs-Standard"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:plot-comparison-to-standard}
\end_layout

\end_inset

 shows the angle of attack determined from this fit vs.
\begin_inset space \space{}
\end_inset

that from the standard formula.
 The plotted shapes show the distribution in values for centered intervals
 in the predicted angle-of-attack of (1/3) degree, where the blue shapes
 and orange line are the results from the fit to the speed-run measurements
 and the green shapes are the distributions that would result from using
 the standard calibration.
 The standard calibration is close close to that determined from the speed
 runs, but the RMS difference between predicted values and fit values increases
 from 0.12
\begin_inset Formula $^{\circ}$
\end_inset

 for the speed-run fit to 0.15
\begin_inset Formula $^{\circ}$
\end_inset

 for the standard fit.
 The difference is most evident for measurements at large angle-of-attack,
 where the standard coefficients produce increasingly higher values as the
 angle-of-attack increases.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<plot-comparison-to-standard, fig.cap=capnF1b, warning=FALSE, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

# plot (AKRD, A1, pch=16, cex=0.8, col='blue', xlab="Standard", ylab="fit
 AOA")
\end_layout

\begin_layout Plain Layout

# r <- ((GGALT > 8000.) & (GGALT < 9000))
\end_layout

\begin_layout Plain Layout

# points (AKRD[r], A1[r],
\end_layout

\begin_layout Plain Layout

#         pch=16,cex=0.8, col='red')
\end_layout

\begin_layout Plain Layout

# lines (c(-3.,6.), c(-3.,6.), lty=2, lwd=3, col='darkorange')
\end_layout

\begin_layout Plain Layout

cfs <- c(4.604, 18.67, 6.49)
\end_layout

\begin_layout Plain Layout

AQRM <- Data2$AQR * Data2$Mach
\end_layout

\begin_layout Plain Layout

Astd <- cfs[1]+cfs[2]*Data2$AQR+cfs[3]*AQRM
\end_layout

\begin_layout Plain Layout

Data2["Astd"] <- Astd
\end_layout

\begin_layout Plain Layout

clr <- c("speed-run fit", "standard")
\end_layout

\begin_layout Plain Layout

col <- c("lightblue", "darkgreen")
\end_layout

\begin_layout Plain Layout

#g <- qplot(D$AOAREF,D$A,geom="violin", group = plyr::round_any(D$AOAREF,0.5,
 round),  fill=clr[1])
\end_layout

\begin_layout Plain Layout

g <- ggplot(data=Data2, aes(x=AOAREF,y=A1))
\end_layout

\begin_layout Plain Layout

g <- g + scale_fill_manual(name="distributions:", labels=clr, values = col)
\end_layout

\begin_layout Plain Layout

g <- g + geom_violin(aes(group = plyr::round_any(AOAREF, 0.33333, round),
 fill=clr[1]), alpha=1/2)
\end_layout

\begin_layout Plain Layout

#g <- g + geom_violin(aes(y=A2,group = plyr::round_any(AOAREF, 0.5, round),
 fill=clr[2]), alpha=1/2)
\end_layout

\begin_layout Plain Layout

g <- g + geom_violin(aes(y=Astd,group = plyr::round_any(AOAREF, 0.33333,
 round), fill=clr[2]), alpha=1/2)
\end_layout

\begin_layout Plain Layout

#g <- g + geom_text (aes(label="best-fit residual error: 0.09 deg", x=3,y=1),
 size=8)
\end_layout

\begin_layout Plain Layout

xsz = 2.6
\end_layout

\begin_layout Plain Layout

ysz = 0.30
\end_layout

\begin_layout Plain Layout

# g <- g + geom_rect(aes(xmin=3.5-xsz/2.,xmax=3.5+xsz/2.,ymin=0.6-ysz/2.,ymax=0.6+ysz/2.
), fill="lightyellow", colour="blue")
\end_layout

\begin_layout Plain Layout

# g <- g + annotate("text", label="speed-run-fit residual: 0.12 deg.", x=3.5,y=0.6,s
ize=6, colour="red")
\end_layout

\begin_layout Plain Layout

g <- g + xlab (expression(paste("Predicted AOA [", degree, "]")))
\end_layout

\begin_layout Plain Layout

g <- g + ylab (expression(paste("AOA from fit [",degree,"]"))) + ylim(0.,6.)
\end_layout

\begin_layout Plain Layout

g <- g + geom_line(aes(y=AOAREF), colour="darkorange", lwd=2, linetype=2)
\end_layout

\begin_layout Plain Layout

g <- g + theme_WAC ()
\end_layout

\begin_layout Plain Layout

g
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% For
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% comparison, the next figure (Fig.
\backslash
 2) shows the angle of attack determined
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% from this fit vs.
\backslash
 that from the standard processing being used for
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% preliminary field processing and onboard display during DEEPWAVE.
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% There is a clear discrepancy, which arises from flight at between
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% 8,000 and 9,000 m.
 This also causes a significant offset in WIC at
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% these altitudes.
 This is simply an error in the calibration in use,
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% which traces back to much earlier projects and does not match the
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% algorithm documents or other recommendations for this calibration.
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% It will be important to use the new calibration for processing to
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% eliminate the offset arising from this old calibration.
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\backslash
begin{figure}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% {
\backslash
centering 
\backslash
includegraphics{figure/GP-AOA-vs-old-AOA}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% }
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\backslash
protect
\backslash
caption[The angle of attack determined from the simple fit to the pressure
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% ratio from the radome, compared to the standard variable AKRD used
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% for preliminary processing]{The angle of attack determined from the simple
 fit to the pressure
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% ratio from the radome, compared to the standard variable AKRD used
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% for preliminary processing.
 The points plotted in red are those measured
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% at altitudes between 8 and 9 km GPS altitude; all others are plotted
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% as blue symbols.
\backslash
label{fig:AOA-vs-old-AOA}}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\backslash
end{figure}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because the standard fit in use for the GV include an additional terms represent
ing dependence on Mach number, the benefit of using such a fit for DEEPWAVE
 is worth considering.
 The primary reason for that fit has been that otherwise the measurements
 of vertical wind at low level tend to be biased, but most of the useful
 flight data from DEEPWAVE was at intermediate or high levels so this may
 not be a concern for this project.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fit-to-standard-eq, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

fm3term <- lm(AOAREF~AQR+AQRM, data=Data2)
\end_layout

\begin_layout Plain Layout

# print (summary(fm3term))
\end_layout

\begin_layout Plain Layout

SummarizeFit (fm3term)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fitting (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAstandard"

\end_inset

) to the speed-run data gave a standard error that is reduced by <0.006
\begin_inset Formula $^{\circ}$
\end_inset

, so for those measurements this small improvement does not seem to justify
 adding another term to the fit.
 This will be revisited later in this section with an expanded data set.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fit-to-corrected-pitch, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

Data2["AOAREFC"] <- Data2$PITCHC - asin(Data2$GGVSPDB/Data2$TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

fmyc <- lm(AOAREFC~AQR, data=Data2)
\end_layout

\begin_layout Plain Layout

# print(summary(fmyc))
\end_layout

\begin_layout Plain Layout

SummarizeFit (fmyc)
\end_layout

\begin_layout Plain Layout

cfrc <- coefficients (fmyc)
\end_layout

\begin_layout Plain Layout

Data2["A1C"] <- cfrc[1]+cfrc[2]*Data2$AQR
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The next step was to expand the data set to include flights from a range
 of altitudes including up to FL450, and to see if it is necessary to refine
 the fit to include additional terms like that in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAstandard"

\end_inset

 to constrain the zero of the angle-of-attack while preserving the measured
 sensitivity as in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAsens1term"

\end_inset

).
 The expanded dataset included RF14, with a FL450 leg from 11:30 to 12:20
 UTC; RF16, with a FL430 leg from 9:30 to 11:00 UTC; and an expanded section
 from RF11 (in addition to the speed runs) from 7:00 to 10:00 UTC, to include
 a long leg at FL400.
\end_layout

\begin_layout Standard
Various fit equations were explored involving terms including the Mach number,
 the air density, the measured pressures, and various products and powers
 of these terms including terms multiplied by the basic pressure ratio already
 included in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAsens1term"

\end_inset

).
 None of these produced enough improvement over the single-term fit to warrant
 their inclusion; the best improvement in the residual standard error was
 about 2%.
\begin_inset Foot
status open

\begin_layout Plain Layout
Additional terms that did improve the fit significantly were those correlated
 with the terms in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:alphaWithwZero"

\end_inset

, esp.
\begin_inset space ~
\end_inset

pitch, but including such terms is not consistent with finding a fit that
 would represent the angle-of-attack in conditions with non-zero vertical
 wind.
 For example, including "PITCH" as a term in the fit resulted in a coefficient
 for this term of about 0.4, and such a large correlation between resulting
 measurements of angle-of-attack and pitch would bias the response to a
 true vertical wind.
 As an extreme example, inclusion of a term based on the right side of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:alphaWithwZero"

\end_inset

 leads to a perfect fit, but use of such a fit would ensure that all measurement
s of vertical wind would be zero.
 For this reason, pitch and vertical aircraft motion were excluded from
 the candidate terms in the fit.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<switch-to-larger-dataset, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# now expand to larger dataset
\end_layout

\begin_layout Plain Layout

Valid <- (Data$TASX > 130.) & (abs(Data$ROLL) < 5.)
\end_layout

\begin_layout Plain Layout

Data <- Data[Valid,]
\end_layout

\begin_layout Plain Layout

Data["Mach"] <- MachNumber (Data$PSF, Data$QCF)  # uses uncorrected q, p
\end_layout

\begin_layout Plain Layout

Data["AOAREFC"] <- Data$PITCHC - asin(Data$GGVSPDB/Data$TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

Data["AOAREF"] <- Data$PITCH - asin(Data$GGVSPDB/Data$TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

Data["AQR"] <- Data$ADIFR/Data$QCF # basic pressure ratio for AOA
\end_layout

\begin_layout Plain Layout

Data$RR2 <- Data$QCF/Data$PSF    # q/p ratio
\end_layout

\begin_layout Plain Layout

Data$AQRM <- Data$AQR * Data$Mach
\end_layout

\begin_layout Plain Layout

Data$AQRM2 <- Data$AQR * Data$Mach**2
\end_layout

\begin_layout Plain Layout

Data$AQRM3 <- Data$AQR * Data$Mach**3
\end_layout

\begin_layout Plain Layout

Data$DENS <- Data$PSF / (Data$ATX+273.15)
\end_layout

\begin_layout Plain Layout

fmall <- lm (AOAREFC~AQR+AQRM+AQRM2+AQRM3+RR2+Mach+DENS, data=Data)
\end_layout

\begin_layout Plain Layout

fmnorm <- lm (AOAREFC~AQR+AQRM, data=Data)
\end_layout

\begin_layout Plain Layout

fm <- lm (AOAREFC~AQR, data=Data)
\end_layout

\begin_layout Plain Layout

fmu <- lm (AOAREF~AQR, data=Data)
\end_layout

\begin_layout Plain Layout

fmconst <- lm (AOAREFC-cfr[2]*AQR ~ 1, data=Data)
\end_layout

\begin_layout Plain Layout

# summary(fmall)
\end_layout

\begin_layout Plain Layout

# summary(fmnorm)
\end_layout

\begin_layout Plain Layout

# summary(fm)
\end_layout

\begin_layout Plain Layout

# summary (fmu)
\end_layout

\begin_layout Plain Layout

# summary(fmconst)
\end_layout

\begin_layout Plain Layout

#plot (AOAREFC, AKRD, pch=16, cex=0.7, col='blue')
\end_layout

\begin_layout Plain Layout

#fm <- lm (AOAREFC~AQR+RR2+PS_GP+QC_GP+Mach)
\end_layout

\begin_layout Plain Layout

#fm <- lm (AOAREFC~AQR+RR2+Mach)
\end_layout

\begin_layout Plain Layout

cf3 <- coefficients (fm)
\end_layout

\begin_layout Plain Layout

cf31 <- cf3[1]
\end_layout

\begin_layout Plain Layout

cf32 <- cf3[2]
\end_layout

\begin_layout Plain Layout

sd3 <- summary(fm)$sigma
\end_layout

\begin_layout Plain Layout

#print(c("Fit coefficients are: ",cf3))
\end_layout

\begin_layout Plain Layout

#print(summary(fm))
\end_layout

\begin_layout Plain Layout

#A3 <- cf3[1] + cf3[2]*Data$AQR + cf3[2]*Data$AQRM + cf3[3]*Data$AQRM2 
\end_layout

\begin_layout Plain Layout

#      + cf3[4]*Data$AQRM3 + cf3[5]*Data$Mach
\end_layout

\begin_layout Plain Layout

Data$A3 <- cf3[1]+cf3[2]*Data$AQR
\end_layout

\begin_layout Plain Layout

Data$A1 <- cfr[1]+cfr[2]*Data$AQR
\end_layout

\begin_layout Plain Layout

cfs <- c(4.604, 18.67, 6.49)
\end_layout

\begin_layout Plain Layout

Data$A3std <- cfs[1]+cfs[2]*Data$AQR+cfs[3]*Data$AQRM
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results from the two-coefficient fit to the larger data set, using
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\alpha=c_{0}+c_{1}\frac{\Delta p_{\alpha}}{q}\,\,\,,\label{eq:AOArecommended}
\end{equation}

\end_inset

led to best-fit coefficients {
\begin_inset Formula $c_{0},\, c_{1}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf31,3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf32,3)}
\end_layout

\end_inset

} and a standard error of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fm)$sigma,2)}
\end_layout

\end_inset

 for 17,715 measurements.
 The small increase in standard error in comparison to the speed-run measurement
s is expected because this expanded data set includes regions more likely
 to have non-zero vertical wind, which contributes to this error.
 Expanding this fit to include a third coefficient as in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAstandard"

\end_inset

) resulted in negligible improvement (0.0001
\begin_inset Formula $^{\circ}$
\end_inset

) in the standard error, and introduction of a set of eight possible dependencie
s while exploring for better fits only led to reduction in the the standard
 error by 0.003
\begin_inset Formula $^{\circ}$
\end_inset

, so more complicated equations than (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOArecommended"

\end_inset

) do not appear to be needed.
\begin_inset Foot
status open

\begin_layout Plain Layout
This simpler representation applies to the normal research flight levels
 of the DEEPWAVE project, levels above about 10,000 ft.
 Because expanded representations were needed in other projects to represent
 low-level flight data, and low levels are not included in this expended
 data set, it may be necessary to revisit this calibration with more terms
 if lower-level flight segments are to be analyzed.
\end_layout

\end_inset

 Another fit considered with this expanded data set was to set the slope
 parameter to the value obtained from the speed-run data, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfr[2], 3)}
\end_layout

\end_inset

, and then fit using the expanded data set to determine a value of the offset
 coefficient that minimized the mean vertical wind.
 That gave a value for the first coefficient of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fmconst)$coefficients[1], 3)}
\end_layout

\end_inset

 and a standard error negligibly different from that for the two-coefficient
 fit, so that is another indication that the speed-run dataset and the expanded
 dataset give consistent results.
 
\end_layout

\begin_layout Standard
The recommended calibration for DEEPWAVE, determined with correction of
 the pitch errors as discussed in Sect.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Schuler"

\end_inset

, is (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOArecommended"

\end_inset

) with these values for the coefficients: {
\begin_inset Formula $c_{0},\, c_{1}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf31,3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf32,3)}
\end_layout

\end_inset

}.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
The improvement in standard error using the corrected measurements was only
 0.0006
\begin_inset Formula $^{\circ}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Evaluation of all the points in the larger dataset using three fits, for
 the larger dataset, for the speed runs alone, and using the "standard"
 fit discussed above, gave only very small differences in the results: the
 angle-of-attack evaluated from the larger-dataset coefficients resulted
 in values 0.029
\begin_inset Formula $\pm$
\end_inset

0.007
\begin_inset Formula $^{\circ}$
\end_inset

 larger than those from the speed-run coefficients and 0.025
\begin_inset Formula $\pm$
\end_inset

0.045
\begin_inset Formula $^{\circ}$
\end_inset

 larger than those from the standard coefficients, so using any of these
 formulas would give about the same results.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<second-violin-plot, include=TRUE, warning=FALSE, fig.cap="Distributions
 in the angle-of-attack determined from the two-coefficient fit to the expanded
 dataset, plotted with the distributions that would result from use of the
 equation based on the speed-runs only.
 The pink color denotes regions covered by both distributions.">>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

## DF <- data.frame(Time)
\end_layout

\begin_layout Plain Layout

## DF["AOAREF"] <- AOAREF
\end_layout

\begin_layout Plain Layout

## DF["A3"] <- A3
\end_layout

\begin_layout Plain Layout

## DF["A3std"] <- A3std
\end_layout

\begin_layout Plain Layout

## DF["A1"] <- A1
\end_layout

\begin_layout Plain Layout

clr <- c("larger-dataset fit", "speed-run fit")
\end_layout

\begin_layout Plain Layout

col <- c("red", "lightblue")
\end_layout

\begin_layout Plain Layout

#g <- qplot(D$AOAREF,D$A,geom="violin", group = plyr::round_any(D$AOAREF,0.5,
 round),  fill=clr[1])
\end_layout

\begin_layout Plain Layout

g <- ggplot(data=Data, aes(x=AOAREFC,y=A3))
\end_layout

\begin_layout Plain Layout

g <- g + scale_fill_manual(name="distribution", labels=clr, values = col)
\end_layout

\begin_layout Plain Layout

g <- g + geom_violin(aes(group = plyr::round_any(AOAREFC, 0.33333, round),
 fill=clr[1]), alpha=1/2)
\end_layout

\begin_layout Plain Layout

#g <- g + geom_violin(aes(y=A2,group = plyr::round_any(AOAREFC, 0.5, round),
 fill=clr[2]), alpha=1/2)
\end_layout

\begin_layout Plain Layout

g <- g + geom_violin(aes(y=A1,group = plyr::round_any(AOAREFC, 0.33333, round),
 fill=clr[2]), alpha=1/2)
\end_layout

\begin_layout Plain Layout

#g <- g + geom_text (aes(label="best-fit residual error: 0.09 deg", x=3,y=1),
 size=8)
\end_layout

\begin_layout Plain Layout

xsz = 2.8
\end_layout

\begin_layout Plain Layout

ysz = 0.30
\end_layout

\begin_layout Plain Layout

g <- g + geom_rect(aes(xmin=3.5-xsz/2.,xmax=3.5+xsz/2.,ymin=0.6-ysz/2.,ymax=0.6+ysz/2.),
 fill="lightyellow", colour="blue")
\end_layout

\begin_layout Plain Layout

g <- g + annotate("text", label="larger-data-set residual: 0.13 deg.", x=3.5,y=0.6,s
ize=6, colour="red")
\end_layout

\begin_layout Plain Layout

g <- g + xlab (expression(paste("Reference AOA [", degree, "]")))
\end_layout

\begin_layout Plain Layout

g <- g + ylab (expression(paste("AOA from fit [",degree,"]"))) + ylim(0.,6.)
\end_layout

\begin_layout Plain Layout

g <- g + geom_line(aes(y=AOAREF), colour="darkorange", lwd=2, linetype=2)
\end_layout

\begin_layout Plain Layout

g <- g + theme_WAC ()
\end_layout

\begin_layout Plain Layout

g
\end_layout

\begin_layout Plain Layout

#plot (AOAREF, A2, xlab="Predicted AOA [deg.]", 
\end_layout

\begin_layout Plain Layout

#         ylab="Fit AOA [deg.]", type='p', pch=16, cex=0.7, col='blue')
\end_layout

\begin_layout Plain Layout

#points (AOAREF, A2std, pch=16, cex=0.7,col='red')
\end_layout

\begin_layout Plain Layout

#lines (c(-3.,6.), c(-3.,6.), lty=2, lwd=3, col='orange')
\end_layout

\begin_layout Plain Layout

#title("Radome")
\end_layout

\begin_layout Plain Layout

capnF1c <- "Comparison of angle of attack determined from (6) to the reference
 data for the four speed runs."
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:second-violin-plot}
\end_layout

\end_inset

 the values of angle-of-attack obtained using the fit to data from the expanded
 dataset are compared to those obtained using the fit to the speed-run dataset.
 For all the points in the larger dataset, the respective differences in
 the average angle-of-attack between the speed-run fit and the expanded-data-set
 fit and between the speed-run fit and the standard fit (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAstandard"

\end_inset

) were 0.029
\begin_inset Formula $\pm$
\end_inset

0.007
\begin_inset Formula $^{\circ}$
\end_inset

 and 0.025
\begin_inset Formula $\pm$
\end_inset

0.045
\begin_inset Formula $^{\circ}$
\end_inset

.
 This indicates that any of these formulas would give about the same results
 and that one measure of uncertainty in the results from applying these
 fits is that the various fits differ by about 0.03
\begin_inset Formula $^{\circ}$
\end_inset

 in resulting angle-of-attack.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-plot-for-larger-dataset.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
Angle-of-attack from fit vs predicted values, for a larger dataset, and
 comparison to the speed-run-only calibration
\end_layout

\end_inset

Angle-of-attack from fit vs predicted values, for a larger dataset, and
 comparison to the speed-run-only calibration
\begin_inset CommandInset label
LatexCommand label
name "fig:plot-for-larger-dataset"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:AOA-plot"

\end_inset

 shows the angle-of-attack as a function of 
\begin_inset Formula $\frac{\Delta p_{\alpha}}{q}$
\end_inset

 for various values of the Mach number, for the sensitivity coefficients
 proposed for use in DEEPWAVE and also for the standard coefficients.
 The different colors represent different values of the Mach number for
 the standard coefficients.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-AOA-plot.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
Plot of angle-of-attack vs the pressure ratio from the radome, parameterized
 by the value of the Mach number
\end_layout

\end_inset

Plot of angle-of-attack vs the pressure ratio from the radome, parameterized
 by the value of the Mach number.
 The dashed thicker orange line labeled DW is the calibration proposed for
 use in DEEPWAVE; the solid thin lines represent the standard formula for
 the indicated values of the Mach number.
\begin_inset CommandInset label
LatexCommand label
name "fig:AOA-plot"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% The best fit to the expanded dataset, keeping $c_1^{*}$ fixed as given
 in (
\backslash
ref{eq:AOAsens1term}), was% the following equation:% % 
\backslash
begin{equation}% 
\backslash
alpha=c_{0}+
\backslash
frac{
\backslash
Delta p_{
\backslash
alpha}}{q}(c_{1}^{*}+c_{1}M+c_{2}M^{2}+c_{3}M^{3})+c_{4}M
\backslash
label{eq:BestFitAOAradome}% 
\backslash
end{equation}% with coefficients 
\backslash
{$c_{i}$
\backslash
}=
\backslash
{4.1079717, 82.6157340, -135.8737038,% 77.4028078, 0.5531502
\backslash
} and $c_1^*$ =21.872829.
 The results are shown in the following figure, and a summary of the fit
 is listed also.
 The residual error in angle of attack was 0.11$^
\backslash
circ$ for the 17,168 points used in the fit, and all terms in (
\backslash
ref{eq:BestFitAOAradome}) tested as having high significance.
 (The variables listed as AQRMx are $
\backslash
frac{
\backslash
Delta p_{
\backslash
alpha}}{q}M^x$ where $M$ is the Mach number.)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The standard errors in the coefficients for the larger dataset are respectively
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fm)$coefficients[1,2],4)}
\end_layout

\end_inset

 and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fm)$coefficients[2,2],3)}
\end_layout

\end_inset

, so the coefficients are tightly constrained by the fit.
 Surprisingly, the correlation between error terms was very high and positive,
 increasing the combined effects of these errors in any calculation of angle-of-
attack.
 The larger dataset provided results consistent with those from the speed
 runs alone but contained 17,721 measurements vs.
\begin_inset space ~
\end_inset

only 2,019 for the speed-run dataset, so the larger set provides an opportunity
 to examine the consistency of results from subsets of the measurements.
 For this purpose, randomly selected but exclusive subsets of the data were
 selected repeatedly and the fit coefficients were determined from each
 of these subsets.
 In one example, the dataset was divided randomly into 100 subsets and the
 fit coefficients calculated for each of those subsets, and then this process
 was repeated 50 times.
 The resulting standard deviations in the fit coefficients were 0.070 and
 0.88.
 Repeating this for different subset sizes 
\begin_inset Formula $N$
\end_inset

 indicated that the standard deviations in the coefficients scaled in a
 manner consistent with 
\begin_inset Formula $\sqrt{N}$
\end_inset

 behavior, suggesting that the results are not biased by isolated outlier
 measurements such as would occur from regions with true vertical wind.
 The subsetting also revealed that the individual coefficients were highly
 correlated, with correlation coefficient 0.99.
 The effect of this is the two error terms add almost linearly, not in quadratur
e, in their effect on the final uncertainty in angle of attack.
\end_layout

\begin_layout Standard
The effect of these errors on the resulting angle of attack, for this dataset,
 was evaluated by applying randomly generated Gaussian fluctuations to the
 coefficients and calculating the net effect on the parameterized representation.
 The resulting standard error in angle-of-attack was 0.001
\begin_inset Formula $^{\circ}$
\end_inset

.
 However, because the speed-run values and standard values gave deviations
 relative to this calibration of about 0.03
\begin_inset Formula $^{\circ}$
\end_inset

, that may be a better estimate of the uncertainty in angle of attack from
 possible bias, with the smaller standard error representing the random
 component of that uncertainty.
 The net effect on vertical wind produced by 0.03
\begin_inset Formula $^{\circ}$
\end_inset

 uncertainty in the sensitivity coefficients for angle-of-attack is therefore
 estimated to be about 0.1
\begin_inset space ~
\end_inset

m/s from uncertainty in the calibration.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig-cap-3a>>=
\end_layout

\begin_layout Plain Layout

capnFaoaG <- "For the gust pod, the angle-of-attack determined from the
 fit as a function of the reference angle provided by (
\backslash

\backslash
ref{eq:AOAeq}), for the combined four speed runs.
 Compare to Fig.~
\backslash

\backslash
ref{fig:AOA-fit-and-plot}, the corresponding plot for the radome."
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Application to the gust pod
\end_layout

\begin_layout Standard
A similar approach was taken for the gust pod, but with variables translated
 to apply to the gust-pod instead of the radome: 
\begin_inset Formula $\Delta P_{\alpha}=$
\end_inset

ADIFR_GP, 
\begin_inset Formula $q=$
\end_inset

QC_GP, 
\begin_inset Formula $p=$
\end_inset

PS_GP, and the Mach number 
\begin_inset Formula $M$
\end_inset

 was that determined from the uncorrected measurements 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $q$
\end_inset

 from the gust pod.
 Apparently because of the under-wing location in disturbed airflow, a fit
 involving more terms was needed to represent the reference measurements
 from Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAeq"

\end_inset

.
 After exploration of various possible terms, the fit selected to represent
 the gust-pod was the following:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha=b_{0}+\frac{\Delta p_{\alpha}}{q}(b_{1}+b_{2}M)+b_{3}\frac{q}{p}\label{eq:AOAGfunction}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<AOA-gust-pod,fig.cap=capnFaoaG,fig.align="center", echo=FALSE, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

Data2$AOAREF_GP <- Data2$CPITCH_GP - asin(Data2$CVSPD_GP/Data2$TASX) / Cradeg
\end_layout

\begin_layout Plain Layout

Data2$AQR_GP <- Data2$ADIFR_GP/Data2$QC_GP # basic pressure ratio for AOA
\end_layout

\begin_layout Plain Layout

Data2$RR2_GP <- Data2$QC_GP/Data2$PS_GP # q/p ratio from the gust pod
\end_layout

\begin_layout Plain Layout

#fm <- lm (AOAREF~AQR+RR2+PS_GP+QC_GP+Mach)
\end_layout

\begin_layout Plain Layout

#fm_GP <- lm (AOAREF_GP~AQR_GP+RR2_GP+Mach)
\end_layout

\begin_layout Plain Layout

Data2$MachG <- MachNumber (Data2$PS_GP, Data2$QC_GP)
\end_layout

\begin_layout Plain Layout

Data2$AQRM_GP <- Data2$AQR_GP * Data2$MachG
\end_layout

\begin_layout Plain Layout

fm_GP <- lm (AOAREF_GP~AQR_GP+AQRM_GP +RR2_GP, data=Data2)
\end_layout

\begin_layout Plain Layout

cf3_GP <- coefficients (fm_GP)
\end_layout

\begin_layout Plain Layout

#print(c("Fit coefficients are: ",cf3_GP))
\end_layout

\begin_layout Plain Layout

# print(summary(fm_GP))
\end_layout

\begin_layout Plain Layout

SummarizeFit (fm_GP)
\end_layout

\begin_layout Plain Layout

Data2$A2_GP <- cf3_GP[1] + cf3_GP[2]*Data2$AQR_GP + cf3_GP[3]*Data2$AQRM_GP
 + cf3_GP[4]*Data2$RR2_GP
\end_layout

\begin_layout Plain Layout

# plot (Data2$AOAREF_GP, Data2$A2_GP, xlab="Predicted AOA [deg.]", 
\end_layout

\begin_layout Plain Layout

# ylab="Fit AOA [deg.]", type='p', pch=16, cex=0.7, col='blue')
\end_layout

\begin_layout Plain Layout

# lines (c(-3.,6.), c(-3.,6.), lty=2, lwd=3, col='orange')
\end_layout

\begin_layout Plain Layout

# title ("Gust Pod")
\end_layout

\begin_layout Plain Layout

clr <- c("measurements", "fit")
\end_layout

\begin_layout Plain Layout

col <- c ('darkorange', 'darkgreen')
\end_layout

\begin_layout Plain Layout

g <- ggplot (data=Data2, aes(x=AOAREF_GP))
\end_layout

\begin_layout Plain Layout

g <- g + geom_point (aes(y=A2_GP), colour='blue', pch=19) 
\end_layout

\begin_layout Plain Layout

g <- g + xlab (expression(paste("Reference AOA [",degree,"]")))
\end_layout

\begin_layout Plain Layout

g <- g + ylab (expression(paste("AOA from best-fit equation [",degree,"]")))
\end_layout

\begin_layout Plain Layout

g <- g + geom_smooth (aes(y=A2_GP, colour=clr[2]), method='lm', lwd=2, linetype=
2)
\end_layout

\begin_layout Plain Layout

g <- g + scale_colour_manual ("", breaks = clr, values = col)
\end_layout

\begin_layout Plain Layout

g <- g + theme_WAC()
\end_layout

\begin_layout Plain Layout

print (g)
\end_layout

\begin_layout Plain Layout

capnF3 <- "The sideslip attack determined from the fit, as a function of
 the reference angle provided by Equation (9), for the combination of data
 from all three yaw maneuvers listed in the text."
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{kframe}
\end_layout

\end_inset

 
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Call:
\end_layout

\begin_layout Verbatim

## lm(formula = AOAREF_GP ~ AQR_GP + AQRM_GP + RR2_GP)
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Residuals:
\end_layout

\begin_layout Verbatim

##     Min      1Q  Median      3Q     Max 
\end_layout

\begin_layout Verbatim

## -0.3552 -0.0591  0.0049  0.0672  0.3003 
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Coefficients:
\end_layout

\begin_layout Verbatim

##             Estimate Std.
 Error t value Pr(>|t|)
\end_layout

\begin_layout Verbatim

## (Intercept) -0.91677    0.00813  -112.8   <2e-16
\end_layout

\begin_layout Verbatim

## AQR_GP       3.91804    0.06437    60.9   <2e-16
\end_layout

\begin_layout Verbatim

## AQRM_GP      3.25047    0.11559    28.1   <2e-16
\end_layout

\begin_layout Verbatim

## RR2_GP       1.35306    0.03521    38.4   <2e-16
\end_layout

\begin_layout Verbatim

##                
\end_layout

\begin_layout Verbatim

## (Intercept) ***
\end_layout

\begin_layout Verbatim

## AQR_GP      ***
\end_layout

\begin_layout Verbatim

## AQRM_GP     ***
\end_layout

\begin_layout Verbatim

## RR2_GP      ***
\end_layout

\begin_layout Verbatim

## ---
\end_layout

\begin_layout Verbatim

## Signif.
 codes:  
\end_layout

\begin_layout Verbatim

## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Residual standard error: 0.102 on 2015 degrees of freedom
\end_layout

\begin_layout Verbatim

## Multiple R-squared:  0.989,	Adjusted R-squared:  0.989 
\end_layout

\begin_layout Verbatim

## F-statistic: 6.25e+04 on 3 and 2015 DF,  p-value: <2e-16
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{kframe}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results of this formula are compared to the reference data in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:AOA-gust-pod"

\end_inset

.
 The best-fit coefficients were {
\begin_inset Formula $b_{i}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3_GP[1],3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(cf3_GP[2],3),nsmall=3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3_GP[3],3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(cf3_GP[4],3),nsmall=3)}
\end_layout

\end_inset

} and the square of the correlation was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(summary(fm_GP)$r.squared,3),nsmall=2)}
\end_layout

\end_inset

 with residual scatter (residual standard error) of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(summary(fm_GP)$sigma,3),nsmall=2)}
\end_layout

\end_inset

.
 The fit was thus even better than that obtained for the radome for these
 same speed runs.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-AOA-gust-pod.pdf
	width 300pt

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
For the gust pod, the angle-of-attack determined from the fit as a function
 of the reference angle provided by (9), for the combined four speed runs
\end_layout

\end_inset

For the gust pod, the angle-of-attack determined from the fit as a function
 of the reference angle provided by (9), for the combined four speed runs.
 Compare to Fig.
 14, the corresponding plot for the radome.
\begin_inset CommandInset label
LatexCommand label
name "fig:AOA-gust-pod"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Sideslip Angle
\begin_inset CommandInset label
LatexCommand label
name "sub:calibration-SS"

\end_inset


\end_layout

\begin_layout Subsubsection
Equations underlying the calibration
\end_layout

\begin_layout Standard
Calibration of the sideslip angle is more difficult, both because the equations
 are more complicated and because the maneuver is very hard to fly.
 Ideally, the sideslip maneuver should only change yaw angle and heading
 without change in roll, altitude, or angle-of-attack, but that is impossible
 to fly.
 It is practical, however, to minimize roll and change in altitude, and
 that was how these maneuvers were flown.
 The three sets of yaw maneuvers were at these times: 3:32:00--3:35:30,
 4:31:00--4:33:30, and 5:26:40--5:29:30 UTC.
 Because the yaw maneuvers on rf11 (10:25:00 to 10:30:00) were flown in
 the old way, they were not combined with these new measurements, but it
 does not appear that the sideslip calibration has any significant dependence
 on altitude.
 In the case of yaw maneuvers, the calibration is based on the expectation
 that the horizontal wind remains constant.
 The first-order equations for the east and north components of the wind,
 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

, are:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
u & = & -U_{a}\sin(\Psi+\beta)+u_{p}\nonumber \\
v & = & -U_{a}\cos(\Psi+\beta)+v_{p}\label{eq:horizWindeqs}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $U_{a}$
\end_inset

 is the true airspeed, 
\begin_inset Formula $\Psi$
\end_inset

 the heading, 
\begin_inset Formula $\beta$
\end_inset

 the sideslip angle, and 
\begin_inset Formula $u_{p}$
\end_inset

 and 
\begin_inset Formula $v_{p}$
\end_inset

 are the eastward and northward ground-speed components of the aircraft.
 These two equations lead to the following reference formula for 
\begin_inset Formula $\beta$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\beta^{*}=-\Psi+\arctan\left(\frac{u_{p}-u}{v_{p}-v}\right)\label{eq:beta-equation}
\end{equation}

\end_inset

where the second term represents a correction for the change in direction
 of motion of the aircraft, which is difficult to avoid in the yaw maneuver.
 The measurements thus provide 
\begin_inset Formula $\beta^{*}$
\end_inset

, an estimate of the sideslip during the yaw maneuvers.
\end_layout

\begin_layout Standard
There is, however, a circular component in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:beta-equation"

\end_inset

) because it involves the wind components and those require 
\begin_inset Formula $\beta$
\end_inset

 for their measurement when sideslip changes.
 To reduce the feedback from this term, the horizontal wind components 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 were low-pass-filtered with periods ranging from 5--60 s and the filtered
 values were used in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:beta-equation"

\end_inset

).
 Filtering made small differences in the fit coefficients but increased
 the residual error significantly, but 60-s filtering was still selected
 because that is a period long in comparison to the yaw maneuvers so it
 should reduce possible bias in the fit coefficients from use of the older
 sensitivity coefficients and any associated fluctuations in the wind measuremen
ts during maneuvers.
\end_layout

\begin_layout Subsubsection
Application to the radome-based and gust-pod systems
\end_layout

\begin_layout Standard
For both systems, a relatively simple fit was sufficient, in the following
 form:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\beta=e_{0}+e_{1}\frac{\Delta p_{\beta}}{q}\label{eq:betaFunctionForm}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta p_{\beta}$
\end_inset

 is the pressure difference between horizontally separated pressure ports
 and 
\begin_inset Formula $q$
\end_inset

 the dynamic pressure.
 For the radome, 
\begin_inset Formula $q=$
\end_inset

QCF and 
\begin_inset Formula $\Delta p_{\beta}=$
\end_inset

BDIFR; for the gust-pod, 
\begin_inset Formula $q=$
\end_inset

QC_GP and 
\begin_inset Formula $\Delta p_{\beta}=$
\end_inset

BDIFR_GP.
 The resulting fit for the radome is listed below:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sideslip-fits, include=TRUE, fig.cap="The sideslip attack determined from
 the fit, as a function of the reference angle provided by Equation (
\backslash

\backslash
ref{eq:beta-equation}), for the combination of data from all three yaw maneuvers
 listed in the text.
 The gray area underlying the dashed orange line denotes the standard-uncertaint
y range for the fit.", fig.height=4.5>>=
\end_layout

\begin_layout Plain Layout

# first get filtered wind-component values:
\end_layout

\begin_layout Plain Layout

# u <- -1.
 * D$WSC * sin (D$WDC*Cradeg)
\end_layout

\begin_layout Plain Layout

# v <- -1.
 * D$WSC * cos (D$WDC*Cradeg)
\end_layout

\begin_layout Plain Layout

# u <- ButterworthFilter (u, tau=30)
\end_layout

\begin_layout Plain Layout

# v <- ButterworthFilter (v, tau=30)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

r1 <- setRange (D$Time, 33130,33600)
\end_layout

\begin_layout Plain Layout

r2 <- setRange (D$Time, 43000,43400)
\end_layout

\begin_layout Plain Layout

r3 <- setRange (D$Time, 52540,53030)
\end_layout

\begin_layout Plain Layout

DD <- D[r1,]
\end_layout

\begin_layout Plain Layout

u1 <- mean (-1.*DD$WSC * sin (DD$WDC * Cradeg))
\end_layout

\begin_layout Plain Layout

v1 <- mean (-1.*DD$WSC * cos (DD$WDC * Cradeg))
\end_layout

\begin_layout Plain Layout

DD <- D[r2,]
\end_layout

\begin_layout Plain Layout

u2 <- mean (-1.*DD$WSC * sin (DD$WDC * Cradeg))
\end_layout

\begin_layout Plain Layout

v2 <- mean (-1.*DD$WSC * cos (DD$WDC * Cradeg))
\end_layout

\begin_layout Plain Layout

DD <- D[r3,]
\end_layout

\begin_layout Plain Layout

u3 <- mean (-1.*DD$WSC * sin (DD$WDC * Cradeg))
\end_layout

\begin_layout Plain Layout

v3 <- mean (-1.*DD$WSC * cos (DD$WDC * Cradeg))
\end_layout

\begin_layout Plain Layout

r1 <- setRange (D$Time, 33230,33500)
\end_layout

\begin_layout Plain Layout

r2 <- setRange (D$Time, 43100,43300)
\end_layout

\begin_layout Plain Layout

r3 <- setRange (D$Time, 52640,52930)
\end_layout

\begin_layout Plain Layout

r <- c(r1,r2,r3)
\end_layout

\begin_layout Plain Layout

# u <- u[r]
\end_layout

\begin_layout Plain Layout

# v <- v[r]
\end_layout

\begin_layout Plain Layout

#r <- r1
\end_layout

\begin_layout Plain Layout

Data <- D[r,]
\end_layout

\begin_layout Plain Layout

Valid <- (Data$TASX > 130.)
\end_layout

\begin_layout Plain Layout

DataV <- Data[Valid,]
\end_layout

\begin_layout Plain Layout

Hmean <- mean(DataV$THDG)
\end_layout

\begin_layout Plain Layout

u <- -1.
 * DataV$WSC * sin (DataV$WDC*Cradeg)
\end_layout

\begin_layout Plain Layout

v <- -1.
 * DataV$WSC * cos (DataV$WDC*Cradeg)
\end_layout

\begin_layout Plain Layout

# u[1:length(r1)] <- u1
\end_layout

\begin_layout Plain Layout

# u[(length(r1)+1):length(c(r1,r2))] <- u2
\end_layout

\begin_layout Plain Layout

# u[(length(c(r1,r2))+1):length(r)] <- u3
\end_layout

\begin_layout Plain Layout

# v[1:length(r1)] <- v1
\end_layout

\begin_layout Plain Layout

# v[(length(r1)+1):length(c(r1,r2))] <- v2
\end_layout

\begin_layout Plain Layout

# v[(length(c(r1,r2))+1):length(r)] <- v3
\end_layout

\begin_layout Plain Layout

# tauslip = 10.
\end_layout

\begin_layout Plain Layout

# u[1:length(r1)] <- ButterworthFilter(u[1:length(r1), tau=tauslip)
\end_layout

\begin_layout Plain Layout

# u[(length(r1)+1):length(c(r1,r2))] <- ButterworthFilter(u[(length(r1)+1):lengt
h(c(r1,r2))], tau=tauslip)
\end_layout

\begin_layout Plain Layout

# u[(length(c(r1,r2))+1):length(r)] <- ButterworthFilter(u[(length(c(r1,r2))+1):
length(r)], tau=tauslip)
\end_layout

\begin_layout Plain Layout

# v[1:length(r1)] <- ButterworthFilter(v[1:length(r1), tau=tauslip)
\end_layout

\begin_layout Plain Layout

# v[(length(r1)+1):length(c(r1,r2))] <- ButterworthFilter(v[(length(r1)+1):lengt
h(c(r1,r2))], tau=tauslip)
\end_layout

\begin_layout Plain Layout

# v[(length(c(r1,r2))+1):length(r)] <- ButterworthFilter(v[(length(c(r1,r2))+1):
length(r)], tau=tauslip)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

DataV$SSREF <- -DataV$THDG + atan2((DataV$VEW-u), (DataV$VNS-v))/ Cradeg
\end_layout

\begin_layout Plain Layout

DataV$SSREF[DataV$SSREF < -180.] <- DataV$SSREF[DataV$SSREF < -180.] + 360.
\end_layout

\begin_layout Plain Layout

#plot (DataV$SSREF, DataV$SSLIP, pch=16, cex=0.6,col='blue')
\end_layout

\begin_layout Plain Layout

DataV$BQR <- DataV$BDIFR / DataV$QCXC
\end_layout

\begin_layout Plain Layout

sfm <- lm(SSREF~BQR, data=DataV)
\end_layout

\begin_layout Plain Layout

cfs <- coefficients(sfm)
\end_layout

\begin_layout Plain Layout

#print(c("Fit coefficients are: ",cfs))
\end_layout

\begin_layout Plain Layout

# print(summary(sfm))
\end_layout

\begin_layout Plain Layout

SummarizeFit (sfm)
\end_layout

\begin_layout Plain Layout

DataV$S2 <- cfs[1] + cfs[2] * DataV$BQR
\end_layout

\begin_layout Plain Layout

# plot (DataV$SSREF, DataV$S2, pch=16, cex=0.6, col='blue',
\end_layout

\begin_layout Plain Layout

#       xlab="SS Reference", ylab="SSLIP from fit")
\end_layout

\begin_layout Plain Layout

# lines(c(-2.,2.), c(-2.,2.), col='orange', lty=2, lwd=3)
\end_layout

\begin_layout Plain Layout

# title ("Radome")
\end_layout

\begin_layout Plain Layout

clr <- c("measurements", "fit")
\end_layout

\begin_layout Plain Layout

col <- c ('darkorange', 'darkgreen')
\end_layout

\begin_layout Plain Layout

g <- ggplot (data=DataV, aes(x=SSREF))
\end_layout

\begin_layout Plain Layout

g <- g + geom_point (aes(y=S2), colour='blue', pch=19) 
\end_layout

\begin_layout Plain Layout

g <- g + xlab (expression(paste("reference sideslip [",degree,"]")))
\end_layout

\begin_layout Plain Layout

g <- g + ylab (expression(paste("sideslip from best-fit equation [",degree,"]"))
)
\end_layout

\begin_layout Plain Layout

g <- g + geom_smooth (aes(y=S2, colour=clr[2]), method='lm', lwd=2, linetype=2)
\end_layout

\begin_layout Plain Layout

g <- g + scale_colour_manual ("", breaks = clr, values = col)
\end_layout

\begin_layout Plain Layout

g <- g + theme_WAC()
\end_layout

\begin_layout Plain Layout

print (g)
\end_layout

\begin_layout Plain Layout

capnF4 <- "As in the preceding figure but for the gust-pod system."
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The best-fit coefficients were {e} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format (round(cfs[1], 3), nsmall=3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round (cfs[2], 3)}
\end_layout

\end_inset

}, the squared correlation was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round (summary(sfm)$r.squared, 2)}
\end_layout

\end_inset

 and the residual standard error was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round (summary(sfm)$sigma, 3)}
\end_layout

\end_inset

, as listed above.
 The plotted measurements and this fit are shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:sideslip-fits}
\end_layout

\end_inset

.
 The near-zero first coefficient is a forced result from using calculated
 wind components in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:beta-equation"

\end_inset

).
 The sideslip offset that is represented by this term will be determined
 later by other means; cf.
 Section 
\begin_inset CommandInset ref
LatexCommand formatted
reference "par:Offset-in-Sideslip"

\end_inset

.) 
\begin_inset Note Note
status open

\begin_layout Plain Layout
The scatter in this plot was much less without filtering or with less filtering
 of the wind components; the residual standard error for that case was 0.096,
 the squared correlation increased to 0.98, and the coefficients changed
 to {
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
ensuremath{-0.0027}
\end_layout

\end_inset

, 20.8005}.
 The change in coefficients is minor and the plots would look much better
 than the following plots, but it seems appropriate to apply the filtering
 so for now those results will be adopted for further use.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{kframe}
\end_layout

\end_inset

 
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Call:
\end_layout

\begin_layout Verbatim

## lm(formula = SSREFF ~ BQR)
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Residuals:
\end_layout

\begin_layout Verbatim

##     Min      1Q  Median      3Q     Max 
\end_layout

\begin_layout Verbatim

## -0.7228 -0.1052 -0.0185  0.0615  0.6543 
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Coefficients:
\end_layout

\begin_layout Verbatim

##             Estimate Std.
 Error t value Pr(>|t|)
\end_layout

\begin_layout Verbatim

## (Intercept)  0.01600    0.00881    1.82     0.07
\end_layout

\begin_layout Verbatim

## BQR         21.99154    0.27193   80.87   <2e-16
\end_layout

\begin_layout Verbatim

##                
\end_layout

\begin_layout Verbatim

## (Intercept) .
  
\end_layout

\begin_layout Verbatim

## BQR         ***
\end_layout

\begin_layout Verbatim

## ---
\end_layout

\begin_layout Verbatim

## Signif.
 codes:  
\end_layout

\begin_layout Verbatim

## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Residual standard error: 0.185 on 441 degrees of freedom
\end_layout

\begin_layout Verbatim

## Multiple R-squared:  0.937,	Adjusted R-squared:  0.937 
\end_layout

\begin_layout Verbatim

## F-statistic: 6.54e+03 on 1 and 441 DF,  p-value: <2e-16
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{kframe}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-sideslip.pdf
	width 300pt

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
The sideslip attack determined from the fit, as a function of the reference
 angle provided by Equation (9), for the combination of data from all three
 yaw maneuvers listed in the text
\end_layout

\end_inset

The sideslip attack determined from the fit, as a function of the reference
 angle provided by Equation (9), for the combination of data from all three
 yaw maneuvers listed in the text.
 The gray area underlying the dashed orange line denotes the standard-uncertaint
y range for the fit.
\begin_inset CommandInset label
LatexCommand label
name "fig:sideslip"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The standard calibration in use for the GV has coefficient 
\begin_inset Formula $e_{1}$
\end_inset

=21.155, slightly smaller than the value determined from this calibration.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
A preliminary re-calibration based on measurements from the Laser Air Motion
 Sensor suggested that this coefficient should be about 50% higher, but
 airflow-distortion effects compromised those measurements so a better calibrati
on awaits useful measurements from the 3-beam version of that sensor.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% 
\backslash
begin{figure}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% {
\backslash
centering 
\backslash
includegraphics[width=300pt]{figure/GP-sideslip}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% 
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% }
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% 
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% 
\backslash
protect
\backslash
caption[The sideslip attack determined from the fit, as a function of the
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% reference angle provided by Equation (9), for the combination of data
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% from all three yaw maneuvers listed in the text]{The sideslip attack determine
d from the fit, as a function of the
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% reference angle provided by Equation (9), for the combination of data
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% from all three yaw maneuvers listed in the text.
\backslash
label{fig:sideslip}}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

% 
\backslash
end{figure}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
For the gust-pod, the same approach was followed, giving a fit with characterist
ics as listed below:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sideslip-gust-pod,fig.cap=capnF4, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

DataV$SSREF_GP <- -DataV$CTHDG_GP + atan2((DataV$CVEW_GP-u), (DataV$CVNS_GP-v))/
 Cradeg
\end_layout

\begin_layout Plain Layout

DataV$SSREF_GP[DataV$SSREF_GP < -180.] <- DataV$SSREF_GP[DataV$SSREF_GP <
 -180.] + 360.
\end_layout

\begin_layout Plain Layout

#plot (SSREF_GP, SSLIP, pch=16, cex=0.6,col='blue')
\end_layout

\begin_layout Plain Layout

DataV$BQR_GP <- DataV$BDIFR_GP / DataV$QC_GP
\end_layout

\begin_layout Plain Layout

DataV$Mach <- MachNumber (DataV$PS_GP, DataV$QC_GP)
\end_layout

\begin_layout Plain Layout

#sfm_GP <- lm(SSREF_GP~BQR_GP, data=DataV)
\end_layout

\begin_layout Plain Layout

DataV$RR2_GP <- DataV$QC_GP / DataV$PS_GP
\end_layout

\begin_layout Plain Layout

sfm_GP <- lm(SSREF_GP~BQR_GP, data=DataV)
\end_layout

\begin_layout Plain Layout

SummarizeFit(sfm_GP)
\end_layout

\begin_layout Plain Layout

cfs_GP <- coefficients(sfm_GP)
\end_layout

\begin_layout Plain Layout

S2_GP <- cfs_GP[1] + cfs_GP[2] * DataV$BQR_GP #+ cfs_GP[3] * DataV$RR2_GP
 + cfs_GP[4] * DataV$Mach
\end_layout

\begin_layout Plain Layout

# plot (SSREF_GP, S2_GP, pch=16, cex=0.6, col='blue',
\end_layout

\begin_layout Plain Layout

# xlab="SS Reference", ylab="SSLIP from fit")
\end_layout

\begin_layout Plain Layout

# lines(c(-2.,2.), c(-2.,2.), col='orange', lty=2, lwd=3)
\end_layout

\begin_layout Plain Layout

# title ("Gust Pod")
\end_layout

\begin_layout Plain Layout

clr <- c("measurements", "fit")
\end_layout

\begin_layout Plain Layout

col <- c ('darkorange', 'darkgreen')
\end_layout

\begin_layout Plain Layout

g <- ggplot (data=DataV, aes(x=SSREF_GP))
\end_layout

\begin_layout Plain Layout

g <- g + geom_point (aes(y=S2_GP), colour='blue', pch=19) 
\end_layout

\begin_layout Plain Layout

g <- g + xlab (expression(paste("reference sideslip [",degree,"]")))
\end_layout

\begin_layout Plain Layout

g <- g + ylab (expression(paste("sideslip from best-fit equation [",degree,"]"))
)
\end_layout

\begin_layout Plain Layout

g <- g + geom_smooth (aes(y=S2_GP, colour=clr[2]), method='lm', lwd=2, linetype=
2)
\end_layout

\begin_layout Plain Layout

g <- g + scale_colour_manual ("", breaks = clr, values = col)
\end_layout

\begin_layout Plain Layout

g <- g + theme_WAC()
\end_layout

\begin_layout Plain Layout

print (g)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The squared correlation of this fit was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round (summary(sfm_GP)$r.squared, 2)}
\end_layout

\end_inset

 and the residual standard error was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round (summary(sfm_GP)$sigma, 3)}
\end_layout

\end_inset


\begin_inset Formula $^{\circ}$
\end_inset

.
 The best-fit coefficients were {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format (round(cfs_GP[1], 3), nsmall=3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round (cfs_GP[2], 3)}
\end_layout

\end_inset

}.
 The difference in first coefficient vs the radome is a result of the offset
 in heading between the aircraft longitudinal axis and the gust pod.
 The detailed report for the fit is listed above, and the result of applying
 these sensitivity coefficients to the measurements from the gust pod is
 shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:sideslip-gust-pod}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{knitrout}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
color{fgcolor}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{kframe}
\end_layout

\end_inset

 
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Call:
\end_layout

\begin_layout Verbatim

## lm(formula = SSREF_GP ~ BQR_GP)
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Residuals:
\end_layout

\begin_layout Verbatim

##     Min      1Q  Median      3Q     Max 
\end_layout

\begin_layout Verbatim

## -0.5676 -0.1213 -0.0142  0.1008  0.6404 
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Coefficients:
\end_layout

\begin_layout Verbatim

##             Estimate Std.
 Error t value Pr(>|t|)
\end_layout

\begin_layout Verbatim

## (Intercept)  -3.6091     0.0306  -118.1   <2e-16
\end_layout

\begin_layout Verbatim

## BQR_GP       12.1380     0.1547    78.5   <2e-16
\end_layout

\begin_layout Verbatim

##                
\end_layout

\begin_layout Verbatim

## (Intercept) ***
\end_layout

\begin_layout Verbatim

## BQR_GP      ***
\end_layout

\begin_layout Verbatim

## ---
\end_layout

\begin_layout Verbatim

## Signif.
 codes:  
\end_layout

\begin_layout Verbatim

## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end_layout

\begin_layout Verbatim

## 
\end_layout

\begin_layout Verbatim

## Residual standard error: 0.191 on 441 degrees of freedom
\end_layout

\begin_layout Verbatim

## Multiple R-squared:  0.933,	Adjusted R-squared:  0.933 
\end_layout

\begin_layout Verbatim

## F-statistic: 6.16e+03 on 1 and 441 DF,  p-value: <2e-16
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{kframe}
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/WU-sideslip-gust-pod-plot.pdf
	width 300pt

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
As in the preceding figure but for the gust-pod system
\end_layout

\end_inset

As in the preceding figure but for the gust-pod system.
 The area covered by the gray line underlying the thick orange dashed line
 indicates the standard-uncertainty range covered by the fit.
\begin_inset CommandInset label
LatexCommand label
name "fig:sideslip-gust-pod-plot"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{knitrout}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On additional study is needed to determine the sensitivity coefficients
 for sideslip.
 An offset in sideslip, arising from an erroneous first coefficient 
\begin_inset Formula $e_{0}$
\end_inset

 in the calibration, would produce an offset in the lateral component of
 the measured wind, and that erroneous lateral component would enter the
 calibration equation to again give a first coefficient near zero.
 An offset therefore must be determined in another way.
 Two candidates for finding the offset are reverse-heading maneuvers, during
 which the horizontal wind component lateral to the aircraft should remain
 constant but change sign, or circle maneuvers, during which an offset in
 sideslip will appear as a sinusoidally varying perturbation to the wind.
 Later in this report, a set of circles, flown with constant roll, will
 be used in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Analysis-of-circle"

\end_inset

 to obtain a better estimate of the sideslip offset.
 .
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
vfill
\backslash
eject
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
True Airspeed from the Gust Pod
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% 
\backslash
subsection*{The Components of the Relative Wind}% % The gust pod is a new
 wind-sensing system so it is useful to document how the measurements are
 handled.
 The probe itself has five pressure-sensing holes located on a hemispheric
 cap pointed into the wind.
 The pressure difference between the two ports located upward and downward
 from centerline, measured as ADIFR
\backslash
_GP, is used in the calculation of angle-of-attack.
 The similar pressure difference between the two ports located toward starboard
 and toward port of centerline, measured as BDIFR
\backslash
_GP, are used in the calculation of sideslip.
 In addition, the probe has static ports located on the side of the cylinder
 carrying the hemispheric cap, and the difference between the pressure at
 the forward port and that at the static ports is measured as the dynamic
 pressure QC
\backslash
_GP.
 The static pressure is also measured, as PS
\backslash
_GP.% % In addition, there is an inertial reference unit mounted with the
 gust pod to measure its attitude angles (roll, pitch, heading) and to measure
 the three components of motion of the aircraft relative to the Earth.
 This unit receives GPS information and uses it to update its measurements
 via a Kalman filter.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The measurements ADIFR_GP and BDIFR_GP, normalized by QC_GP, are used with
 the calibrations in the preceding section to find the angle-of-attack and
 sideslip.
 In addition, to find the relative wind, a measurement of true airspeed
 (TAS) is needed.
 In an effort to allow the gust-pod system to operate independently of the
 standard radome-based system, it is desirable to determine the true airspeed
 directly from the gust-pod measurements.
 However, the standard system has been calibrated to low uncertainty by
 reference to the Laser Air Motion Sensor, so for the purpose of calibration
 that true airspeed (TASX) will be used as a reference.
 Once the gust-pod measurement of true airspeed is calibrated, the gust-pod
 system still measures wind without future reference to the standard system,
 but the calibration process links the two systems to have a common reference
 for TAS.
\end_layout

\begin_layout Standard
Therefore, the next step needed to use the gust pod wind-sensing system
 is to determine a functional relationship between gust-pod measurements
 and the true airspeed.
 The approach taken is to fit the basic pressure ratio 
\begin_inset Formula $q/p$
\end_inset

 as measured by the 858 probe to match the corresponding pressure ratio
 provided by the conventional measurements of dynamic and static pressure.
 The relationship represents the true ratio of dynamic to static pressure,
 so using that ratio the normal calculation of true airspeed can be used
 to determine the TAS measured by the gust pod.
 For this purpose, all the measurements from the calibration flight (RF15)
 were used qualified only by requiring TASX>130 m/s.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<TAS-from-the-gust-pod-1,fig.cap="Standard measurements QCPC/PSXC plotted
 vs QCPC-GP/PS-GP as measured by the gust pod",out.width="300pt", fig.align="cente
r",echo=FALSE, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# for this purpose, use all measurements from the cal flight that had TASX>130:
\end_layout

\begin_layout Plain Layout

Data <- D
\end_layout

\begin_layout Plain Layout

Valid <- (Data$TASX > 130.)
\end_layout

\begin_layout Plain Layout

DataV <- Data[Valid,]
\end_layout

\begin_layout Plain Layout

DataV$B1 <- DataV$QCXC/DataV$PSXC
\end_layout

\begin_layout Plain Layout

DataV$B2 <- DataV$QC_GP/DataV$PS_GP
\end_layout

\begin_layout Plain Layout

DataV$AQR_GP <- DataV$ADIFR_GP/DataV$QC_GP # basic pressure ratio for AOA
\end_layout

\begin_layout Plain Layout

DataV$RR2_GP <- DataV$QC_GP/DataV$PS_GP    # q/p ratio from the gust pod
\end_layout

\begin_layout Plain Layout

DataV$Mach <- MachNumber(DataV$PSXC,DataV$QCXC)
\end_layout

\begin_layout Plain Layout

DataV$MachG <- MachNumber (DataV$PS_GP, DataV$QC_GP)
\end_layout

\begin_layout Plain Layout

# B2 and AQR are based only on the gust-pod measurements
\end_layout

\begin_layout Plain Layout

#fm4 <- lm(B1~B2+I(B2^2)+AQR_GP)
\end_layout

\begin_layout Plain Layout

DataV$BxM <- DataV$B2*DataV$MachG
\end_layout

\begin_layout Plain Layout

fm4 <- lm(B1~B2+BxM+I(B2^2)+AQR_GP+MachG, data=DataV)
\end_layout

\begin_layout Plain Layout

cf4 <- coefficients (fm4)
\end_layout

\begin_layout Plain Layout

#print (c("fit coefficients for TAS:", cf4))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The measurements entering the resulting fit are as follows: 
\begin_inset Formula $q$
\end_inset

=QCXC is the reference dynamic pressure, 
\begin_inset Formula $p=$
\end_inset

PSXC is the reference ambient pressure, 
\begin_inset Formula $q_{g}=$
\end_inset

QC_GP is the gust-pod dynamic pressure, 
\begin_inset Formula $p_{g}$
\end_inset

=PS_GP is the gust-pod static pressure, 
\begin_inset Formula $M$
\end_inset

 is the Mach number determined from the reference measurements, 
\begin_inset Formula $M_{g}$
\end_inset

 the Mach number determined from the gust-pod static and dynamic pressure,
 and 
\begin_inset Formula $\Delta P_{\alpha,g}$
\end_inset

=ADIFR_GP is the pressure difference between top and bottom pressure ports
 on the gust-pod sensor.
 The following equation was found to provide a useful representation of
 the reference ratio 
\begin_inset Formula $q/p$
\end_inset

 in terms of quantities measured only by the gust-probe system:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{q}{p}=b_{0}+b_{1}\frac{q_{g}}{p_{g}}+b_{2}M_{G}\frac{q_{g}}{p_{g}}+b{}_{3}\left(\frac{q_{g}}{p_{g}}\right)^{2}+b_{3}\frac{\Delta p_{\alpha,g}}{q_{g}}+b_{5}M_{G}\label{eq:TASfit}
\end{equation}

\end_inset

This complexity in the equation was needed to obtain a good fit (with residual
 error translating to a typical error in true airspeed of about 0.5
\begin_inset space \thinspace{}
\end_inset

m/s for typical DEEPWAVE research legs), and all terms were indicated to
 be significant in the fit.
 The fit details are listed below:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<tas-fit-listing, include=TRUE>>=
\end_layout

\begin_layout Plain Layout

SummarizeFit(fm4)
\end_layout

\begin_layout Plain Layout

#B3 <- cf4[1]+cf4[2]*B2+cf4[3]*B2**2+cf4[4]*AQR_GP
\end_layout

\begin_layout Plain Layout

DataV$B3 <- cf4[1] + cf4[2]*DataV$B2 + cf4[3]*DataV$BxM + cf4[4]*DataV$B2**2
 + cf4[5]*DataV$AQR_GP + cf4[6]*DataV$MachG
\end_layout

\begin_layout Plain Layout

# B3 is the deduced pressure ratio to use when calculating TAS
\end_layout

\begin_layout Plain Layout

capn2 <-"True airspeed obtained from the gust pod, plotted against corresponding
 measurements from the conventional measurement system (TASX)" 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout LyX-Code
\begin_inset Note Note
status open

\begin_layout LyX-Code

\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/GP-TAS-from-the-gust-pod-1.pdf
	width 300pt

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
protect
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
Standard measurements QCPC/PSXC plotted vs QCPC-GP/PS-GP as measured by
 the gust pod
\end_layout

\end_inset

Standard measurements QCPC/PSXC plotted vs QCPC-GP/PS-GP as measured by
 the gust pod
\begin_inset CommandInset label
LatexCommand label
name "fig:TAS-from-the-gust-pod-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout LyX-Code
\begin_inset ERT
status open

\begin_layout Plain Layout

<<plot-qp-fit, include=TRUE, fig.cap="The estimate of $q/p$ obtained from
 the right side of (
\backslash

\backslash
ref{eq:TASfit}), determined entirely from measurements provided by the gust
 pod, plotted against the standard measurement obtained from QCXC/PSXC.
 The coefficients are listed in the text.", fig.height=4.5>>=
\end_layout

\begin_layout Plain Layout

plot (DataV$B1, DataV$B3, xlab="Standard q/p [QCXC/PSXC]", ylab="gust-probe
 estimate G*", xlim=c(0.1,0.6), ylim=c(0.1,0.6), pch=16, cex=0.7, col='blue')
\end_layout

\begin_layout Plain Layout

lines (c(0., 1.), c(0.,1.), lwd=3, lty=2, col='orange')
\end_layout

\begin_layout Plain Layout

# Vg will be the TAS based only on the gust pod 
\end_layout

\begin_layout Plain Layout

DataV$Vg <- TrueAirspeed (MachNumber (DataV$PS_GP, DataV$PS_GP*DataV$B3,
 DataV$EWX), DataV$ATX)
\end_layout

\begin_layout Plain Layout

taserr <- sd(DataV$TASX-DataV$Vg, na.rm=TRUE) 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The resulting fit is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:plot-qp-fit}
\end_layout

\end_inset

.
 With this result for 
\begin_inset Formula $G^{*}\sim q/p$
\end_inset

, the true airspeed can then be obtained using the usual formula, with 
\begin_inset Formula $G^{*}$
\end_inset

 used in place of 
\begin_inset Formula $q/p$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
V=\sqrt{2\left(\frac{(c_{p}-R_{a}}{R_{a}}\right)\left(1+G^{*}\right)^{\frac{R_{a}}{c_{p}}-1}\left(\frac{c_{p}}{c_{v}}R_{a}T\right)}\label{eq:TASformula}
\end{equation}

\end_inset

where 
\begin_inset Formula $c_{p}$
\end_inset

, 
\begin_inset Formula $c_{v}$
\end_inset

, and 
\begin_inset Formula $R_{d}$
\end_inset

 are the specific heat of air at constant pressure, the specific heat of
 air at constant volume, and the gas constant for air and 
\begin_inset Formula $p$
\end_inset

 is the static pressure, 
\begin_inset Formula $q$
\end_inset

 the dynamic pressure, and 
\begin_inset Formula $T$
\end_inset

 the absolute temperature.
 
\end_layout

\begin_layout Standard
The resulting true airspeed is compared to the conventional measurement
 in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:TAS-from-the-gust-pod-2}
\end_layout

\end_inset

.
 The fit provides a reasonable representation of TASX, with a standard error
 of about 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(taserr,1)}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

m/s.
 However, this is larger than the estimated uncertainty in TASX (about 0.3
\begin_inset space \thinspace{}
\end_inset

m/s), so wind calculations will be better if based on the conventional measureme
nt of TASX unless it is desirable to calculate an estimate of true airspeed
 based entirely on the gust pod and independent of the standard measurement,
 or in case there is a problem with the standard measurement.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<TAS-from-the-gust-pod-2,fig.cap=capn2, include=TRUE, fig.height=4.5, fig.width=4.5,
 fig.show='keep'>>= 
\end_layout

\begin_layout Plain Layout

plot(DataV$TASX, DataV$Vg, xlab="TASX [m/s]", ylab="TAS, gust pod [m/s]",
 xlim=c(150.,250.), ylim=c(150.,250.),pch=16, cex=0.7, col='blue') 
\end_layout

\begin_layout Plain Layout

lines (c(100.,300.), c(100.,300.), lty=2, col='orange') 
\end_layout

\begin_layout Plain Layout

#sd((DataV$TASX-DataV$Vg)[abs(DataV$VSPD) < 2], na.rm=TRUE)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In particular, for the DEEPWAVE flights where the standard vertical wind
 measurement was compromised by an obstruction in the pressure-sensor lines
 of the radome, the best vertical wind will be that calculated using (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{eq:AOAGfunction})
\end_layout

\end_inset

 for the angle of attack but conventional TASX for the true airspeed, because
 the pressure ports used to determine TASX are not obstructed.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
vfill
\backslash
eject
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename figure/GP-TAS-from-the-gust-pod-2.pdf
	width 300pt

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
protect
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
True airspeed obtained from the gust pod, plotted against corresponding
 measurements from the conventional measurement system (TASX)
\end_layout

\end_inset

True airspeed obtained from the gust pod, plotted against corresponding
 measurements from the conventional measurement system (TASX)
\begin_inset CommandInset label
LatexCommand label
name "fig:TAS-from-the-gust-pod-2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace vfill
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
eject
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Summary of sensitivity coefficients
\end_layout

\begin_layout Subsubsection
Angle of Attack
\end_layout

\begin_layout Standard
Radome: Eq.
\begin_inset space ~
\end_inset

(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOArecommended"

\end_inset

), coefficients 
\begin_inset Formula $c_{0,1}$
\end_inset

 ={
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfr[1],3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfr[2],3)}
\end_layout

\end_inset

}.
\begin_inset Newline newline
\end_inset

Gust pod: Eq.
\begin_inset space ~
\end_inset

(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AOAGfunction"

\end_inset

), coefficients{
\begin_inset Formula $b_{i=0,3}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3_GP[1],3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(cf3_GP[2],3),nsmall=3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3_GP[3],3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3_GP[4],3)}
\end_layout

\end_inset

}.
\end_layout

\begin_layout Subsubsection
Sideslip Angle
\end_layout

\begin_layout Hanging
Radome and gust pod: Eq.
\begin_inset space ~
\end_inset

(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:betaFunctionForm"

\end_inset

), coefficients {
\begin_inset Formula $e_{0}$
\end_inset

, 
\begin_inset Formula $e_{1}$
\end_inset

} = 
\begin_inset Newline newline
\end_inset


\begin_inset space \qquad{}
\end_inset

 {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{format(round(cfs[1],3),nsmall=3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfs[2],3)}
\end_layout

\end_inset

} for the radome,
\begin_inset Newline newline
\end_inset


\begin_inset space \qquad{}
\end_inset

 {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfs_GP[1],3)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfs_GP[2],3)}
\end_layout

\end_inset

} for the gust pod.
\end_layout

\begin_layout Subsubsection
True Airspeed, Gust Pod
\end_layout

\begin_layout Hanging
Equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:TASformula"

\end_inset

), with (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:TASfit"

\end_inset

) and coefficients {
\begin_inset Formula $b_{i=0,5}$
\end_inset

} = 
\begin_inset Newline newline
\end_inset


\begin_inset space \qquad{}
\end_inset

 {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{cf4[1]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{cf4[2]}
\end_layout

\end_inset

,
 
\lang english

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{cf4[3]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{cf4[4]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{cf4[5]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{cf4[6]}
\end_layout

\end_inset

}.
\end_layout

\end_body
\end_document
